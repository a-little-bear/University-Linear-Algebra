# 第 56 章 Pfaffian

<div class="context-flow" markdown>

**前置**：行列式 (Ch3) · 外代数 (Ch49) · 辛矩阵 (Ch53)

**本章脉络**：反对称矩阵回顾 → Pfaffian 定义 → $\mathrm{pf}(A)^2 = \det(A)$ → 基本性质 → 计算方法 → 与完美匹配的关系 → FKT 算法 → 物理应用

**延伸**：Pfaffian 在统计力学（二维 Ising 模型的精确解）、代数拓扑（Euler 类作为曲率的 Pfaffian）和组合学（平面图完美匹配的多项式时间计数）中有精妙应用

</div>

对于反对称矩阵（$A^T = -A$），其行列式具有一个精致的"平方根"——**Pfaffian**。它不仅是代数上的技巧，更是连接图论、统计力学与微分几何的纽带。

---

## 56.1 Pfaffian 的定义与性质

!!! definition "定义 56.4 (Pfaffian)"
    对于 $2n$ 阶反对称矩阵 $A$，Pfaffian 定义为所有完美配对 $\pi$ 的带符号积之和：
    $$\mathrm{pf}(A) = \sum_{\pi} \mathrm{sgn}(\pi) \prod_{k=1}^n a_{i_k j_k}$$

!!! theorem "定理 56.4"
    对于任何偶数阶反对称矩阵，$A$，有：
    $$\mathrm{pf}(A)^2 = \det(A)$$

---

## 56.2 图论与 FKT 算法

!!! theorem "定理 56.9 (完美匹配)"
    图 $G$ 的完美匹配数量可以通过计算其特定定向下的反对称邻接矩阵的 Pfaffian 来求得。对于**平面图**，总存在一个 Pfaffian 定向使得所有匹配项符号一致。

!!! definition "定义 56.8 (FKT 算法)"
    FKT 算法通过寻找 Pfaffian 定向并将计数问题转化为 Pfaffian 计算，实现了平面图完美匹配在 $O(n^3)$ 时间内的精确计数。

---

## 练习题

1. **[概念] 什么是 Pfaffian？它与行列式 $\det(A)$ 的基本关系是什么？**
   ??? success "参考答案"
       对于反对称矩阵 $A$（$A^T = -A$），Pfaffian 是其行列式的“平方根”，满足 $\mathrm{pf}(A)^2 = \det(A)$。它是一个关于矩阵元素的正项与负项的组合求和。

2. **[基础] 计算 $2 \times 2$ 反对称矩阵 $A = \begin{pmatrix} 0 & a \\ -a & 0 \end{pmatrix}$ 的 Pfaffian。**
   ??? success "参考答案"
       根据定义，$\mathrm{pf}(A) = a$。验证：$\det(A) = a^2 = \mathrm{pf}(A)^2$。

3. **[计算] 写出 $4 \times 4$ 反对称矩阵 $A$ 的 Pfaffian 展开式。**
   ??? success "参考答案"
       $\mathrm{pf}(A) = a_{12}a_{34} - a_{13}a_{24} + a_{14}a_{23}$。注意每一项都对应 $\{1,2,3,4\}$ 的一种完美匹配。

4. **[性质] 证明：若 $A$ 是奇数阶的反对称矩阵，则 $\mathrm{pf}(A)$ 无法定义（或 $\det A = 0$）。**
   ??? success "参考答案"
       对于奇数阶反对称矩阵，$A^T = -A$ 导致 $\det A = (-1)^n \det A = -\det A$，故 $\det A = 0$。Pfaffian 仅对偶数阶矩阵有定义，因为奇数个元素无法两两配对。

5. **[组合] 解释为什么在图论中，Pfaffian 被用来计算完美匹配（Perfect Matchings）的数量。**
   ??? success "参考答案"
       Pfaffian 定义中的每一项正好对应图的一种完美匹配。如果能找到一个特殊的定向（Pfaffian 定向），使得所有匹配项的符号都一致，那么计算该图对应反对称邻接矩阵的 Pfaffian 就等于完美匹配的总数。

6. **[FKT] 什么是 FKT 算法？它的复杂度是多少？**
   ??? success "参考答案"
       FKT 算法用于计算**平面图**的完美匹配数。它先寻找一个 Pfaffian 定向，然后计算反对称矩阵的 Pfaffian。由于计算 Pfaffian 可以在 $O(n^3)$ 时间内完成（类似于 Gauss 消元），它将原本是 #P-hard 的计数问题转化为了多项式时间问题。

7. **[辛矩阵] 证明：标准辛矩阵 $J = \begin{pmatrix} 0 & I \\ -I & 0 \end{pmatrix}$ 的 Pfaffian 绝对值为 1。**
   ??? success "参考答案"
       因为 $\det J = 1$，由 $\mathrm{pf}(J)^2 = \det J = 1$，知 $\mathrm{pf}(J) = \pm 1$。具体的符号取决于指标的排列约定（通常为 $(-1)^{n(n-1)/2}$）。

8. **[外代数] Pfaffian 在外代数 $\Lambda(V)$ 中对应什么？**
   ??? success "参考答案"
       它对应于 2-形式 $\omega = \sum_{i<j} a_{ij} e_i \wedge e_j$ 的第 $n$ 次幂的系数：$\omega^n / n! = \mathrm{pf}(A) e_1 \wedge \dots \wedge e_{2n}$。

9. **[物理] 二维 Ising 模型的配分函数为何能用 Pfaffian 表达？**
   ??? success "参考答案"
       因为二维 Ising 模型可以映射为晶格上的二聚体（Dimer）覆盖问题。由于格点图是平面图，其统计总和（配分函数）正好可以转化为一个巨大反对称矩阵的 Pfaffian。

10. **[爱因斯坦思考题] Pfaffian 描述了“成对出现”的代数稳定性。在量子场论中，费米子的路径积分可以用 Pfaffian 表达。为什么上帝在设计费米子（遵循泡利不相容原理）时，选择了具有符号抵消特征的 Pfaffian（或行列式），而没有选择全正的积和式？**
    ??? success "参考答案"
        这反映了“反对称性”是维持微观世界秩序的根本。费米子的波函数交换变号（由 Pfaffian 的完美匹配项体现），这种负反馈机制导致了不相容原理——两个费米子不能占据同一个态。如果没有这种变号抵消（即变成了积和式），费米子就会像玻色子一样发生塌缩，物质世界将无法形成稳定的原子和复杂的化学结构。Pfaffian 的精妙之处在于它不仅捕获了配对的关联（完美匹配），还通过符号编码了宇宙最底层的排他性秩序。

## 本章小结

本章揭示了反对称矩阵独特的解析结构——Pfaffian，并阐明了其在代数与组合中的核心作用：

1. **核心恒等式**：确立了 $\mathrm{pf}(A)^2 = \det(A)$，将 Pfaffian 定位为行列式的内在平方根。
2. **组合计数**：通过完美匹配的视角，将 Pfaffian 转化为图论中复杂计数问题的代数表达。
3. **FKT 算法**：展示了平面图完美匹配计数的多项式时间解法，确立了 Pfaffian 在算法复杂性理论中的分水岭地位。
4. **解析表示**：引入了外代数定义，将 Pfaffian 与微分形式的最高幂次建立了自然的几何联系。
5. **跨学科应用**：探讨了 Pfaffian 在统计力学 Ising 模型精确解、费米子物理以及微分几何 Euler 类中的深刻渗透，证明了反对称结构是描述相互作用系统的重要语言。
