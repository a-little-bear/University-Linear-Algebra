# 第 51 章 四元数矩阵与除环上的线性代数

<div class="context-flow" markdown>

**前置**：矩阵运算 (Ch2) · 特征值 (Ch6) · SVD (Ch11)

**本章脉络**：四元数回顾 → 除环上的线性代数 → 四元数矩阵 → 左/右特征值 → 四元数行列式 → 四元数 SVD → 复表示 → 旋转表示

**延伸**：四元数在计算机图形学（避免万向节锁）、航天工程（姿态表示）、机器人学（旋转插值 SLERP）中是标准工具；Frobenius 定理指出 $\mathbb{R}, \mathbb{C}, \mathbb{H}$ 是仅有的有限维实结合除代数

</div>

线性代数的经典理论建立在域（field）上——乘法交换且每个非零元素可逆的代数结构。然而，某些重要的应用——特别是三维旋转的表示——自然地引出了一种乘法不交换的"域"，即**四元数** $\mathbb{H}$。

---

## 51.1 四元数与除环线性代数

!!! definition "定义 51.1 (四元数)"
    四元数由基 $\{1, i, j, k\}$ 生成，满足：
    $$i^2 = j^2 = k^2 = ijk = -1$$
    乘法非交换，例如 $ij = k$ 但 $ji = -k$。任何非零四元数 $q$ 有逆元 $q^{-1} = \bar{q}/|q|^2$。

!!! theorem "定理 51.4 (右特征值)"
    设 $A$ 为四元数矩阵。由于非交换性，必须区分左特征值 ($Av = \mu v$) 和右特征值 ($Av = v \lambda$)。
    右特征值具有相似性：若 $\lambda$ 是右特征值，则 $s^{-1} \lambda s$ 也是。每个特征值相似类中恰有一个复数（标准右特征值）。

---

## 51.2 四元数旋转表示

!!! theorem "定理 51.10"
    单位四元数 $q$ 与三维旋转 $SO(3)$ 一一对应（差一个符号）。旋转映射为：
    $$v' = q v \bar{q}$$
    其中 $v$ 是纯虚四元数。这种表示方法比旋转矩阵更紧凑且能避免万向节死锁。

---

## 练习题

1. **[概念] 什么是“除环”（Division Ring）？四元数体 $\mathbb{H}$ 与复数域 $\mathbb{C}$ 的主要区别是什么？**
   ??? success "参考答案"
       除环是每个非零元素都有乘法逆元，但不满足乘法交换律的环。四元数与复数的主要区别就在于**非交换性**（例如 $ij = k$ 但 $ji = -k$）。这导致了四元数矩阵理论中必须区分左乘标量和右乘标量。

2. **[基础] 验证单位四元数 $q = \frac{1}{\sqrt{2}}(1 + i)$ 对应的逆元是什么？**
   ??? success "参考答案"
       由于 $|q|=1$，其逆元等于其共轭：$q^{-1} = \bar{q} = \frac{1}{\sqrt{2}}(1 - i)$。

3. **[旋转] 证明：任何单位四元数 $q = \cos(\theta/2) + \mathbf{u} \sin(\theta/2)$ 作用于向量 $v$ 的映射 $v' = qv\bar{q}$ 是绕 $\mathbf{u}$ 轴旋转 $\theta$ 角。**
   ??? success "参考答案"
       这是四元数旋转的轴角表示形式。通过将 $v$ 分解为平行和垂直于 $\mathbf{u}$ 的分量，并利用四元数乘法规则，可以验证平行分量保持不变，而垂直分量在 $\mathbf{u}$ 所在的平面内旋转了 $\theta$ 角。

4. **[特征值] 为什么在四元数矩阵论中，右特征值（Right Eigenvalues）比左特征值更常用？**
   ??? success "参考答案"
       因为右特征值具有**相似不变性**。若 $\lambda$ 是 $A$ 的右特征值（$Av = v\lambda$），则对于任何 $q \ne 0$，$q^{-1}\lambda q$ 也是 $A$ 的右特征值。这允许我们将特征值聚类为“标准右特征值”（复数形式），从而建立类似于复矩阵的谱理论。左特征值则不具备这种良好的代数结构。

5. **[计算] 求 $1 \times 1$ 四元数矩阵 $A = [j]$ 的标准右特征值。**
   ??? success "参考答案"
       $A$ 的右特征值是所有满足 $s^{-1} j s$ 形式的四元数。这代表了所有纯虚单位四元数。其中的标准右特征值（即实部非负、虚部仅含 $i$ 且非负的复数）是 $i$。

6. **[Hermite] 证明：四元数 Hermite 矩阵（$A = A^H$）的右特征值必定是实数。**
   ??? success "参考答案"
       设 $Av = v\lambda$。则 $v^H Av = v^H v\lambda$。由于 $(v^H Av)^H = v^H A^H v = v^H Av$，标量 $v^H Av$ 必须是实数。又 $v^H v$ 是正实数，故 $\lambda$ 必须是实数。

7. **[复表示] 简述将 $n \times n$ 四元数矩阵转化为 $2n \times 2n$ 复矩阵的“复表示”方法。**
   ??? success "参考答案"
       将每个四元数 $q = z_1 + z_2 j$ 替换为一个 $2 \times 2$ 的复矩阵 $\begin{pmatrix} z_1 & z_2 \\ -\bar{z}_2 & \bar{z}_1 \end{pmatrix}$。这种映射保持了矩阵的加法和乘法结构，使得我们可以利用成熟的复矩阵算法来解决四元数矩阵问题。

8. **[行列式] 为什么四元数矩阵没有像 $\det(A) = \sum \operatorname{sgn}(\sigma) \prod a_{i\sigma(i)}$ 这样简单的行列式定义？**
   ??? success "参考答案"
       由于乘法不交换，公式中 $\prod a_{i\sigma(i)}$ 项的相乘顺序会极大地改变结果，且无法保证行列式的乘法分配律 $\det(AB) = \det(A)\det(B)$。因此必须引入 Study 行列式或 Dieudonné 行列式等更复杂的替代定义。

9. **[SVD] 四元数矩阵是否存在奇异值分解（SVD）？其奇异值是四元数还是实数？**
   ??? success "参考答案"
       存在。任何四元数矩阵 $A$ 都可以分解为 $U\Sigma V^H$，其中 $U, V$ 是四元数酉矩阵，而 $\Sigma$ 是**实非负**对角矩阵。其奇异值与复矩阵一样，都是实数。

10. **[爱因斯坦思考题] 爱因斯坦在 1905 年证明了洛伦兹变换。后来物理学家发现，洛伦兹群的二重覆盖是 $SL(2,\mathbb{C})$，而旋转群的二重覆盖是单位四元数群 $S^3$。为什么使用非交换的四元数（或者说 Spinor 语言）来描述旋转，比使用交换的实数坐标更加“接近宇宙的本质”？**
    ??? success "参考答案"
        实数坐标只能描述“物体的指向”，而四元数（旋量）捕捉了旋转路径的“拓扑连通性”。旋转 $360^\circ$ 后，物体指向虽恢复，但旋量波函数会反号，只有旋转 $720^\circ$ 才能彻底复原。这种非交换结构解释了电子自旋 1/2 的奇异特性。爱因斯坦的哲学启示我们：宇宙最底层的对称性不是简单的几何位置重合，而是代数结构的完备性。四元数通过牺牲交换律，换取了对三维空间旋转群流形最纯粹、最无冗余的整体描述。

## 本章小结

本章探讨了在线性代数中引入非交换除环（四元数体 $\mathbb{H}$）后的深层变革与应用：

1. **四元数代数基础**：回顾了 Hamilton 的四元数构造及其非交换乘法规则，确立了其在描述旋转方面的天然优势。
2. **除环线性代数**：明确了在非交换环境下区分左右特征值、左线性与右线性的必要性，并利用 Steinitz 交换定理保证了维数概念的稳定性。
3. **右特征值理论**：建立了四元数矩阵的特征值相似类理论，通过“标准右特征值”将复杂的非交换谱问题桥接回复分析领域。
4. **分解与表示**：推导了四元数矩阵的谱定理和 SVD 分解，并介绍了复表示技术，展示了如何通过维数翻倍将四元数运算转化为复矩阵运算。
5. **运动学应用**：深入分析了单位四元数与三维旋转 $SO(3)$ 的对应关系，论证了四元数在避免万向节锁和实现平滑插值（SLERP）中的卓越性能。
