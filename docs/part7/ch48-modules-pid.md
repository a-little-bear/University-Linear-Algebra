# 第 48 章 主理想整环上的模与 Smith 标准形

<div class="context-flow" markdown>

**前置**：矩阵代数(Ch2) · 环与域 · 行列式(Ch3)

**本章脉络**：环与模 → 主理想整环 (PID) → Smith 标准形 (SNF) → 幺模等价 → 不变因子 → PID 上有限生成模的结构定理 → 在 Jordan 标准形中的应用

**延伸**：Smith 标准形是理解矩阵 Jordan 形和有限生成 Abel 群结构的统一代数工具

</div>

对域上矩阵的研究可以自然地推广到环上矩阵。当环是**主理想整环** (PID) 时（如整数环 $\mathbb{Z}$ 或多项式环 $F[x]$），我们可以定义一种称为 **Smith 标准形** 的规范形式。该形式为幺模变换下的矩阵等价提供了一组完备的不变量，并且是有限生成模分类理论的核心。

---

## 48.1 Smith 标准形 (SNF)

!!! definition "定义 48.1 (幺模矩阵)"
    若环 $R$ 上的方阵 $U$ 的行列式是 $R$ 中的单位（可逆元），则称 $U$ 为**幺模矩阵**。这等价于 $U^{-1}$ 存在且其条目均在 $R$ 中。

!!! theorem "定理 48.1 (SNF 的存在性)"
    设 $A$ 是 PID $R$ 上的 $m \times n$ 矩阵。则存在幺模矩阵 $P \in M_m(R)$ 和 $Q \in M_n(R)$ 使得 $PAQ = D$，其中 $D$ 是类对角矩阵：
    $$D = \begin{pmatrix} d_1 & & & 0 \\ & d_2 & & \\ & & \ddots & \\ 0 & & & d_r \end{pmatrix}, \quad d_i \mid d_{i+1}$$
    元素 $d_1, \dots, d_r$ 在相差一个单位的意义下是唯一的，称为 $A$ 的**不变因子**。

---

## 练习题

1. **[不变因子] 计算整数矩阵 $A = \begin{pmatrix} 2 & 4 \\ 4 & 8 \end{pmatrix}$ 在 $\mathbb{Z}$ 上的 Smith 标准形。**
   ??? success "参考答案"
       所有条目的最大公约数为 $d_1 = \gcd(2, 4, 4, 8) = 2$。由于行列式为 0，秩为 1。因此 SNF 为 $\begin{pmatrix} 2 & 0 \\ 0 & 0 \end{pmatrix}$。

2. **[行列式因子] 定义第 $k$ 个行列式因子 $\delta_k(A)$ 及其与不变因子 $d_i$ 的关系。**
   ??? success "参考答案"
       $\delta_k(A)$ 是 $A$ 的所有 $k \times k$ 子式（Minors）的最大公约数。不变因子由 $d_k = \delta_k(A) / \delta_{k-1}(A)$ 给出（约定 $\delta_0 = 1$）。

3. **[多项式环] 求 $A(x) = \begin{pmatrix} x-1 & 0 \\ 0 & (x-1)^2 \end{pmatrix}$ 在 $\mathbb{C}[x]$ 上的 SNF。**
   ??? success "参考答案"
       由于 $(x-1)$ 整除 $(x-1)^2$，该矩阵已经是 SNF 形式。不变因子为 $d_1(x) = x-1$ 且 $d_2(x) = (x-1)^2$。

4. **[Abel群] 利用 SNF 求 Abel 群 $G = \mathbb{Z}^2 / \operatorname{Im}(A)$ 的结构，其中 $A = \begin{pmatrix} 2 & 0 \\ 0 & 3 \end{pmatrix}$。**
   ??? success "参考答案"
       $A$ 的 SNF 为 $\begin{pmatrix} 1 & 0 \\ 0 & 6 \end{pmatrix}$（因为 $\gcd(2,3)=1$ 且 $\det=6$）。因此 $G \cong \mathbb{Z}/1\mathbb{Z} \oplus \mathbb{Z}/6\mathbb{Z} \cong \mathbb{Z}_6$。

5. **[有理标准形] 解释特征矩阵 $xI - A$ 的 SNF 如何决定 $A$ 的有理标准形。**
   ??? success "参考答案"
       $xI - A$ 在 $F[x]$ 上的不变因子 $d_i(x)$ 恰好是矩阵 $A$ 的不变因子。有理标准形是由这些 $d_i(x)$ 的伴随矩阵构成的分块对角矩阵。

6. **[幺模等价] 证明两个矩阵 $A, B$ 幺模等价当且仅当它们具有相同的不变因子。**
   ??? success "参考答案"
       必要性：幺模变换保持子式的最大公约数（即行列式因子）不变。充分性：由 SNF 的存在性和唯一性定理可得。

7. **[算法] 概述在 $\mathbb{Z}$ 上通过行列变换消除首行首列非零条目的步骤。**
   ??? success "参考答案"
       使用欧几里得算法。通过反复减去倍数，将绝对值最小的非零项移动到 $(1,1)$ 位置，并用它消除同列或同行的其他项。若产生余数，则重复此过程直至 $(1,1)$ 处为该行该列的 GCD。

8. **[Jordan形] $xI - A$ 的 SNF 如何与 $A$ 的 Jordan 块关联？**
   ??? success "参考答案"
       不变因子 $d_i(x)$ 可以进一步分解为初等因子 $(x-\lambda_j)^{k_{ij}}$。每个初等因子对应一个特征值 $\lambda_j$ 的 $k_{ij}$ 阶 Jordan 块。

9. **[模结构] 用 SNF 表述 PID 上有限生成模的结构定理。**
   ??? success "参考答案"
       任何此类模 $M$ 均同构于 $R^k \oplus R/(d_1) \oplus \dots \oplus R/(d_r)$，其中 $R^k$ 是自由部分，$d_i$ 是关系矩阵的不变因子。

10. **[秩] 证明 $A$ 的 SNF 中非零不变因子的数量等于 $A$ 的秩。**
    ??? success "参考答案"
        幺模等价保持矩阵在商域上的秩（因为 $P, Q$ 在商域上可逆）。在对角形式下，秩显然等于非零对角元的个数。

## 本章小结

本章确立了 Smith 标准形作为 PID 上矩阵基础结构分解的地位：

1. **代数不变量**：定义了不变因子和行列式因子作为幺模等价下的完备不变量集。
2. **规范化分解**：开发了 SNF 算法，通过行列变换在一般环中实现矩阵的“对角化”。
3. **模理论链接**：将矩阵论与有限生成模的分类联系起来，为 Abel 群和线性算子提供了统一框架。
4. **谱关联**：展示了特征矩阵的 SNF 如何生成有理标准形和 Jordan 标准形。
