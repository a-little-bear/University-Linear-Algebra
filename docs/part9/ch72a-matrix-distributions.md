# 第 72A 章 矩阵值随机变量与分布

<div class="context-flow" markdown>

**前置**：随机矩阵 (Ch23) · 正定矩阵 (Ch16) · 概率论基础 · 统计学基础

**本章脉络**：矩阵值随机变量的定义 $\to$ 矩阵正态分布 ($MN_{n,p}$) $\to$ 协方差的 Kronecker 结构 $\to$ Wishart 分布（样本协方差的代数模型） $\to$ 逆 Wishart 分布（共轭先验） $\to$ 矩阵变量 T-分布 $\to$ 矩阵 Beta 与 Gamma 分布 $\to$ 应用：多元方差分析 (MANOVA)、贝叶斯多元回归、计量经济学中的结构建模

**延伸**：矩阵分布是多元统计的支柱；它将标量概率分布提升到了高维张量空间，揭示了多个变量在时间与空间维度上的联合波动规律，是处理金融市场与传感器网络数据的数学利器

</div>

在传统的统计学中，我们研究随机变量 $X$ 或随机向量 $\mathbf{x}$。但在处理具有时间序列的多元数据（如 $n$ 个时刻、 $p$ 个指标的股票收益）时，最自然的描述对象是随机矩阵。**矩阵分布**（Matrix Distributions）不仅描述了矩阵元素的整体波动，还通过特定的乘积结构刻画了变量间复杂的协方差关系。本章将介绍这一现代统计学的高级代数语言。

---

## 72A.1 矩阵正态分布

!!! definition "定义 72A.1 (矩阵正态分布)"
    随机矩阵 $X \in \mathbb{R}^{n \times p}$ 满足 **矩阵正态分布** $MN_{n,p}(M, U, V)$，如果其向量化形式满足：
    $$\operatorname{vec}(X) \sim \mathcal{N}(\operatorname{vec}(M), V \otimes U)$$
    - $M$：$n \times p$ 均值矩阵。
    - $U$：$n \times n$ 行协方差矩阵（描述样本间的相关性）。
    - $V$：$p \times p$ 列协方差矩阵（描述特征间的相关性）。

---

## 72A.2 Wishart 分布

!!! definition "定义 72A.2 (Wishart 分布)"
    设 $X_1, \ldots, X_n$ 是来自 $\mathcal{N}(0, \Sigma)$ 的独立样本。则随机矩阵 $S = \sum X_i X_i^T$ 满足 **Wishart 分布**，记作 $S \sim W_p(n, \Sigma)$。
    **地位**：Wishart 分布是多元分析中“样本协方差矩阵”的理论模型，正如 $\chi^2$ 分布是标量方差的模型。

---

## 72A.3 逆 Wishart 分布与贝叶斯

!!! definition "定义 72A.3 (逆 Wishart 分布)"
    若 $S \sim W_p(n, \Sigma)$，则 $S^{-1}$ 满足**逆 Wishart 分布**。
    **应用**：在贝叶斯统计中，它是多元正态分布协方差矩阵的**共轭先验**，极大简化了后验概率的矩阵计算。

---

## 72A.4 矩阵 T-分布

!!! technique "重尾分布"
    矩阵 T-分布是矩阵正态分布与 Wishart 尺度的混合。它比正态分布更鲁棒，能够捕捉金融数据中的“胖尾”现象（即极端事件发生频率高于正态预测）。

---

## 练习题

1. **[基础] 写出矩阵正态分布 $\operatorname{vec}(X)$ 的协方差矩阵。**

   ??? success "参考答案"
       $V \otimes U$。这反映了行与列相关性的解耦（Kronecker 结构）。

2. **[期望] 若 $X \sim MN(M, U, V)$，求 $E[X]$。**

   ??? success "参考答案"
       $E[X] = M$。

3. **[Wishart] 证明：若 $S \sim W_p(n, \Sigma)$，则 $E[S] = n\Sigma$。**

   ??? success "参考答案"
       $E[S] = E[\sum X_i X_i^T] = \sum E[X_i X_i^T] = \sum \Sigma = n\Sigma$。

4. **[性质] 随机矩阵 $S \sim W_p(n, \Sigma)$ 什么时候是奇异的？**

   ??? success "参考答案"
       当样本量 $n < p$ 时，由于 $S$ 是 $n$ 个秩为 1 的矩阵之和，其秩最大为 $n$，故在 $p$ 维空间中必奇异。

5. **[不变性] 若 $X \sim MN(M, U, V)$，证明线性变换 $AXB$ 仍满足矩阵正态分布。**

   ??? success "参考答案"
       由于 $\operatorname{vec}(AXB) = (B^T \otimes A) \operatorname{vec}(X)$，线性变换保持正态性，协方差矩阵变为 $(B^T V B) \otimes (A U A^T)$。

6. **[Beta] 什么是矩阵值 Beta 分布？**

   ??? success "参考答案"
       定义在两个 Wishart 变量的比例（通过 $S_1 (S_1+S_2)^{-1}$ 形式）上的分布，用于多元分析中的假设检验（如 Wilk's Lambda）。

7. **[计算] 若 $X \in \mathbb{R}^{2 \times 2}$，且 $U=I, V=I, M=0$，求 $P(\|X\|_F^2 > t)$ 的分布类型。**

   ??? success "参考答案"
       $\|X\|_F^2 = \sum x_{ij}^2$。由于各分量独立同分布 $\mathcal{N}(0, 1)$，其平方和满足自由度为 4 的 $\chi^2$ 分布。

8. **[贝叶斯] 为什么称逆 Wishart 是共轭先验？**

   ??? success "参考答案"
       因为如果似然函数是多元正态的且先验是逆 Wishart，那么计算出的后验分布仍然是逆 Wishart 分布，维持了代数形式的一致性。

9. **[关系] 简述矩阵分布与随机矩阵理论 (RMT) 的区别。**

   ??? success "参考答案"
       矩阵分布关注特定参数（均值、协方差）下的精确概率密度函数；RMT 关注维数 $n \to \infty$ 时的渐近谱性质（普适律）。

10. **[应用] 在信号处理中，如何利用 Wishart 分布检测信号？**

   ??? success "参考答案"
        通过比较观测到的样本协方差矩阵与噪声模型（Wishart）的谱偏差，若最大特征值显著超出 Wishart 预测的范围，则判定存在信号。

## 本章小结

矩阵分布确立了高维不确定性的代数逻辑：

1.  **协方差的分解**：通过 Kronecker 积，矩阵正态分布实现了对样本间时间相关性与特征间空间相关性的精准分离，极大地压缩了参数空间。
2.  **二次型的统计化**：Wishart 分布证明了正定矩阵不仅是代数对象，更是描述多变量波动强度的自然概率测度，是所有多元推断的基石。
3.  **贝叶斯的一致性**：共轭先验的代数美感展示了线性代数与概率推理的深层统一，为处理现代高维数据的动态学习提供了高效的闭式解框架。
