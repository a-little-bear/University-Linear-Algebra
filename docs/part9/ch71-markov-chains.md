# 第 71 章 Markov 链与随机矩阵

<div class="context-flow" markdown>

**前置**：非负矩阵与 Perron-Frobenius (Ch17) · 矩阵分析 (Ch14) · 概率论基础

**本章脉络**：离散时间 Markov 链 (DTMC) 定义 $\to$ 状态转移矩阵 $P$ $\to$ 状态分类：不可约、非周期、常返、瞬态 $\to$ 平稳分布 (Stationary Distribution) $\to$ 收敛定理：Perron-Frobenius 定理在随机过程中的体现 $\to$ 吸收 Markov 链与基础矩阵 $(I-Q)^{-1}$ $\to$ 平均首次到达时间 $\to$ 应用：Google PageRank（再次审视）、排队论、金融价格波动、博弈策略演化

**延伸**：Markov 链是描述“无记忆”演化系统的代数模板；它证明了复杂系统的长期趋向仅取决于转移矩阵的谱结构，是现代蒙特卡罗方法 (MCMC) 的数学心脏

</div>

未来只取决于现在，而与过去无关。这一简单的物理直觉演化成了概率论中最强大的模型——**Markov 链**。通过将系统的状态转移概率排列成矩阵，我们将随机过程的演化问题转化为了矩阵的幂运算和特征值分析。本章将展示线性代数如何为不确定的世界提供确定的渐近预测。

---

## 71.1 转移矩阵与概率分布

!!! definition "定义 71.1 (状态转移矩阵)"
    设系统有 $n$ 个状态。**转移矩阵** $P$ 的元素 $p_{ij}$ 表示从状态 $i$ 下一时刻转移到状态 $j$ 的概率。
    - **随机性质**：$P$ 的每一行元素之和均为 1（行随机矩阵）。
    - **分布演化**：若当前概率分布为行向量 $\pi_k$，则下一时刻分布为 $\pi_{k+1} = \pi_k P$。

---

## 71.2 平稳分布与谱分析

!!! definition "定义 71.2 (平稳分布)"
    满足 $\pi P = \pi$ 且 $\sum \pi_i = 1$ 的概率向量 $\pi$ 称为系统的**平稳分布**。
    **代数本质**：$\pi$ 是矩阵 $P^T$ 对应特征值 1 的特征向量。

!!! theorem "定理 71.1 (收敛定理)"
    若 $P$ 是不可约且非周期的（原初矩阵），则对于任何初始分布 $\pi_0$，系统均收敛于唯一的平稳分布：
    $$\lim_{k \to \infty} \pi_0 P^k = \pi$$
    **速度**：收敛速度取决于第二大特征值 $|\lambda_2|$（谱间隙）。

---

## 71.3 吸收 Markov 链

!!! technique "吸收态分析"
    若某些状态一旦进入便无法离开，则称该链为**吸收 Markov 链**。其转移矩阵可写为 $P = \begin{pmatrix} Q & R \\ 0 & I \end{pmatrix}$。
    - **基础矩阵**：$N = (I - Q)^{-1} = I + Q + Q^2 + \cdots$。
    - **意义**：$N_{ij}$ 代表在被吸收前，系统在瞬态 $j$ 停留的期望次数。

---

## 练习题

1. **[基础] 判定 $P = \begin{pmatrix} 0.5 & 0.5 \\ 0.2 & 0.8 \end{pmatrix}$ 是否为随机矩阵。**

   ??? success "参考答案"
       是的。每行元素非负且和均为 1。

2. **[平稳分布] 求上题中 $P$ 的平稳分布。**

   ??? success "参考答案"
       解 $(\pi_1, \pi_2) \begin{pmatrix} 0.5 & 0.5 \\ 0.2 & 0.8 \end{pmatrix} = (\pi_1, \pi_2)$。
       得 $0.5\pi_1 + 0.2\pi_2 = \pi_1 \implies 0.2\pi_2 = 0.5\pi_1 \implies \pi_2 = 2.5\pi_1$。
       结合 $\pi_1 + \pi_2 = 1$，解得 $\pi = (2/7, 5/7)$。

3. **[谱半径] 证明随机矩阵的谱半径 $\rho(P) = 1$。**

   ??? success "参考答案"
       由于 $P \mathbf{1} = \mathbf{1}$，1 是特征值。又因为 $\|P\|_\infty = 1$，由谱半径不大于任何范数知 $\rho(P) \le 1$。故 $\rho(P) = 1$。

4. **[周期性] 判定 $P = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$ 的平稳分布及收敛性。**

   ??? success "参考答案"
       平稳分布为 $(0.5, 0.5)$。但由于是周期的（2-步回到原点），系统不会收敛，而是在 $(1, 0)$ 和 $(0, 1)$ 之间跳跃。

5. **[基础矩阵] 在吸收链中，$Q = \begin{pmatrix} 0.5 \end{pmatrix}$，求基础矩阵 $N$。**

   ??? success "参考答案"
       $N = (1 - 0.5)^{-1} = 2$。意味着在被吸收前平均在瞬态停留 2 次。

6. **[应用] 为什么 PageRank 算法本质上是一个 Markov 链？**

   ??? success "参考答案"
       网页被视为状态，链接视为转移。用户随机点击的行为构成了转移矩阵，网页排名即为该矩阵的平稳分布分量。

7. **[性质] 证明：若 $P$ 是正矩阵（全正），则平稳分布唯一。**

   ??? success "参考答案"
       由 Perron-Frobenius 定理，正矩阵有唯一的模最大的正特征值 1，且对应的一维特征空间包含正特征向量（即平稳分布）。

8. **[计算] 求 $P^k$ 当 $k \to \infty$，若 $P = \begin{pmatrix} 1 & 0 \\ 0.5 & 0.5 \end{pmatrix}$。**

   ??? success "参考答案"
       这是一个吸收链，状态 1 为吸收态。$Q = (0.5), R = (0.5)$。$P^\infty = \begin{pmatrix} 1 & 0 \\ 1 & 0 \end{pmatrix}$。最终所有个体都被吸收到状态 1。

9. **[复杂性] 谱间隙 $1 - |\lambda_2|$ 越大，收敛速度越快还是越慢？**

   ??? success "参考答案"
       越快。误差项以 $|\lambda_2|^k$ 的速度消失。

10. **[极限] 若 $P$ 是双随机矩阵，其平稳分布是什么？**

   ??? success "参考答案"
        均匀分布 $\pi = (1/n, \ldots, 1/n)$。因为 $\mathbf{1} P = \mathbf{1}$。

## 本章小结

Markov 链是概率与代数的终极共振：

1.  **确定性的极限**：它证明了随机过程的长期行为并非随机，而是由转移矩阵的 Perron 向量所预设的确定性结果。
2.  **结构的稳定性**：通过状态分类与不可约性分析，该理论揭示了系统“记忆丧失”的速度与网络拓扑结构（谱间隙）的定量联系。
3.  **计算的工程化**：从吸收态的求逆到 PageRank 的幂迭代，Markov 链将深刻的统计哲学转化为高效的线性代数算法，确立了处理不确定性系统的标准协议。
