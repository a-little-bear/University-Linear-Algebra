# 第 71 章 马尔可夫链与随机过程

<div class="context-flow" markdown>

**前置**：非负矩阵(Ch17) · 特征值(Ch6) · 概率论基础

**本章脉络**：状态空间与转移矩阵 → 概率分布向量 → Chapman-Kolmogorov 方程 → 稳态分布 → 遍历性 → 周期性与分类 → 吸收马尔可夫链 → 基本矩阵 → PageRank 算法

**延伸**：马尔可夫链是 PageRank 搜索引擎、金融序列建模和现代自然语言处理（HMM）的核心

</div>

马尔可夫链利用非负矩阵描述了离散状态空间上的随机演化。其核心特征是系统的未来状态仅取决于当前算子的作用，而与历史轨迹无关。这一特性使得线性代数的谱理论能够完整地刻画随机系统的长期均衡行为。

---

## 71.1 转移概率矩阵与谱结构

!!! definition "定义 71.1 (行随机矩阵)"
    转移矩阵 $P$ 的元素 $p_{ij}$ 表示从状态 $i$ 转移到 $j$ 的概率。满足 $p_{ij} \ge 0$ 且 $\sum_j p_{ij} = 1$。概率分布行向量 $\pi_k^T$ 的演化规律遵循线性映射 $\pi_{k+1}^T = \pi_k^T P$。

!!! theorem "定理 71.1 (遍历定理与唯一平衡态)"
    若转移矩阵 $P$ 是不可约（Irreducible）且非周期（Aperiodic）的，则根据 Perron-Frobenius 定理，其谱半径 $\rho(P) = 1$ 是单特征值。存在唯一的稳态分布 $\pi^*$ 满足 $\pi^T P = \pi^T$，且系统从任意初始分布收敛至此稳态。

---

## 练习题

1. **[单位特征值] 证明：对于任意行随机矩阵 $P$，1 必然是其特征值。**
   ??? success "参考答案"
       设全 1 向量为 $\mathbf{1}$。由定义 $\sum_j p_{ij} = 1$，可得 $P \mathbf{1} = \mathbf{1} \cdot 1$。这说明 $\mathbf{1}$ 是 $P$ 对应特征值 1 的右特征向量。

2. **[收敛速率] 证明：马尔可夫链收敛到稳态分布的速度由第二大特征值 $|\lambda_2|$ 决定。定义系统的谱隙（Spectral Gap）。**
   ??? success "参考答案"
       由谱分解 $\pi_k^T = \pi^* + \sum_{i=2}^n c_i \lambda_i^k v_i^T$。当 $k \to \infty$ 时，误差项受 $|\lambda_2|^k$ 支配。谱隙 $1 - |\lambda_2|$ 越大，收敛速度越快。

3. **[计算] 给定转移矩阵 $P = \begin{pmatrix} 0.7 & 0.3 \\ 0.2 & 0.8 \end{pmatrix}$。求解该系统的平稳概率分布向量。**
   ??? success "参考答案"
       解方程组 $\begin{pmatrix} \pi_1 & \pi_2 \end{pmatrix} \begin{pmatrix} -0.3 & 0.3 \\ 0.2 & -0.2 \end{pmatrix} = 0$ 且 $\pi_1 + \pi_2 = 1$。
       由 $-0.3\pi_1 + 0.2\pi_2 = 0$ 得 $3\pi_1 = 2\pi_2$。解得 $\pi^* = [0.4, 0.6]^T$。

4. **[周期性判定] 给定 $P = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$。分析该矩阵的特征值及分布向量的渐近行为。**
   ??? success "参考答案"
       特征值为 $\pm 1$。矩阵是周期的（周期为 2）。分布向量将在两个状态间不断震荡，不会收敛到固定值，即使平稳方程的解存在。

5. **[PageRank分析] 说明在 Google 的 PageRank 算法中，如何通过引入“阻尼因子”将网页链接矩阵转化为原始矩阵。**
   ??? success "参考答案"
       原始链接矩阵可能存在悬挂节点（零行）或循环。通过 $G = d P + (1-d) \frac{1}{n} J$ 的凸组合，使得 $G$ 的所有元素严格为正。这消除了周期性并保证了不可约性，从而确保了幂迭代法的唯一收敛。

6. **[吸收链] 证明：在吸收马尔可夫链中，从任意状态出发被吸收的概率为 1。定义其基本矩阵 $N = (I-Q)^{-1}$。**
   ??? success "参考答案"
       由于 $Q$ 描述了非吸收状态间的转移，其谱半径 $\rho(Q) < 1$。级数 $I+Q+Q^2+\dots$ 收敛于 $(I-Q)^{-1}$。这代表非吸收状态的存留概率随时间指数级衰减至零。

7. **[细致平衡] 定义马尔可夫链的可逆性，并说明其与矩阵 $DP$（其中 $D$ 为稳态对角阵）对称性的关系。**
   ??? success "参考答案"
       细致平衡条件为 $\pi_i p_{ij} = \pi_j p_{ji}$。这等价于对角阵 $\Delta_\pi$ 满足 $\Delta_\pi P = P^T \Delta_\pi$，即 $P$ 在 $\pi$ 加权内积下是自共轭算子。

8. **[混合时间] 简述混合时间（Mixing Time）与矩阵谱半径之外特征值的关系。**
   ??? success "参考答案"
       Mixing Time 是分布与稳态的总变差距离缩减到 $\epsilon$ 所需的时间步。它反比于谱隙 $\gamma = 1 - \lambda_2$。较小的 $\lambda_2$ 意味着随机游走能更迅速地遍历状态空间。

9. **[图论联系] 证明：转移矩阵 $P$ 不可约当且仅当其关联有向图是强连通的。**
   ??? success "参考答案"
       不可约意味着 $(I+P)^{n-1} > 0$。这等价于在图中任意两点间都存在至少一条有限长度的路径，即满足强连通性定义。

10. **[遍历性] 解释遍历性（Ergodicity）在矩阵语言下是如何通过主特征空间的投影来体现的。**
    ??? success "参考答案"
        遍历性意味着 $P^k \to \mathbf{1} \pi^T$。这说明矩阵幂算子在长期演化后退化为秩 1 投影算子，其将任何初始分布映射到属于特征值 1 的一维不变子空间上。

## 本章小结

本章论述了描述随机演化行为的线性算子理论：

1. **概率转移架构**：建立了转移矩阵作为随机状态更新的核心算子模型。
2. **平衡态理论**：利用 Perron-Frobenius 定理确立了稳态分布的存在性、唯一性与收敛性。
3. **结构化分类**：区分了不可约、非周期及吸收链等不同结构的马尔可夫系统。
4. **算法映射**：展示了 PageRank 等现代算法如何将组合结构分析转化为大规模矩阵的特征向量求解。
