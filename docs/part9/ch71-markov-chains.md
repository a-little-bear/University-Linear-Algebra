# 第 71 章 Markov 链

<div class="context-flow" markdown>

**前置**：矩阵乘法(Ch2) · 特征值(Ch6) · 非负矩阵(Ch17) · 随机矩阵

**本章脉络**：Markov 链定义 → 转移概率矩阵 → Chapman-Kolmogorov 方程 → 状态分类（不可约、非周期） → 平稳分布 → 收敛到均衡 → 谱隙与混合时间 → 吸收 Markov 链 → 在 PageRank 中的应用

**延伸**：Markov 链是 Google 搜索 (PageRank) 的数学引擎，也是现代统计计算中 MCMC 采样的基础

</div>

Markov 链描述了这样一类随机系统的演化：其“给定当前状态，未来与过去独立”。这种无记忆性通过概率向量在**随机矩阵**下的线性映射得到了完美的刻画。

---

## 71.1 随机矩阵与均衡态

!!! definition "定义 71.1 (随机矩阵)"
    若方阵 $P$ 满足所有 $p_{ij} \ge 0$ 且每一行之和 $\sum_j p_{ij} = 1$，则称 $P$ 为**行随机矩阵**。它将概率向量映射为概率向量。

!!! theorem "定理 71.1 (平稳分布的收敛性)"
    若一个 Markov 链是不可约且非周期的（本原矩阵），则存在唯一的平稳分布 $\pi$ 满足 $\pi P = \pi$。此外，对于任何初始分布 $x_0$，都有 $\lim_{k \to \infty} x_0 P^k = \pi$。

---

## 练习题

1. **[随机性] 证明：若 $P$ 是随机矩阵，则 $\lambda=1$ 始终是 $P$ 的特征值。**
   ??? success "参考答案"
       令 $\mathbf{1}$ 为全 1 列向量。行和为 1 的条件等价于 $P \mathbf{1} = 1 \cdot \mathbf{1}$。因此 $\mathbf{1}$ 是 $P$ 对应于特征值 1 的右特征向量。由于 $P$ 与 $P^T$ 具有相同的谱，故 $1 \in \sigma(P)$。

2. **[平稳分布] 求转移矩阵 $P = \begin{pmatrix} 0.7 & 0.3 \\ 0.4 & 0.6 \end{pmatrix}$ 的平稳分布。**
   ??? success "参考答案"
       解方程组 $\pi P = \pi$ 且 $\pi_1 + \pi_2 = 1$。
       $0.7\pi_1 + 0.4\pi_2 = \pi_1 \implies 0.4\pi_2 = 0.3\pi_1 \implies \pi_1 = \frac{4}{3}\pi_2$。
       $\frac{4}{3}\pi_2 + \pi_2 = 1 \implies \pi_2 = 3/7, \pi_1 = 4/7$。
       故 $\pi = [4/7, 3/7]$。

3. **[混合时间] 解释谱隙 $1 - |\lambda_2|$ 如何决定 Markov 链的收敛速度。**
   ??? success "参考答案"
       $k$ 步后的误差大约为 $\|x_k - \pi\| \approx C |\lambda_2|^k$。谱隙越大意味着 $|\lambda_2|$ 越小，从而系统能以更快的几何级数速度收敛到均衡态。

4. **[不可约性] 叙述 Markov 链是不可约的图论判据。**
   ??? success "参考答案"
       与其转移矩阵 $P$ 关联的有向图必须是强连通的，即对于任意两个状态 $i$ 和 $j$，都存在一条概率非零的路径相连。

5. **[PageRank] 为什么 Google 的 PageRank 矩阵 $G = \alpha P + (1-\alpha) \frac{1}{n} J$ 保证具有唯一的平稳分布？**
   ??? success "参考答案"
       由于引入了 $(1-\alpha)\frac{1}{n}J$ 项（心灵感应项），矩阵 $G$ 变为严格正矩阵（$G \gg 0$）。根据 Perron-Frobenius 定理，严格正矩阵是本原的，保证了特征值 1 对应唯一的严格正特征向量。

6. **[吸收态] 定义吸收态及吸收 Markov 链矩阵的结构。**
   ??? success "参考答案"
       若 $p_{ii} = 1$，则称状态 $i$ 为吸收态。吸收链的矩阵可写为分块形式 $P = \begin{pmatrix} Q & R \\ 0 & I \end{pmatrix}$，其中 $Q$ 对应瞬态之间的转移。

7. **[基础矩阵] 在吸收 Markov 链中，矩阵 $(I-Q)^{-1}$ 有何用途？**
   ??? success "参考答案"
       $(I-Q)^{-1} = I + Q + Q^2 + \dots$ 被称为基础矩阵。其元素 $n_{ij}$ 代表了链在被吸收前，从瞬态 $i$ 开始进入瞬态 $j$ 的期望次数。

8. **[双随机性] 证明若 $P$ 是双随机矩阵，则均匀分布 $\pi = [\frac{1}{n}, \dots, \frac{1}{n}]$ 必为平稳分布。**
   ??? success "参考答案"
       若 $P$ 双随机，则其列和亦为 1，即 $\mathbf{1}^T P = \mathbf{1}^T$。两边除以 $n$ 得 $[\frac{1}{n} \dots \frac{1}{n}] P = [\frac{1}{n} \dots \frac{1}{n}]$。可见均匀分布是不变量。

9. **[可逆性] 叙述细致平衡方程（Detailed Balance Equation）及其意义。**
   ??? success "参考答案"
       方程为 $\pi_i p_{ij} = \pi_j p_{ji}$。若成立，则称该链是可逆的。可逆性保证了转移矩阵相似于一个对称矩阵，从而其特征值均为实数。

10. **[周期性] 提供一个不可约但具有周期性的 Markov 链例子。**
    ??? success "参考答案"
        $P = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$。链在状态 1 和 2 之间来回跳跃。它是不可约的（可达），但周期为 2（只能在偶数步回到初始态）。

## 本章小结

本章探讨了随机过程中的线性代数特性：

1. **状态转移**：将概率分布的演化建模为矩阵-向量乘法。
2. **均衡理论**：利用 Perron-Frobenius 定理确立了平稳分布的存在性与唯一性。
3. **谱动力学**：建立了收敛速率（混合时间）与转移算子谱隙之间的定量联系。
4. **网络排序**：展示了 Markov 链在大规模信息检索（PageRank）及瞬态分析中的强大威力。
