# 第 68B 章 机器人动力学

<div class="context-flow" markdown>

**前置**：运动学(Ch68A) · 矩阵微分(Ch47) · 特征值(Ch6)

**本章脉络**：拉格朗日方程 → 惯性矩阵(Inertia Matrix) → 离心力与科氏力矩阵 → 重力项 → 动力学方程的线性参数化 → 最小二乘识别 → 阻抗控制 → 虚功原理

**延伸**：惯性矩阵的正定性是控制律鲁棒性的数学前提；参数线性化性质使机器人通过运动自校准成为可能

</div>

机器人动力学研究关节力矩与运动轨迹之间的因果关系。通过拉格朗日力学或牛顿-欧拉法，多刚体系的运动规律被表达为以关节位置和速度为参数的矩阵非线性微分方程。

---

## 68B.1 动力学方程与代数性质

!!! definition "定义 68B.1 (标准二阶动力学模型)"
    一个 $n$ 自由度机器人的运动方程遵循以下矩阵形式：
    $$M(q) \ddot{q} + C(q, \dot{q}) \dot{q} + G(q) = \tau$$
    其中：
    - $M(q) \in \mathbb{R}^{n \times n}$ 是**惯性矩阵**（Inertia Matrix）；
    - $C(q, \dot{q}) \dot{q}$ 是科氏力（Coriolis）与离心力项；
    - $G(q)$ 是重力向量；
    - $\tau$ 是驱动力矩。

!!! theorem "定理 68B.1 (惯性矩阵的正定性)"
    对任意配置 $q$，惯性矩阵 $M(q)$ 始终是**对称正定**的（$M^T = M, M \succ 0$）。这源于系统总动能 $T = \frac{1}{2} \dot{q}^T M(q) \dot{q}$ 的物理正定性。

---

## 练习题

1. **[动能二次型] 证明：若系统的总动能为正，则惯性矩阵 $M(q)$ 必然不存在零特征值或负特征值。**
   ??? success "参考答案"
       动能 $T = \frac{1}{2}\dot{q}^T M \dot{q}$ 是关于 $\dot{q}$ 的二次型。由于物理系统的动能对任意非零速度都严格大于 0，该二次型是正定的。根据正定二次型的矩阵判据，$M$ 必须是对称正定阵。

2. **[能量守恒性质] 证明：矩阵 $\dot{M}(q) - 2C(q, \dot{q})$ 是反对称矩阵。该性质在控制律设计中有何用途？**
   ??? success "参考答案"
       由能量守恒导出 $\dot{T} = \dot{q}^T \tau$。展开微分项并代入方程可证 $\dot{q}^T (\dot{M}-2C) \dot{q} = 0$。此反对称性允许在自适应控制中构造 Lyapunov 函数项 $\frac{1}{2}\dot{q}^T M \dot{q}$ 时抵消掉 $M$ 的导数项。

3. **[线性参数化] 证明动力学方程关于物理参数集合 $\Phi$（如各杆质量、转动惯量）具有线性性质，即 $\tau = Y(q, \dot{q}, \ddot{q}) \Phi$。**
   ??? success "参考答案"
       动力学项如 $m \ddot{x}$ 或 $I \dot{\omega}$ 均为各杆件质量或惯量的线性倍数。通过将这些参数提取出来，可以构造回归矩阵 $Y$（Regressor Matrix），从而将非线性方程转化为参数辨识的线性回归问题。

4. **[系统辨识] 详述利用最小二乘法进行机器人物理参数辨识的代数流程。**
   ??? success "参考答案"
       采集一系列数据对 $(\tau_k, q_k, \dot{q}_k, \ddot{q}_k)$，构造超静定方程 $\mathbf{T} = \mathbf{Y} \Phi$。利用 Moore-Penrose 伪逆求解 $\Phi = (\mathbf{Y}^T \mathbf{Y})^{-1} \mathbf{Y}^T \mathbf{T}$。

5. **[阻抗控制] 分析阻抗控制中，目标惯性矩阵 $M_d$、阻尼矩阵 $B_d$ 与刚度矩阵 $K_d$ 均选为正定阵的必要性。**
   ??? success "参考答案"
       这保证了目标闭环系统 $M_d \ddot{e} + B_d \dot{e} + K_d e = 0$ 是渐近稳定的。任何特征值为负或零都会导致受力交互时的发散或静态偏差。

6. **[计算] 给定两轴机械臂，若其惯性矩阵 $M$ 的条件数 $\kappa(M)$ 极大，这对轨迹跟踪控制有何不利影响？**
   ??? success "参考答案"
       大的条件数意味着在某些奇异方向上，系统呈现出极高的敏感度或极大的惯性阻力。控制指令的数值截断误差会被放大，导致输出力矩震荡或伺服精度剧降。

7. **[模态分析] 分析线性化后的动力学系统，其固有频率与矩阵 $M^{-1}K$ 特征值之间的数学联系。**
   ??? success "参考答案"
       在线性化平衡点附近，$M \ddot{x} + K x = 0$。设 $x = v e^{j\omega t}$，代入得 $(\omega^2 M - K)v = 0$，即 $(M^{-1}K - \omega^2 I)v = 0$。固有频率的平方对应 $M^{-1}K$ 的特征值。

8. **[投影动力学] 解释约束运动下，动力学方程在约束子空间 $N(J)$ 上的投影表示。**
   ??? success "参考答案"
       利用雅可比矩阵 $J$ 的投影矩阵 $P = I - J^\dagger J$。受约束部分的动力学可以通过投影矩阵从全自由度方程中解耦，从而分析内力与运动的分离。

9. **[虚功平衡] 证明：末端外力 $f$ 产生的等效关节力矩满足 $\tau_{ext} = J^T f$。**
   ??? success "参考答案"
       由虚功原理 $\delta W = f^T \delta x = \tau^T \delta \theta$。利用映射 $\delta x = J \delta \theta$，代入得 $f^T J \delta \theta = \tau^T \delta \theta$。因 $\delta \theta$ 任意，故 $\tau = J^T f$。

10. **[逆动力学] 解释 Newton-Euler 递推算法在计算复杂度上优于直接展开 Lagrange 方程的代数原因。**
    ??? success "参考答案"
        Newton-Euler 算法利用了链式结构的局部耦合性，计算复杂度为 $O(n)$。直接展开 Lagrange 方程会涉及大量偏导数运算，产生冗余的项，其符号计算开销随 $n$ 呈指数或高阶多项式增长。

## 本章小结

本章论述了描述多自由度机械系统能量演化与受力特征的动力学框架：

1. **矩阵方程描述**：确立了由惯性、离心力与重力项组成的标准矩阵表达，统一了刚体系统的演化规律。
2. **正定性判据**：通过动能二次型揭示了惯性矩阵的物理约束，为控制稳定性分析提供了代数前提。
3. **辨识与估计**：展示了动力学方程的线性参数化性质，建立了从运动数据反推物理模型的线性代数路径。
4. **受力交互**：利用虚功原理确立了雅可比矩阵在力空间中的映射规则，形成了阻抗控制与力反馈的理论核心。
