# 第 68B 章 机器人动力学

<div class="context-flow" markdown>

**前置**：运动学(Ch68A) · 矩阵微分(Ch47) · 特征值(Ch6)

**本章脉络**：拉格朗日方程 → 惯性矩阵 ($M$) → 离心力与科氏力矩阵 ($C$) → 重力项 ($G$) → 线性参数化 → 最小二乘辨识 → 阻抗控制 → 虚功原理

**延伸**：惯性矩阵的正定性是控制律鲁棒性的数学前提；参数线性化性质使得通过运动数据自校准机器人物理参数成为可能

</div>

机器人动力学研究关节力矩与运动轨迹之间的因果关系。通过拉格朗日力学或牛顿-欧拉法，多刚体系的运动规律被表达为以关节位置和速度为参数的矩阵非线性微分方程。

---

## 68B.1 动力学方程与代数性质

!!! definition "定义 68B.1 (标准二阶模型)"
    一个 $n$ 自由度机器人的运动方程遵循以下矩阵形式：
    $$M(q) \ddot{q} + C(q, \dot{q}) \dot{q} + G(q) = \tau$$
    其中：
    - $M(q) \in \mathbb{R}^{n \times n}$ 是**惯性矩阵** (Inertia Matrix)；
    - $C(q, \dot{q}) \dot{q}$ 是科氏力与离心力项；
    - $G(q)$ 是重力向量；
    - $\tau$ 是驱动力矩。

!!! theorem "定理 68B.1 (惯性矩阵的正定性)"
    对任意配置 $q$，惯性矩阵 $M(q)$ 始终是**对称正定**的 ($M^T = M, M \succ 0$)。这源于系统总动能 $T = \frac{1}{2} \dot{q}^T M(q) \dot{q}$ 的物理正定性。

---

## 练习题

1. **[动能] 证明：若系统的总动能在任意非零速度下均为正，则惯性矩阵 $M(q)$ 必须只有正特征值。**
   ??? success "参考答案"
       动能 $T = \frac{1}{2}\dot{q}^T M(q) \dot{q}$ 是一个关于速度的二次型。由于 $T > 0$ 对所有 $\dot{q} \neq 0$ 成立，该二次型是正定的。根据实对称矩阵的性质，这意味着 $M(q)$ 的所有特征值均严格为正。

2. **[能量守恒] 证明：矩阵 $\dot{M}(q) - 2C(q, \dot{q})$ 是反对称的。这在控制设计中有何意义？**
   ??? success "参考答案"
       由能量守恒 $\dot{T} = \dot{q}^T \tau$。通过对 $T$ 求导并代入动力学方程，可得 $\dot{q}^T (\dot{M}-2C) \dot{q} = 0$。这种反对称性允许在基于 Lyapunov 的自适应控制律中抵消掉 $M$ 的导数项。

3. **[线性参数化] 证明动力学方程关于物理参数矢量 $\Phi$（如各杆质量、惯性张量）是线性的。**
   ??? success "参考答案"
       动力学项如 $m \ddot{x}$ 或 $I \dot{\omega}$ 均为各杆件质量或惯量系数的线性倍数。通过将方程重排为 $\tau = Y(q, \dot{q}, \ddot{q}) \Phi$（其中 $Y$ 为回归矩阵），我们将非线性状态空间问题转化为线性参数估计问题。

4. **[系统辨识] 描述利用最小二乘法辨识机器人物理参数的代数流程。**
   ??? success "参考答案"
       给定实验数据对 $(\tau_k, q_k, \dot{q}_k, \ddot{q}_k)$，构造超静定方程组 $\mathcal{T} = \mathcal{Y} \Phi$。利用伪逆可得最优估计值：$\hat{\Phi} = (\mathcal{Y}^T \mathcal{Y})^{-1} \mathcal{Y}^T \mathcal{T}$。

5. **[阻抗控制] 分析阻抗控制中目标矩阵 $M_d, B_d, K_d$ 选为正定的要求。**
   ??? success "参考答案"
       目标闭环系统表现为虚拟的质量-弹簧-阻尼系统。正定性确保了生成的线性系统是渐近稳定的且具有耗散性，从而防止在人机交互过程中产生能量增益。

6. **[条件数] 高条件数 $\kappa(M)$ 对机器人伺服性能有何影响？**
   ??? success "参考答案"
       较大的条件数意味着惯性在某些方向上远大于其他方向。这会放大控制回路中的数值噪声，并在对应于小特征值的方向上引起振荡。

7. **[模态分析] 机器人的固有频率如何与 $M^{-1}K$（其中 $K$ 为关节刚度阵）的特征值关联？**
   ??? success "参考答案"
       线性化后的齐次方程为 $M \ddot{x} + K x = 0$。设 $x(t) = v e^{j\omega t}$ 导致广义特征值问题 $(K - \omega^2 M)v = 0$。固有频率 $\omega_i$ 即为 $M^{-1}K$ 特征值的平方根。

8. **[投影动力学] 解释投影矩阵 $P = I - J^\dagger J$ 在受限运动中的用途。**
   ??? success "参考答案"
       矩阵 $P$ 将动力学投影到 Jacobian 的零空间。这允许将不引起运动的内力（用于控制抓取力）与引起任务空间运动的力分离开来。

9. **[虚功] 利用 Jacobian 推导从任务空间力 $f$ 到关节力矩 $\tau$ 的映射。**
   ??? success "参考答案"
       由虚功原理：$f^T \delta x = \tau^T \delta \theta$。代入 $\delta x = J \delta \theta$ 得 $f^T J \delta \theta = \tau^T \delta \theta$。由于 $\delta \theta$ 是任意的，得 $\tau = J^T f$。

10. **[逆动力学] 为什么对于大型 $n$，Newton-Euler 递归算法比直接展开 Lagrange 方程更高效？**
    ??? success "参考答案"
        直接展开 Lagrange 方法在进行符号运算时常产生 $O(n^4)$ 的复杂度。递归 Newton-Euler 算法利用了运动链的局部连通性，通过顺序传播速度和力，实现了 $O(n)$ 的线性复杂度。

## 本章小结

本章探讨了描述多自由度机械系统能量演变与受力特性的动力学框架：

1. **矩阵方程体系**：建立了由惯性、科氏力和重力项组成的标准矩阵表达式。
2. **正定性准则**：揭示了惯性矩阵通过二次型表现出的物理约束，为稳定性分析提供了基础。
3. **辨识逻辑**：论证了动力学方程的线性参数化特性，确立了参数估计的线性代数路径。
4. **交互控制**：利用虚功原理和投影算子形式化了阻抗控制与受限运动规律。
