# 第 68B 章 机器人动力学

<div class="context-flow" markdown>

**前置**：机器人运动学 (Ch68A) · 正定矩阵 (Ch16) · 矩阵微积分 (Ch47A) · 矩阵方程 (Ch20)

**本章脉络**：机器人动力学方程的矩阵形式 $\to$ 质量矩阵 $M(q)$ 的性质（正定对称性） $\to$ Coriolis 力与离心力矩阵 $C(q, \dot{q})$ $\to$ 重力矢量 $G(q)$ $\to$ 核心恒等式：$\dot{M}-2C$ 的反对称性与能量守恒 $\to$ 运算空间动力学 (Operational Space Dynamics) $\to$ 递推 Newton-Euler 算法 (RNEA) $\to$ 应用：模型预测控制 (MPC)、力/位混合控制、动力学参数辨识

**延伸**：机器人动力学是“带质量的线性代数”；它将静态的几何变换扩展为带有惯性、阻尼和势能的二阶矩阵微分方程，是实现机器人高性能运动控制（如波士顿动力机器人的跳跃）的理论基础

</div>

运动学告诉我们机器人“在哪里”，而**动力学**（Robot Dynamics）则告诉我们“需要多大的力”才能到达那里。动力学方程将机器人的加速度与电机的输出力矩联系起来。在高维状态空间中，这一方程表现为一个高度非线性的矩阵系统。本章将利用线性代数的结构性质（如正定性、反对称性）来简化这一复杂的物理描述。

---

## 68B.1 动力学方程的矩阵形式

!!! definition "定义 68B.1 (标准动力学模型)"
    一个拥有 $n$ 个关节的机器人的动力学方程可以写为：
    $$M(q)\ddot{q} + C(q, \dot{q})\dot{q} + G(q) = \tau$$
    - $q, \dot{q}, \ddot{q}$：关节位置、速度和加速度。
    - $M(q)$：$n \times n$ **惯性矩阵**（或质量矩阵）。
    - $C(q, \dot{q})$：$n \times n$ **Coriolis 与离心力矩阵**。
    - $G(q)$：$n \times 1$ **重力矢量**。
    - $\tau$：关节力矩向量。

---

## 68B.2 惯性矩阵的代数性质

!!! theorem "定理 68B.1 (质量矩阵的正定性)"
    惯性矩阵 $M(q)$ 始终是**对称正定**的（$M \succ 0$）。
    **物理意义**：系统的动能 $K = \frac{1}{2} \dot{q}^T M(q) \dot{q}$ 永远为正，且矩阵可逆，保证了加速度的唯一性：$\ddot{q} = M^{-1}(\tau - C\dot{q} - G)$。

---

## 68B.3 能量守恒与反对称性

!!! theorem "定理 68B.2 (反对称性恒等式)"
    矩阵 $N = \dot{M}(q) - 2C(q, \dot{q})$ 是**反对称矩阵**，即对任何向量 $x$ 均有 $x^T N x = 0$。
    **意义**：这一性质反映了系统内部功的相互抵消，是证明控制器稳定性的核心技巧（尤其是基于 Lyapunov 的自适应控制）。

---

## 68B.4 参数辨识的线性结构

!!! technique "动力学参数化"
    动力学方程关于物理参数（质量、质心位置、惯性张量）是**线性的**：
    $$\tau = Y(q, \dot{q}, \ddot{q}) \boldsymbol{\phi}$$
    其中 $Y$ 是**回归矩阵**，$\boldsymbol{\phi}$ 是待辨识的参数向量。这允许我们利用**最小二乘法**（Ch07）来精确重构机器人的动力学模型。

---

## 练习题

1. **[基础] 质量为 $m$、杆长为 $l$ 的单摆，其 $M(q)$ 是什么？（$q$ 为角度）。**
   ??? success "参考答案"
       动能 $K = \frac{1}{2} m (l\dot{q})^2 = \frac{1}{2} (ml^2) \dot{q}^2$。故 $M(q) = ml^2$（标量形式的惯性矩阵）。

2. **[正定性] 为什么 $M(q)$ 必须是正定的？**
   ??? success "参考答案"
       因为动能是二阶正定型。如果 $M$ 有非正特征值，则意味着在某些运动方向上动能为零或负，这违背了质量分布的物理常识。

3. **[反对称] 计算 $N = \dot{M}-2C$ 对自适应控制有什么用？**
   ??? success "参考答案"
       在 Lyapunov 稳定性证明中，项 $\frac{1}{2} \frac{d}{dt}(\dot{q}^T M \dot{q})$ 会产生 $\frac{1}{2} \dot{q}^T \dot{M} \dot{q}$。通过反对称性，该项与 $C$ 阵相关的项结合后部分抵消，简化了收敛性判定。

4. **[计算] 若 $M(q) = \begin{pmatrix} a+b\cos q_2 & c \\ c & d \end{pmatrix}$，求 $\dot{M}$。**
   ??? success "参考答案"
       $\dot{M} = \begin{pmatrix} -b\sin(q_2)\dot{q}_2 & 0 \\ 0 & 0 \end{pmatrix}$。注意偏导数链式法则。

5. **[运算空间] 什么是运算空间惯性矩阵 $\Lambda(x)$？**
   ??? success "参考答案"
       $\Lambda(x) = (J M^{-1} J^T)^{-1}$。它描述了末端执行器在笛卡尔空间表现出的等效质量。

6. **[应用] 简述“计算力矩控制”的代数本质。**
   ??? success "参考答案"
       本质上是利用动力学方程的逆运算，通过代数抵消消除非线性项 $C\dot{q}$ 和 $G$，使系统表现为线性的双积分器：$\ddot{q} = u$。

7. **[重力] 证明 $G(q) = \nabla_q P(q)$，其中 $P$ 为势能。**
   ??? success "参考答案"
       由 Euler-Lagrange 方程保守力部分的定义直接得出。

8. **[传递] 若关节加速度增加一倍，力矩 $\tau$ 会增加一倍吗？**
   ??? success "参考答案"
       不会。因为还有非线性的平方项 $\dot{q}$（Coriolis 力）和常数项 $G$。只有在准静态或忽略速度项时才近似线性。

9. **[复杂性] $n$ 自由度机器人的 $C$ 矩阵有多少个 Christoffel 符号？**
   ??? success "参考答案"
       $n^3$ 个。每个 $C_{ij} = \sum c_{ijk} \dot{q}_k$。

10. **[辨识] 为什么动力学辨识中 $Y$ 矩阵必须是列满秩的？**
    ??? success "参考答案"
        只有列满秩才能保证最小二乘解 $\hat{\boldsymbol{\phi}} = (Y^T Y)^{-1} Y^T \tau$ 是唯一的，从而唯一确定机器人的物理参数。

## 本章小结

机器人动力学展示了线性代数处理非线性物理规律的深度：

1.  **物理的代数化**：通过 $M, C, G$ 三大算子，动力学将牛顿力学的复杂推导浓缩为标准的矩阵方程，确立了多体系统仿真的通用格式。
2.  **对称性的保护**：质量矩阵的正定性与 $\dot{M}-2C$ 的反对称性不仅是数学技巧，更是能量守恒定律在代数层面的投影，为鲁棒控制设计提供了理论护城河。
3.  **预测的确定性**：参数线性化性质证明了即使是极度复杂的运动，其背后的物理常数仍然可以通过线性回归被剥离出来，体现了线性代数作为科学实验分析工具的强大威力。
