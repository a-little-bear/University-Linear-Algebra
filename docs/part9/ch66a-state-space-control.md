# 第 66A 章 状态空间与系统结构

<div class="context-flow" markdown>

**前置**：特征值(Ch6) · 矩阵指数(Ch13) · 矩阵方程(Ch20) · 矩阵稳定性(Ch36) · 奇异值分解(Ch7)

**本章脉络**：状态空间模型 → 矩阵指数解 → 能控性(Kalman 秩条件 / PBH 判据) → 能观性 → 对偶性 → Gramian → Kalman 分解 → 最小实现 → Ho-Kalman 算法 → 平衡实现与模型降阶

**延伸**：能控性/能观性 Gramian 在 Ch66B 的 LQR/LQG 设计中不可或缺；Kalman 分解揭示传递函数的本质维度

</div>

状态空间方法是线性动力系统分析的核心。一个线性时不变系统由四元组 $(A, B, C, D)$ 唯一确定，其演化逻辑由算子 $A$ 在相空间中生成的单参数半群 $e^{At}$ 刻画。

---

## 66A.1 核心结构与判定理论

!!! definition "定义 66A.4 (能控性)"
    系统 $(A, B)$ 称为能控的，若对任意终态 $x_f$，存在控制映射 $u(t)$ 使得状态轨迹在有限时间内收敛至 $x_f$。代数充要条件为能控性矩阵 $\mathcal{C} = [B, AB, \dots, A^{n-1}B]$ 满足 $\operatorname{rank}(\mathcal{C}) = n$。

!!! theorem "定理 66A.6 (能观性对偶原理)"
    系统 $(A, C)$ 的能观性等价于其伴随系统 $(A^T, C^T)$ 的能控性。这一对称性由线性算子及其共轭算子在 Hilbert 空间中的映射性质决定。

---

## 练习题

1. **[线性化] 分析线性状态空间方程 $\dot{x} = Ax + Bu$ 的通解结构，并证明其由零输入响应与零状态响应（卷积项）组成。**
   ??? success "参考答案"
       利用积分因子 $e^{-At}$，方程可化为 $\frac{d}{dt}(e^{-At}x) = e^{-At}Bu$。积分得 $x(t) = e^{At}x(0) + \int_0^t e^{A(t-\tau)}Bu(\tau)d\tau$。此式展示了齐次解（自由演化）与非齐次项（强迫演化）的线性叠加。

2. **[能控性] 证明：若矩阵 $A$ 的特征值 $\lambda_i$ 互不相同，则系统 $(A, B)$ 能控当且仅当 $B$ 在 $A$ 的每个特征空间上的投影非零。**
   ??? success "参考答案"
       这是 PBH 判据的直接推论。若 $B$ 在对应 $\lambda_i$ 的左特征向量 $v_i^T$ 方向上投影为零（$v_i^T B = 0$），则 $\operatorname{rank}[\lambda_i I - A, B] < n$，导致该模态不可控。

3. **[能观性] 推导线性系统初始状态 $x(0)$ 的最小二乘估计算法，并说明能观性矩阵 $\mathcal{O}$ 满秩是解唯一的充要条件。**
   ??? success "参考答案"
       观测方程序列 $y^{(k)}(0) = CA^k x(0)$ 构成超静定方程 $Y = \mathcal{O}x(0)$。解为 $x(0) = (\mathcal{O}^T \mathcal{O})^{-1} \mathcal{O}^T Y$。逆矩阵存在的充要条件是 $\mathcal{O}$ 列满秩。

4. **[Lyapunov] 证明：对于稳定系统，$A W_c + W_c A^T + BB^T = 0$ 的解 $W_c$ 刻画了冲激响应在状态空间中生成的椭球体。**
   ??? success "参考答案"
       能控性 Gramian $W_c = \int_0^\infty e^{At}BB^T e^{A^T t}dt$。利用 $x = \int e^{A(t-\tau)}Bu d\tau$ 和 Cauchy-Schwarz 不等式可证，移动到状态 $x$ 所需的最小能量为 $x^T W_c^{-1} x$。

5. **[不变量] 证明系统的传递函数 $G(s) = C(sI-A)^{-1}B + D$ 在状态空间相似变换 $x \mapsto Tx$ 下保持不变。**
   ??? success "参考答案"
       变换后 $\bar{A}=T^{-1}AT, \bar{B}=T^{-1}B, \bar{C}=CT$。代入得 $\bar{C}(sI-\bar{A})^{-1}\bar{B} = CT(sI-T^{-1}AT)^{-1}T^{-1}B = CT(T^{-1}(sI-A)T)^{-1}T^{-1}B = C(sI-A)^{-1}B$。

6. **[Kalman分解] 描述系统的 Kalman 典则分解结构，并说明为什么只有能控且能观的子系统影响外部传递函数。**
   ??? success "参考答案"
       分解将空间划分为四个子空间。非能控或不能观模态在 $(sI-A)^{-1}$ 的代数运算中通过分子分母公因子约简（极零对消）而消失。

7. **[McMillan度] 定义传递函数的 McMillan 度，并解释其与最小实现阶数的关系。**
   ??? success "参考答案"
       McMillan 度是传递函数矩阵 Smith-McMillan 形式的分母多项式总次数。它定义了实现该输入输出映射所需的最小状态维数 $n$。

8. **[Hankel奇异值] 证明能控性与能观性 Gramian 乘积的特征值（Hankel 奇异值的平方）是系统的坐标不变量。**
   ??? success "参考答案"
       变换后 $\bar{W}_c = T^{-1}W_c T^{-T}$ 且 $\bar{W}_o = T^T W_o T$。则 $\bar{W}_c \bar{W}_o = T^{-1} W_c W_o T$，即新旧乘积阵相似，特征值相同。

9. **[平衡截断] 详述平衡截断（Balanced Truncation）的降阶准则及其在 $H_\infty$ 范数下的误差上界。**
   ??? success "参考答案"
       在平衡实现中保留对应大奇异值的状态。误差上界为 $\Delta \le 2\sum \sigma_{dropped}$。这为大规模动力系统的模型简化提供了先验精度保证。

10. **[稳定性判定] 利用代数判据证明：若 $(A, B)$ 能控，则通过状态反馈 $u = -Kx$ 可以将闭环系统的极点配置在复平面的任何位置。**
    ??? success "参考答案"
        这是极点配置定理（Pole Placement Theorem）。能控性确保了输入 $u$ 能够独立影响系统矩阵的所有不变量，从而允许通过 $K$ 任意修改特征多项式的系数。

## 本章小结

本章确立了线性动力系统在状态空间框架下的代数结构：

1. **映射本质**：通过四元组建立了输入、状态与输出之间的线性映射体系。
2. **结构判据**：确立了以矩阵秩为核心的能控性与能观性判定，揭示了系统内部结构的边界。
3. **能量度量**：引入 Gramian 算子量化了系统在控制与测量维度的效率分布。
4. **降阶逻辑**：通过平衡实现与 Hankel 奇异值分析，确立了复杂线性模型的最优低维近似路径。
