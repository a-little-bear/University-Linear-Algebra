# 第 66A 章 状态空间与系统实现

<div class="context-flow" markdown>

**前置**：线性方程组 (Ch01) · 特征值 (Ch06) · 矩阵函数 (Ch13) · 矩阵束 (Ch41A)

**本章脉络**：从外部描述到内部表示 $\to$ 状态空间方程 (State-Space Equations) 的定义 $\to$ 系统矩阵、输入阵、输出阵与直接传递阵 $\to$ 系统解的结构：自由响应与强迫响应 $\to$ 核心判据：可控性 (Controllability) 与可观测性 (Observability) $\to$ Kalman 分解定理 $\to$ 传递函数矩阵与系统的代数等价性 $\to$ 系统实现：从传递函数到状态空间的映射 $\to$ 最小实现 (Minimal Realization) $\to$ 应用：多变量反馈控制、航空航天制导、电路系统的状态建模

**延伸**：状态空间法是现代控制理论的灵魂；它将系统的物理状态封装为向量，将因果律映射为矩阵算子，证明了复杂系统的演化不仅取决于输入，更取决于内部能量状态的几何演化，是连接线性代数与工程自动化的大动脉

</div>

在经典控制中，我们习惯于用传递函数描述输入与输出的关系。但这种“黑箱”视角无法揭示系统内部的变化。**状态空间表示**（State-Space Representation）通过引入“状态向量” $\mathbf{x}(t)$，将复杂的动力学过程转化为一组线性矩阵方程。它允许我们精确分析哪些内部状态是可以被外界操纵的（可控性），以及哪些是可以被探测到的（可观测性）。本章将介绍这一作为自动控制与系统科学核心的代数框架。

---

## 66A.1 状态空间方程

!!! definition "定义 66A.1 (线性时不变系统状态空间)"
    $$\begin{cases} \dot{\mathbf{x}}(t) = A\mathbf{x}(t) + B\mathbf{u}(t) \\ \mathbf{y}(t) = C\mathbf{x}(t) + D\mathbf{u}(t) \end{cases}$$
    - $A$：**系统矩阵**（描述固有动力学）。
    - $B$：**输入矩阵**（描述控制作用）。
    - $C$：**输出矩阵**（描述观测方式）。
    - $D$：**直馈矩阵**。

---

## 66A.2 可控性与可观测性

!!! theorem "定理 66A.1 (Kalman 判据)"
    1.  **可控性**：系统是完全可控的，当且仅当**可控性矩阵** $\mathcal{C} = [B, AB, A^2B, \ldots, A^{n-1}B]$ 满行秩。
    2.  **可观测性**：系统是完全可观测的，当且仅当**可观测性矩阵** $\mathcal{O} = [C^T, (CA)^T, \ldots, (CA^{n-1})^T]^T$ 满列秩。

---

## 66A.3 系统实现与传递函数

!!! technique "技术：传递函数矩阵"
    系统的输入输出特性可以用拉普拉斯变换下的传递函数矩阵 $G(s)$ 表示：
    $$G(s) = C(sI - A)^{-1}B + D$$
    **最小实现**：一个实现 $(A, B, C, D)$ 是最小的（维数最低），当且仅当它是完全可控且完全可观测的。

---

## 练习题

**1. [基础] 给定系统 $A = \begin{pmatrix} 0 & 1 \\ -2 & -3 \end{pmatrix}, B = \begin{pmatrix} 0 \\ 1 \end{pmatrix}$。计算其可控性矩阵 $\mathcal{C}$。**

??? success "参考答案"
    **计算步骤：**
    1. 计算 $AB = \begin{pmatrix} 0 & 1 \\ -2 & -3 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \begin{pmatrix} 1 \\ -3 \end{pmatrix}$。
    2. 构造矩阵 $\mathcal{C} = [B, AB] = \begin{pmatrix} 0 & 1 \\ 1 & -3 \end{pmatrix}$。
    **结论**：$\det(\mathcal{C}) = -1 \neq 0$，故矩阵满秩。系统是**完全可控**的。

**2. [可观测性] 若 $C = \begin{pmatrix} 1 & 0 \end{pmatrix}$，判定上述系统是否可观测。**

??? success "参考答案"
    **计算步骤：**
    1. 计算 $CA = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 0 & 1 \\ -2 & -3 \end{pmatrix} = \begin{pmatrix} 0 & 1 \end{pmatrix}$。
    2. 构造矩阵 $\mathcal{O} = \begin{pmatrix} C \\ CA \end{pmatrix} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}$。
    **结论**：$\mathcal{O} = I$，满秩。系统是**完全可观测**的。

**3. [解的结构] 系统在零输入 $\mathbf{u}(t)=0$ 下的解是什么？**

??? success "参考答案"
    **结论：$\mathbf{x}(t) = e^{At}\mathbf{x}_0$。**
    这被称为**零输入响应**或自由响应。它完全由系统矩阵 $A$ 的特征值决定。

**4. [传递函数] 证明：若 $D=0, B=b, C=c^T$（单入单出），传递函数是一个标量分式。**

??? success "参考答案"
    **证明：**
    $G(s) = c^T(sI - A)^{-1}b$。
    由于 $(sI-A)^{-1}$ 是一个矩阵，$c^T$ 左乘、$b$ 右乘后的结果是一个 $1 \times 1$ 的标量。
    根据伴随矩阵公式，它等于 $\frac{c^T \operatorname{adj}(sI-A) b}{\det(sI-A)}$，其分母正好是系统的特征多项式。

**5. [PBH判据] 什么是可控性的 PBH 判据？**

??? success "参考答案"
    **描述：**
    系统 $(A, B)$ 是完全可控的，当且仅当对于 $A$ 的所有特征值 $\lambda$，矩阵束 $[ \lambda I - A \ | \ B ]$ 始终保持满行秩。
    **意义**：这说明控制作用 $B$ 必须能够影响到每一个特征模态的方向。

**6. [计算] 若系统 $A = \operatorname{diag}(1, -1)$，输入 $B = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$。该系统可控吗？**

??? success "参考答案"
    **判定：**
    1. 计算 $\mathcal{C} = [B, AB] = \begin{pmatrix} 1 & 1 \\ 0 & 0 \end{pmatrix}$。
    2. 秩为 1，小于系统维度 2。
    **结论**：不可控。
    **直观理解**：由于特征值 -1 对应的状态分量在 $B$ 中权重为 0，且 $A$ 是对角的（不耦合），外部输入永远无法影响第二个状态。

**7. [实现] 判定：同一个传递函数 $G(s)$ 是否对应唯一的状态空间实现？**

??? success "参考答案"
    **结论：不唯一。**
    **理由**：如果我们对状态进行坐标变换 $\mathbf{z} = P\mathbf{x}$，得到的新系统 $(P A P^{-1}, PB, CP^{-1}, D)$ 具有完全相同的传递函数。这意味着物理实现具有基变换的自由度。

**8. [最小实现] 判定：若一个系统是最小实现，其维数 $n$ 满足什么条件？**

??? success "参考答案"
    **结论：$n$ 等于传递函数分母多项式的阶数。**
    最小实现意味着没有冗余的、不可控或不可观测的状态。

**9. [对偶性] 简述可控性与可观测性的对偶关系。**

??? success "参考答案"
    **定理：**
    系统 $(A, B)$ 是可控的，当且仅当其对偶系统 $(A^T, C^T)$ 是可观测的。
    这一对称性允许我们将控制器的设计问题转化为观测器（状态估计）的设计问题。

**10. [应用] 为什么在航空航天制导中必须使用状态空间法而非传递函数？**

??? success "参考答案"
    **理由：**
    1. **多变量耦合**：飞行器有 6 个自由度，输入输出高度耦合，传递函数矩阵过于复杂。
    2. **时变性**：飞行过程中质量（燃料消耗）和气动参数不断变化，状态空间法能轻易处理 $A(t)$。
    3. **现代优化**：状态空间法允许直接应用线性二次调节器 (LQR) 等基于特征值的最优控制算法，实现精准制导。

## 本章小结

状态空间与系统实现是线性代数向现代工程的“暴力输出”：

1.  **内部的透明化**：它将复杂的动态演化拆解为状态向量在多维空间中的轨迹，证明了系统的可解性本质上是线性算子在时间维度上的积分。
2.  **能力的界限**：可控性与可观测性判据确立了人类干预自然系统的代数极限，划定了“可知”与“可控”的数学疆域。
3.  **实现的灵活性**：通过揭示传递函数与状态空间的多对一映射，该理论为工程设计提供了巨大的坐标自由度，支撑了从经典反馈到现代智能控制的跨越。
