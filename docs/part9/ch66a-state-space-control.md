# 第 66A 章 状态空间控制理论

<div class="context-flow" markdown>

**前置**：线性方程组 (Ch01) · 特征值 (Ch06) · 矩阵分析 (Ch14) · 矩阵方程 (Ch20)

**本章脉络**：控制理论的动力学背景 $\to$ 状态空间表示 $(A, B, C, D)$ $\to$ 能控性 (Controllability) 定义与能控性矩阵 $\to$ 能观测性 (Observability) 定义与能观测性矩阵 $\to$ 极点配置与状态反馈 $\to$ 观测器设计（Luenberger 观测器） $\to$ 状态空间的传递函数转换 $\to$ 实现理论 (Realization) $\to$ 采样控制系统初步

**延伸**：状态空间法是现代控制理论的基石；它将系统的外部输入输出描述转化为内部状态演化，使得利用矩阵论（如秩、子空间分解）解决复杂的工业自动化与航天制导问题成为可能

</div>

在经典控制理论中，我们使用拉普拉斯变换处理 SISO 系统。而**状态空间法**（State-Space Method）则利用线性代数处理多变量（MIMO）系统。它将系统的所有历史信息压缩为一个“状态向量”，并将系统的演化描述为状态空间中的一阶矩阵微分方程。本章将展示能控性与能观测性这两个深刻的代数性质如何决定了系统的可控极限。

---

## 66A.1 状态空间表示

!!! definition "定义 66A.1 (线性时不变系统 LTI)"
    一个 LTI 系统的状态空间模型定义为：
    $$\begin{cases} \dot{\mathbf{x}}(t) = A\mathbf{x}(t) + B\mathbf{u}(t) \\ \mathbf{y}(t) = C\mathbf{x}(t) + D\mathbf{u}(t) \end{cases}$$
    - $\mathbf{x} \in \mathbb{R}^n$：状态向量。
    - $\mathbf{u} \in \mathbb{R}^m$：输入向量。
    - $\mathbf{y} \in \mathbb{R}^p$：输出向量。

---

## 66A.2 能控性与能观测性

!!! definition "定义 66A.2 (能控性矩阵)"
    系统 $(A, B)$ 是**能控的**，如果可以通过有限时间的输入将系统从任意初始状态引导至任意目标状态。
    **判据**：能控性矩阵 $\mathcal{C} = [B \ AB \ A^2B \ \cdots \ A^{n-1}B]$ 必须是**满秩**的。

!!! definition "定义 66A.3 (能观测性矩阵)"
    系统 $(A, C)$ 是**能观测的**，如果可以通过观测一段时刻的输入和输出推断出系统的初始状态。
    **判据**：能观测性矩阵 $\mathcal{O} = [C^T \ (CA)^T \ \cdots \ (CA^{n-1})^T]^T$ 必须是**满秩**的。

---

## 66A.3 极点配置与反馈

!!! technique "状态反馈"
    通过 $u = -Kx$，闭环系统的动态变为 $\dot{x} = (A-BK)x$。
    若系统能控，则可以通过选择矩阵 $K$ 将闭环极点（$A-BK$ 的特征值）配置在复平面的任何指定位置。这为系统增稳提供了代数保证。

---

## 练习题

1. **[基础] 写出系统 $y'' + 3y' + 2y = u$ 的状态空间表示。**
   ??? success "参考答案"
       令 $x_1 = y, x_2 = y'$。则 $\dot{x}_1 = x_2, \dot{x}_2 = -2x_1 - 3x_2 + u$。
       $A = \begin{pmatrix} 0 & 1 \\ -2 & -3 \end{pmatrix}, B = \begin{pmatrix} 0 \\ 1 \end{pmatrix}, C = \begin{pmatrix} 1 & 0 \end{pmatrix}$。

2. **[能控性] 判定 $A = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}, B = \begin{pmatrix} 1 \\ 1 \end{pmatrix}$ 是否能控。**
   ??? success "参考答案"
       $\mathcal{C} = [B \ AB] = \begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}$。秩为 1 < 2，故不可控。

3. **[能观测性] 若 $C = \begin{pmatrix} 1 & 0 \end{pmatrix}$ 且 $A$ 是上三角阵，系统一定能观测吗？**
   ??? success "参考答案"
       不一定。需检查 $\mathcal{O}$ 矩阵的秩。若 $A$ 的右上角元素为 0 且对角元相同，则可能不可观测。

4. **[传递函数] LTI 系统的传递函数 $G(s)$ 用矩阵如何表示？**
   ??? success "参考答案"
       $G(s) = C(sI - A)^{-1}B + D$。

5. **[稳定性] 闭环系统 $(A-BK)$ 稳定的充要条件是什么？**
   ??? success "参考答案"
       $A-BK$ 是 Hurwitz 稳定的（特征值实部全为负）。

6. **[观测器] Luenberger 观测器的误差方程是什么？**
   ??? success "参考答案"
       $\dot{e} = (A-LC)e$。我们需要设计 $L$ 使得 $A-LC$ 稳定，从而使估算状态收敛到真实状态。

7. **[Cayley-Hamilton] 为什么能控性矩阵只取到 $A^{n-1}B$？**
   ??? success "参考答案"
       由 Cayley-Hamilton 定理，$A^n$ 及更高次幂都是低次幂的线性组合，不会增加矩阵的秩。

8. **[计算] 求系统 $\dot{x} = x+u$ 在 $u=-2x$ 反馈下的极点。**
   ??? success "参考答案"
       $\dot{x} = (1-2)x = -x$。极点在 -1（系统由不稳定变为稳定）。

9. **[实现] 什么是最小实现？**
   ??? success "参考答案"
       维数最小的状态空间实现。一个实现是最小的，当且仅当它既是能控的又是能观测的。

10. **[应用] 为什么在航空航天中必须使用状态空间法？**
    ??? success "参考答案"
        因为飞行器具有多个高度耦合的控制面（多输入多输出），且涉及大量内部传感器数据（状态），状态空间法能提供统一的最优控制与滤波框架。

## 本章小结

状态空间控制理论是线性代数的动态化巅峰：

1.  **内部状态的发现**：它将观测不到的“黑箱”内部逻辑显式化，证明了系统的全部未来演化都存储在当前向量与算子的相互作用中。
2.  **秩的物理意义**：能控性与能观测性将枯燥的矩阵秩定义转化为“干预能力”与“洞察深度”的物理度量，划定了人类控制物理世界的代数边界。
3.  **极点的设计力**：通过特征值配置，控制理论展示了如何利用代数反馈重塑算子的谱，使原本混沌或不稳的系统表现出所需的平稳性与响应速度。
