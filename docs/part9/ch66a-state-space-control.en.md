# Chapter 66A: State-Space and System Structure

<div class="context-flow" markdown>

**Prerequisites**: Eigenvalues (Ch6) · Matrix Exponential (Ch13) · Matrix Equations (Ch20) · Matrix Stability (Ch36) · SVD (Ch7)

**Chapter Outline**: State-Space Model → Matrix Exponential Solution → Controllability (Kalman Rank Condition / PBH Criterion) → Observability → Duality → Gramians → Kalman Decomposition → Minimal Realization → Ho-Kalman Algorithm → Balanced Realization and Model Order Reduction

**Extension**: Controllability/Observability Gramians are indispensable for LQR/LQG design in Ch66B; Kalman decomposition reveals the essential dimension of transfer functions.

</div>

State-space methods constitute the core of linear dynamical system analysis. A linear time-invariant (LTI) system is uniquely determined by the quadruple $(A, B, C, D)$, and its evolution is characterized by the one-parameter semigroup $e^{At}$ generated by the operator $A$ in the phase space.

---

## 66A.1 Core Structures and Criteria

!!! definition "Definition 66A.4 (Controllability)"
    A system $(A, B)$ is said to be **controllable** if, for any final state $x_f$, there exists a control mapping $u(t)$ such that the state trajectory converges to $x_f$ in finite time. The algebraic necessary and sufficient condition is that the controllability matrix $\mathcal{C} = [B, AB, \dots, A^{n-1}B]$ satisfies $\operatorname{rank}(\mathcal{C}) = n$.

!!! theorem "Theorem 66A.6 (Duality Principle)"
    The observability of the system $(A, C)$ is equivalent to the controllability of its adjoint system $(A^T, C^T)$. This symmetry is determined by the mapping properties of linear operators and their adjoints in Hilbert spaces.

---

## Exercises

1. **[Linearization] Analyze the structure of the general solution to the linear state-space equation $\dot{x} = Ax + Bu$, and prove that it consists of the zero-input response and the zero-state response (convolution term).**
   ??? success "Solution"
       Using the integrating factor $e^{-At}$, the equation can be transformed into $\frac{d}{dt}(e^{-At}x) = e^{-At}Bu$. Integration yields $x(t) = e^{At}x(0) + \int_0^t e^{A(t-	au)}Bu(	au)d	au$. This formula demonstrates the linear superposition of the homogeneous solution (free evolution) and the non-homogeneous term (forced evolution).

2. **[Controllability] Prove: If the eigenvalues $\lambda_i$ of matrix $A$ are distinct, then the system $(A, B)$ is controllable if and only if the projection of $B$ onto each eigenspace of $A$ is non-zero.**
   ??? success "Solution"
       This is a direct corollary of the PBH criterion. If the projection of $B$ onto the left eigenvector $v_i^T$ corresponding to $\lambda_i$ is zero ($v_i^T B = 0$), then $\operatorname{rank}[\lambda_i I - A, B] < n$, rendering that mode uncontrollable.

3. **[Observability] Derive the least-squares estimation algorithm for the initial state $x(0)$ of a linear system, and explain why the observability matrix $\mathcal{O}$ being full rank is the necessary and sufficient condition for a unique solution.**
   ??? success "Solution"
       The sequence of observation equations $y^{(k)}(0) = CA^k x(0)$ forms an overdetermined system $Y = \mathcal{O}x(0)$. The solution is $x(0) = (\mathcal{O}^T \mathcal{O})^{-1} \mathcal{O}^T Y$. The existence of the inverse requires $\mathcal{O}$ to be of full column rank.

4. **[Lyapunov] Prove: For a stable system, the solution $W_c$ to $A W_c + W_c A^T + BB^T = 0$ characterizes the ellipsoid generated by the impulse response in the state space.**
   ??? success "Solution"
       The controllability Gramian is $W_c = \int_0^\infty e^{At}BB^T e^{A^T t}dt$. Using $x = \int e^{A(t-	au)}Bu d	au$ and the Cauchy-Schwarz inequality, it can be proven that the minimum energy required to move to state $x$ is $x^T W_c^{-1} x$.

5. **[Invariance] Prove that the transfer function $G(s) = C(sI-A)^{-1}B + D$ remains invariant under the state-space similarity transformation $x \mapsto Tx$.**
   ??? success "Solution"
       After transformation, $\bar{A}=T^{-1}AT, \bar{B}=T^{-1}B, \bar{C}=CT$. Substituting gives $\bar{C}(sI-\bar{A})^{-1}\bar{B} = CT(sI-T^{-1}AT)^{-1}T^{-1}B = CT(T^{-1}(sI-A)T)^{-1}T^{-1}B = C(sI-A)^{-1}B$.

6. **[Kalman Decomposition] Describe the structure of the Kalman canonical decomposition and explain why only the controllable and observable subsystem affects the external transfer function.**
   ??? success "Solution"
       The decomposition partitions the space into four subspaces. Uncontrollable or unobservable modes vanish in the algebraic calculation of $(sI-A)^{-1}$ through common factor reduction in the numerator and denominator (pole-zero cancellation).

7. **[McMillan Degree] Define the McMillan degree of a transfer function and explain its relationship to the order of the minimal realization.**
   ??? success "Solution"
       The McMillan degree is the total degree of the denominator polynomials in the Smith-McMillan form of the transfer function matrix. It defines the minimum state dimension $n$ required to implement the given input-output mapping.

8. **[Hankel Singular Values] Prove that the eigenvalues of the product of the controllability and observability Gramians (the squares of the Hankel singular values) are coordinate invariants of the system.**
   ??? success "Solution"
       After transformation, $\bar{W}_c = T^{-1}W_c T^{-T}$ and $\bar{W}_o = T^T W_o T$. Thus $\bar{W}_c \bar{W}_o = T^{-1} W_c W_o T$, meaning the new and old product matrices are similar and share the same eigenvalues.

9. **[Balanced Truncation] Detail the criteria for balanced truncation model reduction and its error upper bound in the $H_\infty$ norm.**
   ??? success "Solution"
       In a balanced realization, states corresponding to large singular values are retained. The error upper bound is $\Delta \le 2\sum \sigma_{dropped}$. This provides an a priori accuracy guarantee for simplifying large-scale dynamical systems.

10. **[Stability Assignment] Using algebraic criteria, prove: If $(A, B)$ is controllable, then the poles of the closed-loop system can be assigned to any position in the complex plane via state feedback $u = -Kx$.**
    ??? success "Solution"
        This is the Pole Placement Theorem. Controllability ensures that the input $u$ can independently affect all invariants of the system matrix, thereby allowing arbitrary modification of the characteristic polynomial coefficients via $K$.

## Chapter Summary

This chapter establishes the algebraic foundation of linear dynamical systems in the state-space framework:

1. **Mapping Essence**: Established a linear mapping system among input, state, and output via the quadruple $(A, B, C, D)$.
2. **Structural Criteria**: Established controllability and observability criteria centered on matrix rank, revealing the boundaries of internal system structures.
3. **Energy Metrics**: Introduced Gramian operators to quantify the efficiency distribution of the system in control and measurement dimensions.
4. **Reduction Logic**: Demonstrated the optimal low-dimensional approximation path for complex linear models through balanced realization and Hankel singular value analysis.
