# 第 70B 章 分子生物学与基因组学中的线性代数

<div class="context-flow" markdown>

**前置**：奇异值分解(Ch11) · 矩阵分解(Ch10) · 图论基础(Ch27) · 统计学(Ch29)

**本章脉络**：序列比对的动态规划（矩阵迹） → 系统发育树与距离矩阵 → 替换矩阵 ($PAM, BLOSUM$) → 基因表达分析 (PCA/SVD) → 基因调控网络（邻接矩阵） → 蛋白质相互作用 (PPI) 网络 → 结构生物学中的距离几何

**延伸**：SVD 是生物信息学降维处理的核心；替换矩阵源于氨基酸演化的 Markov 模型

</div>

生命的微观密码本质上是高维数据。线性代数为从海量基因表达中提取模式，以及从序列距离中重建进化史提供了核心工具。

---

## 70B.1 序列演化与不变量形式

!!! definition "定义 70B.1 (替换矩阵)"
    替换矩阵 $S$（如 PAM 或 BLOSUM）描述了进化过程中一种氨基酸被另一种替换的概率或对数比。这些矩阵来源于 20 种氨基酸空间上的 Markov 链。

!!! theorem "定理 70B.3 (发育树距离一致性)"
    源自 DNA 序列的距离矩阵 $D$ 能够表示为一棵树结构，当且仅当其满足**四点条件**：对于任意四个分类单元 $i, j, k, l$，$\{D_{ij}+D_{kl}, D_{ik}+D_{jl}, D_{il}+D_{jk}\}$ 中最大的两个值相等。

---

## 练习题

1. **[替换熵] 在 PAM-1 矩阵中，迹 $\operatorname{tr}(P)$ 如何反映序列的保守性？**
   ??? success "参考答案"
       迹 $\operatorname{tr}(P) = \sum p_{ii}$ 是所有氨基酸保持不变的概率之和。迹越大，说明在给定的进化距离（1 PAM 单位）内，序列的保守性越高。

2. **[PCA与基因组] 解释为什么 PCA 被用于识别基因组研究中的种群分层。**
   ??? success "参考答案"
       基因型数据被表示为巨大的矩阵 $X$。前几个主成分通常捕捉地理或种族背景引起的变异。通过将个体投影到 PC 子空间，研究人员可以检测出对应于祖先血统的聚类。

3. **[SVD解释] 若 $A$ 是基因表达矩阵（基因 $\times$ 样本），其左右奇异向量的生物学含义是什么？**
   ??? success "参考答案"
       左奇异向量 $u_i$（特征基因）代表了基础的表达模式。右奇异向量 $v_i$（特征样本）代表了这些模式在不同生物条件或组织中的分布强度。

4. **[计算] 给定 Jukes-Cantor 距离矩阵 $D$，为什么其条目必须满足 $D_{ii} = 0$ 且 $D_{ij} = D_{ji}$？**
   ??? success "参考答案"
       $D$ 是序列空间上的度量。$D_{ii}=0$ 反映了恒等公理（自身距离为零），$D_{ij}=D_{ji}$ 反映了序列 $i$ 与 $j$ 之间进化路径的对称性。

5. **[调控网络] 将一个由 3 个基因组成的反馈环表示为邻接矩阵，并求其特征值。**
   ??? success "参考答案"
       $A = \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 1 & 0 & 0 \end{pmatrix}$。特征值为单位根 $\{1, \omega, \omega^2\}$。虚部反映了反馈系统的振荡特性。

6. **[距离几何] 如何利用 SVD 从核磁共振 (NMR) 提供的距离约束中重建蛋白质的三维结构？**
   ??? success "参考答案"
       将距离矩阵 $D$ 通过 $G_{ij} = \frac{1}{2}(D_{i0}^2 + D_{j0}^2 - D_{ij}^2)$ 转化为 Gram 矩阵 $G$。三维坐标由 $G$ 的前三个特征向量（经特征值平方根缩放）给出。

7. **[网络稳健性] 在蛋白质相互作用 (PPI) 网络中，Laplacian 矩阵的谱隙与网络连通性有何关系？**
   ??? success "参考答案"
       次小特征值 $\lambda_2$（代数连通度）衡量了网络被分割的难易程度。较小的 $\lambda_2$ 提示网络中存在弱连接的功能模块。

8. **[发育树判定] 验证距离矩阵 $D = \begin{pmatrix} 0 & 3 & 7 \\ 3 & 0 & 6 \\ 7 & 6 & 0 \end{pmatrix}$ 是否能由一棵带权树精确表示。**
   ??? success "参考答案"
       检查加性性质：$D_{12}+D_{23} = 3+6=9 \neq D_{13} = 7$。由于不满足超度规或加性树的等式约束，该矩阵可能无法由简单的树结构完美适配，需通过四点条件进行更全面的判定。

9. **[突变均衡] 对于氨基酸替换的 Markov 链转移矩阵 $Q$，其平稳分布 $\pi$ 代表什么？**
   ??? success "参考答案"
       $\pi$ 代表进化时间趋于无穷大时，所有蛋白质中 20 种氨基酸的均衡频率，假设选择压力保持恒定。

10. **[复杂度] 为什么在大规模基因调控网络分析中，矩阵分解通常优于直接的图算法？**
    ??? success "参考答案"
        生物网络通常含有大量噪声和部分观测。矩阵分解（如 NMF 或 SVD）能提取稳健的隐因子和模式，并自然地处理缺失数据，而直接的图遍历对单条边的错误非常敏感。

## 本章小结

本章探讨了分子生命的线性代数框架：

1. **进化演算**：确立了替换矩阵作为氨基酸序列演化的 Markov 转移算子。
2. **谱基因组学**：利用 PCA 和 SVD 实现了高通量基因表达数据的降维。
3. **生物网络**：通过邻接矩阵与 Laplacian 矩阵形式化了调控与相互作用系统的连通性与稳健性。
4. **距离几何**：建立了序列度量与发育树及三维结构重建之间的代数纽带。
