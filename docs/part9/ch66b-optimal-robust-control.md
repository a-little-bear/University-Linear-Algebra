# 第 66B 章 最优控制与鲁棒性

<div class="context-flow" markdown>

**前置**：状态空间(Ch66A) · 正定矩阵(Ch16) · 矩阵方程(Ch20) · 奇异值(Ch7)

**本章脉络**：线性二次调节器(LQR) → 代数 Riccati 方程(ARE) → 状态估计与 Kalman 滤波 → LQG 与分离原理 → $H_2$ 与 $H_\infty$ 范数 → 鲁棒稳定性(小增益定理) → 线性矩阵不等式(LMI)在控制中的应用

**延伸**：最优控制理论是航空航天、自动驾驶和精密制造的核心；$H_\infty$ 理论为处理动态不确定性提供了严谨的数学界限

</div>

最优控制与鲁棒控制研究在约束条件下算子的最优化问题。LQR 通过最小化变分泛函将动力学稳定性与代数 Riccati 方程关联；鲁棒控制则在 Operator Norm（算子范数）意义下寻求系统对抗扰动的硬性保障。

---

## 66B.1 线性二次调节器 (LQR)

!!! definition "定义 66B.1 (LQR 变分问题)"
    给定线性系统 $\dot{x} = Ax + Bu$，求解最优控制律 $u(t)$ 以最小化二次性能指标：
    $$J = \int_0^\infty (x^T Q x + u^T Ru) \, dt, \quad Q \succeq 0, R \succ 0$$
    该问题的解通过 Hamilton 系统分析，归结为求解非线性代数方程。

!!! theorem "定理 66B.1 (代数 Riccati 方程)"
    LQR 问题的最优增益为 $K = R^{-1} B^T P$，其中 $P$ 是以下 **Algebraic Riccati Equation (ARE)** 的唯一对称正定解：
    $$A^T P + PA - PBR^{-1}B^T P + Q = 0$$

---

## 66B.2 鲁棒性与小增益定理

!!! theorem "定理 66B.3 (小增益定理)"
    设系统 $G$ 与反馈扰动 $\Delta$ 构成回路。闭环系统保持鲁棒稳定的充要条件是回路的 $H_\infty$ 范数乘积小于 1：
    $$\|G(s)\|_\infty \cdot \|\Delta(s)\|_\infty < 1$$
    这反映了算子谱在复平面内位置的稳定性约束。

---

## 练习题

1. **[ARE性质] 分析代数 Riccati 方程中的项 $-PBR^{-1}B^TP$，并说明其在维持闭环稳定性中的物理/数学作用。**
   ??? success "参考答案"
       该项代表控制输入引入的能量耗散。在 Lyapunov 稳定性分析中，它提供了负定项，抵消了不稳定矩阵 $A$ 带来的能量增长，确保闭环特征值位于左半开复平面。

2. **[Hamilton算子] 证明 ARE 的解与 Hamilton 矩阵 $H = \begin{pmatrix} A & -BR^{-1}B^T \\ -Q & -A^T \end{pmatrix}$ 的特征值结构之间的关系。**
   ??? success "参考答案"
       Hamilton 矩阵的特征值关于虚轴对称。ARE 的正定解 $P$ 由 $H$ 的对应于左半复平面的稳定子空间决定。$P = X_2 X_1^{-1}$，其中 $[X_1; X_2]$ 是 $H$ 的稳定特征向量构成的矩阵。

3. **[分离原理] 证明 LQG 控制系统的传递函数矩阵及其极点分布满足分离原理。**
   ??? success "参考答案"
       闭环系统特征值是 $A-BK$（控制器极点）与 $A-LC$（观测器极点）的并集。这是因为状态估计误差 $\tilde{x} = x - \hat{x}$ 的动力学与状态演化在增广空间中呈分块三角结构。

4. **[计算] 设标量系统 $\dot{x} = x + u$，$Q=3, R=1$。求解 ARE 并确定最优反馈增益 $K$。**
   ??? success "参考答案"
       ARE: $1 \cdot P + P \cdot 1 - P \cdot 1 \cdot 1^{-1} \cdot 1 \cdot P + 3 = 0 \implies P^2 - 2P - 3 = 0$。正根为 $P = 3$。
       最优增益 $K = 1^{-1} \cdot 1 \cdot 3 = 3$。闭环动力学 $\dot{x} = (1-3)x = -2x$。

5. **[H-infinity] 定义系统传递矩阵的 $H_\infty$ 范数，并说明其与最大奇异值曲线 $\bar{\sigma}(G(j\omega))$ 的关系。**
   ??? success "参考答案"
       $\|G(s)\|_\infty = \sup_{\omega \in \mathbb{R}} \bar{\sigma}(G(j\omega))$。它代表了系统在所有输入频率下的最大能量增益（峰值增益），是鲁棒性能分析的核心指标。

6. **[Kalman滤波] 说明 Kalman 滤波增益 $L$ 的代数确定过程与 LQR 问题在对偶意义下的一致性。**
   ??? success "参考答案"
       Kalman 滤波是最小二乘估计的动态版本。其最优增益求解同样归结为 ARE，其中过程噪声协方差 $W$ 对应 $Q$，测量噪声协方差 $V$ 对应 $R$。

7. **[鲁棒稳定性] 证明：若 $\|G(s)\|_\infty < \gamma$，则对所有满足 $\|\Delta(s)\|_\infty \le 1/\gamma$ 的稳定摄动，闭环系统保持稳定。**
   ??? success "参考答案"
       这是小增益定理的直接推论。由 Nyquist 稳定性判据，回路增益在单位圆内的收缩保证了特征轨迹不会包围临界点 $-1$。

8. **[LMI] 解释线性矩阵不等式（LMI）在控制系统多指标优化中的计算优势。**
   ??? success "参考答案"
       LMI 将非凸的控制约束（如极点配置与 $H_\infty$ 指标并存）转化为 PSD 锥上的凸优化问题。这允许利用内点法在多项式时间内找到全局最优或近似最优解。

9. **[正定性] 证明：若 $Q \succ 0$ 且 $(A, B)$ 可稳定，则 ARE 的对称正定解 $P$ 存在且唯一。**
   ??? success "参考答案"
       由可稳定性和可观测性（由 $Q$ 保证）条件，Hamilton 矩阵无虚轴特征值，且存在唯一的稳定不变子空间，从而诱导唯一的正定对称阵 $P$。

10. **[控制代价] 分析 LQR 代价函数 $J$ 在无穷时域下的收敛性条件。**
    ??? success "参考答案"
        $J$ 收敛要求闭环系统渐近稳定。由 Lyapunov 理论，若存在 $P \succ 0$ 满足 ARE，则 $x(t)^T P x(t)$ 是系统的下降函数，从而保证了性能指标的有界性。

## 本章小结

本章论述了线性控制理论的优化与稳健性准则：

1. **变分寻优**：通过二次代价函数与代数 Riccati 方程确立了动态系统在性能与控制能量间的代数平衡。
2. **状态重构**：建立了 Kalman 滤波的代数框架，实现了在随机噪声干扰下的最优状态估计。
3. **频率域鲁棒性**：利用 $H_\infty$ 范数与小增益定理量化了系统对抗模型摄动的硬性边界。
4. **统一计算平台**：展示了线性矩阵不等式（LMI）作为求解复杂受限控制问题的通用代数工具。
