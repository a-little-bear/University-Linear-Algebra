# 第 66B 章 最优控制与鲁棒控制

<div class="context-flow" markdown>

**前置**：状态空间与系统实现 (Ch66A) · 矩阵方程 (Ch20) · 矩阵不等式 (Ch18) · 凸优化 (Ch25)

**本章脉络**：从反馈控制到性能最优 $\to$ 线性二次调节器 (LQR) 的数学模型 $\to$ 核心算子：代数 Riccati 方程 (ARE) $\to$ 最优反馈增益 $K = R^{-1} B^T P$ $\to$ 系统稳定性：Lyapunov 稳定性定理的矩阵形式 $\to$ 鲁棒性 (Robustness) 的动机 $\to$ $H_\infty$ 控制与小增益定理 $\to$ 现代方法：线性矩阵不等式 (LMI) 在控制综合中的主导地位 $\to$ 应用：无人机平衡控制、化工过程的鲁棒抗扰、卫星定轨精度优化

**延伸**：最优控制是线性代数的“性能巅峰”；它将控制器的设计转化为对特定矩阵方程根的寻找，证明了系统的稳定性与抗干扰能力可以完全由算子谱的分布以及矩阵不等式的可行域来保证，是现代精密工业的数学内核

</div>

在解决了“系统是否可控”的问题后，工程师关注的是“如何控制得最好”。**最优控制**（Optimal Control）寻找的是使某种代价函数（如能量消耗或误差积累）达到最小的控制律。而**鲁棒控制**（Robust Control）则进一步考虑了模型的不确定性。本章将展示线性代数中的矩阵方程与不等式如何成为设计稳定、高效、强健的控制系统的终极蓝图。

---

## 66B.1 线性二次调节器 (LQR)

!!! definition "定义 66B.1 (LQR 问题)"
    给定系统 $\dot{x} = Ax + Bu$，最小化二次代价函数：
    $$J = \int_0^\infty (x^T Q x + u^T R u) dt$$
    其中 $Q \succeq 0$ 惩罚状态偏差，$R \succ 0$ 惩罚控制能量。

!!! theorem "定理 66B.1 (LQR 最优解)"
    最优控制律为线性反馈 $\mathbf{u}(t) = -K \mathbf{x}(t)$，其中增益矩阵为：
    $$K = R^{-1} B^T P$$
    而 $P$ 是以下**代数 Riccati 方程 (ARE)** 的唯一正定解：
    $$A^T P + PA - P B R^{-1} B^T P + Q = 0$$

---

## 66B.2 $H_\infty$ 控制与鲁棒性

!!! definition "定义 66B.2 ($H_\infty$ 范数)"
    系统的 $H_\infty$ 范数代表了系统对外部干扰的最大放大倍数。
    **小增益定理**：若闭环系统的 $H_\infty$ 范数小于 1，则系统对任何范数小于 1 的非线性扰动都是鲁棒稳定的。

---

## 66B.3 LMI 与控制综合

!!! technique "技术：线性矩阵不等式 (LMI)"
    现代控制设计往往不直接解方程，而是求解一组 LMI。
    例如，判定系统稳定等价于寻找 $P \succ 0$ 使得：
    $$A^T P + PA \prec 0$$
    利用凸优化工具，我们可以同时满足稳定性、衰减率和执行器饱和等多个复杂约束。

---

## 练习题

**1. [基础] 在 LQR 问题中，若 $R$ 矩阵变得非常大，控制器的行为会发生什么变化？**

??? success "参考答案"
    **代数分析：**
    1. $R$ 代表对控制能量 $u$ 的惩罚。
    2. 若 $R \to \infty$，为了使 $u^T Ru$ 不爆炸，控制量 $u$ 必须被迫趋于 0。
    **结论**：控制器会变得非常“保守”（懒惰），响应变慢，以节省控制能量为代价牺牲了状态调节的速度。

**2. [Riccati] 若系统 $A=1, B=1, Q=3, R=1$（标量），求 Riccati 方程的解 $P$。**

??? success "参考答案"
    **计算步骤：**
    1. 写出 ARE：$1 \cdot P + P \cdot 1 - P \cdot 1 \cdot 1^{-1} \cdot 1 \cdot P + 3 = 0$。
    2. 化简：$2P - P^2 + 3 = 0$。
    3. 整理：$P^2 - 2P - 3 = 0$。
    4. 因式分解：$(P-3)(P+1) = 0$。
    **结论**：取正定解 $P = 3$。

**3. [计算] 根据上题结果，求最优反馈增益 $K$ 及闭环系统矩阵。**

??? success "参考答案"
    **计算：**
    1. $K = R^{-1} B^T P = 1^{-1} \cdot 1 \cdot 3 = 3$。
    2. 闭环系统：$\dot{x} = (A - BK)x = (1 - 1 \cdot 3)x = -2x$。
    **结论**：闭环系统是稳定的（特征值为 -2 < 0）。

**4. [稳定性] 证明：若存在 $P \succ 0$ 满足 $A^T P + PA \prec 0$，则 $A$ 必为 Hurwitz 稳定阵。**

??? success "参考答案"
    **利用 Lyapunov 函数：**
    1. 令 $V(x) = x^T P x$。由于 $P \succ 0$， $V(x)$ 是能量函数。
    2. 求导：$\dot{V} = \dot{x}^T P x + x^T P \dot{x} = (Ax)^T P x + x^T P (Ax) = x^T(A^T P + PA)x$。
    3. 由于 $A^T P + PA \prec 0$，对所有非零 $x$，有 $\dot{V} < 0$。
    **结论**：能量单调递减且有下界，系统必然收敛到原点。

**5. [LMI] 如何将 $A^T P + PA + Q \prec 0$ 转化为标准的 LMI 形式？**

??? success "参考答案"
    由于该式关于未知矩阵 $P$ 是线性的（加法运算），且满足半正定锥约束，它本身就是一个标准的线性矩阵不等式。在 MATLAB (YALMIP) 或 CVX 中，可以直接作为约束条件输入。

**6. [应用] 在自动驾驶中，$Q$ 矩阵的权重分布通常如何设置？**

??? success "参考答案"
    **解释：**
    通常将 $Q$ 设置为对角阵。
    - 对应的“偏离车道中心线”的分量赋予极大权重。
    - 对应的“方向盘小幅摆动”的分量赋予较小权重。
    这通过代数比例强制算法优先保证行车安全性。

**7. [鲁棒性] 什么是系统的不确定性集（Uncertainty Set）？**

??? success "参考答案"
    指实际系统矩阵 $A$ 可能存在的范围，通常表示为 $A_{real} = A_{nom} + \Delta$，其中 $\|\Delta\| \le \epsilon$。鲁棒控制的目标是找到一个 $K$，使得对集合内**所有的** $A$ 系统都稳定。

**8. [计算] 若系统的特征值为 $\{-1, -2\}$，扰动矩阵为 $E = \begin{pmatrix} 0 & 0.1 \\ 0.1 & 0 \end{pmatrix}$。系统一定仍稳定吗？**

??? success "参考答案"
    **判定：**
    根据特征值扰动理论（见 Ch15/42），由于特征值离虚轴（0 点）较远且扰动较小，特征值的偏移不足以跨越虚轴。
    **结论**：由于存在“稳定裕度”，系统在小扰动下保持稳定。

**9. [对偶] 线性二次高斯 (LQG) 控制如何结合了 LQR 和 Kalman 滤波？**

??? success "参考答案"
    **分离原理：**
    1. 利用 Kalman 滤波从噪声数据中估计出最优状态 $\hat{x}$。
    2. 利用 LQR 增益 $K$ 对估计状态进行反馈：$u = -K\hat{x}$。
    线性代数证明了这两个过程可以独立设计而互不影响总体的最优性。

**10. [应用] 简述 $H_\infty$ 控制在抑制无人机风扰中的作用。**

??? success "参考答案"
    风扰被建模为 $L_2$ 范数受限的外部能量。
    $H_\infty$ 控制器设计一个增益矩阵，使得从“风力”到“姿态偏差”的传递算子的奇异值上限（增益）最小化。这保证了即使在极端强风下，无人机的姿态偏移也被严格限制在代数预期的范围内。

## 本章小结

最优与鲁棒控制是线性代数在复杂系统中的“最高统帅部”：

1.  **性能的代数化**：通过 Riccati 方程，它将“什么是最好”这一哲学问题转化为“寻找特定正定阵”的算术问题，实现了性能指标的硬核量化。
2.  **鲁棒性的几何界限**：通过范数与 LMI，它为系统划定了安全的“抗压半径”，证明了线性算子的鲁棒性本质上是其谱结构对扰动空间的包容性。
3.  **综合的艺术**：该理论将观测（Kalman）、决策（LQR）与防御（H-infinity）统一在矩阵分析的框架下，支撑了从深空探测到精密制造的现代工业脊梁。
