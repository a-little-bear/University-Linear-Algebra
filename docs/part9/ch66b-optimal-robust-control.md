# 第 66B 章 最优控制与鲁棒控制

<div class="context-flow" markdown>

**前置**：状态空间控制 (Ch66A) · 正定矩阵 (Ch16) · 矩阵方程 (Ch20) · 矩阵不等式 (Ch18)

**本章脉络**：从稳定控制到最优控制 $\to$ 线性二次调节器 (LQR) 的数学模型 $\to$ 代数 Riccati 方程 (ARE) 的解与控制器增益 $\to$ 线性二次高斯控制 (LQG) 与分离原理 $\to$ 鲁棒控制动机（系统不确定性） $\to$ $H_2$ 与 $H_\infty$ 范数定义 $\to$ 小增益定理 (Small Gain Theorem) $\to$ 利用 LMI 进行鲁棒控制设计 $\to$ 应用：高性能飞行器、主动悬架系统、精密制造

**延伸**：最优控制是寻求“代价最小”的演化路径，而鲁棒控制则是寻求“面对干扰最稳”的防御策略；它们将控制器的设计问题从单纯的极点配置提升到了多目标、矩阵范数优化的维度

</div>

在完成了系统的基本增稳后，工程上的下一个目标往往是“最优性”。我们希望系统在达到目标的同时，消耗的能量最少，或者响应速度最快。**最优控制**（Optimal Control）利用二次型代价函数给出了标准的代数解决方案。而面对现实中模型参数的波动，**鲁棒控制**（Robust Control）则通过最小化算子范数来确保系统的安全性。本章将深入这些现代控制论的高级代数课题。

---

## 66B.1 线性二次调节器 (LQR)

!!! definition "定义 66B.1 (LQR 问题)"
    给定系统 $\dot{\mathbf{x}} = A\mathbf{x} + B\mathbf{u}$，寻找控制序列 $\mathbf{u}(t)$ 使得代价函数 $J$ 最小：
    $$J = \int_0^\infty (\mathbf{x}^T Q \mathbf{x} + \mathbf{u}^T R \mathbf{u}) dt$$
    其中 $Q \succeq 0$ 惩罚状态偏差，$R \succ 0$ 惩罚能量消耗。

!!! theorem "定理 66B.1 (LQR 最优解)"
    最优控制律具有状态反馈形式 $\mathbf{u} = -K\mathbf{x}$，其中：
    $$K = R^{-1} B^T P$$
    且 $P$ 是以下**代数 Riccati 方程 (ARE)** 的唯一正定解：
    $$A^T P + PA - P B R^{-1} B^T P + Q = 0$$

---

## 66B.2 线性二次高斯 (LQG) 与分离原理

!!! technique "LQG 控制"
    在存在测量噪声和过程噪声的情况下，LQG 将最优估计（Kalman 滤波器）与最优控制（LQR）结合。
    **分离原理**：证明了最优估计器和最优控制器的增益可以独立设计，互不干扰。这极大地简化了复杂系统的综合。

---

## 66B.3 鲁棒控制与 $H_\infty$ 范数

!!! definition "定义 66B.2 ($H_\infty$ 范数)"
    对于系统的传递函数 $G(s)$，$H_\infty$ 范数定义为其在频率响应上的最大奇异值：
    $$\|G\|_\infty = \sup_{\omega} \sigma_{\max}(G(i\omega))$$
    代表了系统对外部干扰的最大放大倍数。

!!! theorem "定理 66B.2 (小增益定理)"
    一个带有不确定性反馈 $\Delta$ 的闭环系统是稳定的，只要系统的环路增益乘积满足：
    $$\|G\|_\infty \|\Delta\|_\infty < 1$$
    这为评估模型简化误差提供了硬性的数学准则。

---

## 66B.4 基于 LMI 的控制器设计

!!! technique "控制的 LMI 转化"
    现代控制设计往往避开显式解方程，而是将稳定性、衰减速度和 $H_\infty$ 性能约束写成一组**线性矩阵不等式 (LMI)**。
    $$A^T P + PA + P B R^{-1} B^T P + Q \prec 0 \quad \text{(通过内点法求解 } P\text{)}$$

---

## 练习题

1. **[基础] 在 LQR 代价函数中，增加矩阵 $R$ 的权重会导致控制能量增加还是减少？**

   ??? success "参考答案"
       减少。$R$ 越大，对控制输入 $u$ 的惩罚越重，系统倾向于使用更温和的动作。

2. **[Riccati] 写出标量系统 $\dot{x} = x + u$，$Q=3, R=1$ 时的 Riccati 方程。**

   ??? success "参考答案"
       $1P + P1 - P(1)(1)^{-1}(1)P + 3 = 0 \implies 2P - P^2 + 3 = 0$。
       解得 $P = 3$（取正定解）。

3. **[反馈增益] 利用上题结果，求最优反馈增益 $K$。**

   ??? success "参考答案"
       $K = R^{-1} B^T P = 1^{-1} \cdot 1 \cdot 3 = 3$。最优闭环系统为 $\dot{x} = (1-3)x = -2x$。

4. **[LQG] LQG 系统中，观测器增益 $L$ 是由什么决定的？**

   ??? success "参考答案"
       由过程噪声协方差 $W$ 和测量噪声协方差 $V$ 决定的（通过解另一个双对偶的 Riccati 方程，即 Kalman 增益）。

5. **[范数] 计算标量系统 $G(s) = \frac{1}{s+1}$ 的 $H_\infty$ 范数。**

   ??? success "参考答案"
       $|G(i\omega)| = 1/\sqrt{\omega^2+1}$。最大值在 $\omega=0$ 处取得，故 $\|G\|_\infty = 1$。

6. **[鲁棒性] 若系统具有 20% 的参数不确定性，小增益定理要求标称系统的 $H_\infty$ 范数小于多少？**

   ??? success "参考答案"
       小于 $1/0.2 = 5$。

7. **[性质] 证明：若 $Q$ 是正定的，LQR 闭环系统一定是渐近稳定的。**

   ??? success "参考答案"
       代价函数 $J$ 有界且 $Q \succ 0$ 保证了能量随时间耗散，利用 Lyapunov 函数 $V(x) = x^T P x$ 可证 $\dot{V} = -(x^T Q x + u^T R u) < 0$。

8. **[分离原理] 分离原理失效的情况有哪些？**

   ??? success "参考答案"
       对于非线性系统或带有特定不确定性的鲁棒控制系统，估计与控制往往是耦合的。

9. **[实现] 为什么在数值实现中倾向于解 LMI 而非 Riccati 方程？**

   ??? success "参考答案"
       LMI 可以处理更灵活的约束（如控制增益的有界性、极点区域限制），且利用凸优化求解器更具普适性。

10. **[应用] 简述 $H_\infty$ 控制在抗风干扰无人机中的作用。**

   ??? success "参考答案"
        通过最小化无人机从风力扰动到姿态偏差的 $H_\infty$ 范数，确保即使在强阵风下，姿态波动也保持在安全范围内。

## 本章小结

最优与鲁棒控制理论确立了工程控制的性能极限：

1.  **权衡的代数化**：LQR 通过 $Q$ 与 $R$ 矩阵的配置，将人类对“性能”与“代价”的主观偏好转化为了严谨的二次型最优化问题。
2.  **噪声下的理性**：LQG 与分离原理证明了在统计不确定性面前，信息的最优提取与执行的最优策略是可以完美兼容的，确立了反馈控制的逻辑支柱。
3.  **不确定性的尺度**：$H_\infty$ 范数与小增益定理为系统的“安全性”提供了定量的几何度量，证明了线性代数的算子范数理论是防止现实灾难发生的数学闸门。
