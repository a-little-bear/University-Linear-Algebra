# 第 09 章 二次型与双线性型

<div class="context-flow" markdown>

**前置**：矩阵运算 (Ch02) · 特征值与对角化 (Ch06) · 向量空间 (Ch04)

**本章脉络**：双线性型定义 $\to$ 对称双线性型 $\to$ 二次型定义 $x^T Ax$ $\to$ 标准形与规范形 $\to$ 配方法与初等变换法 $\to$ 矩阵的合同变换 $\to$ Sylvester 惯性定律（正负惯性指数） $\to$ 正定性判定（Hurwitz 准则） $\to$ 几何意义：二次曲面的分类与旋转 $\to$ 应用：多元函数极值分析（Hessian 矩阵）

**延伸**：二次型是多元函数局部形状的代数刻画，是经典力学中动能表达以及最优化理论的代数核心；它是研究流形曲率与引力场方程的基础

</div>

二次型研究的是标量函数，其形式为变量的二次齐次多项式。通过线性替换（合同变换），我们可以将复杂的交叉项消除，从而揭示函数的本质几何特征。本章将确立判定二次型“符号”的标准方法，并将代数性质与空间曲面的形态完美对映。

---

## 09.1 双线性型与二次型

!!! definition "定义 09.1 (双线性型与二次型)"
    1.  **双线性型**：映射 $B: V \times V \to F$ 满足对每个变量都是线性的。
    2.  **二次型**：由对称双线性型导出的函数 $Q(\mathbf{x}) = B(\mathbf{x}, \mathbf{x})$。
    在选定基后，可写为：
    $$Q(\mathbf{x}) = \sum_{i=1}^n \sum_{j=1}^n a_{ij} x_i x_j = \mathbf{x}^T A \mathbf{x}$$
    其中 $A$ 总是可以选为**对称矩阵**。

---

## 09.2 合同变换与标准形

!!! definition "定义 09.2 (合同变换)"
    若存在非奇异矩阵 $P$ 使得 $B = P^T A P$，则称矩阵 $A$ 与 $B$ **合同**（Congruent）。
    **几何意义**：合同变换对应于坐标系的线性替换，不改变二次型取值的集合。

!!! theorem "定理 09.1 (Sylvester 惯性定律)"
    实数域上任一二次型通过合同变换化为标准形 $\sum d_i y_i^2$ 后，其正系数的个数 $p$（正惯性指数）和负系数的个数 $q$（负惯性指数）是不变量。
    - **秩**：$r = p + q$。
    - **符号差**：$s = p - q$。

---

## 09.3 正定性判定

!!! definition "定义 09.3 (正定性分类)"
    1.  **正定**：对所有 $\mathbf{x} \neq \mathbf{0}$，$Q(\mathbf{x}) > 0$。特征值全正。
    2.  **半正定**：$Q(\mathbf{x}) \ge 0$。特征值非负。
    3.  **不定**：既能取正值也能取负值。特征值有正有负。

!!! theorem "定理 09.2 (Hurwitz 准则 / 顺序主子式判据)"
    实对称矩阵 $A$ 正定的充要条件是：它的所有顺序主子式均大于 0。

---

## 练习题

**1. [基础] 写出二次型 $f(x, y) = x^2 + 4xy + 3y^2$ 的对称矩阵表示。**

??? success "参考答案"
    **步骤：**
    1. 平方项系数放在对角线上：$a_{11}=1, a_{22}=3$。
    2. 交叉项系数 $4xy$ 平分到非对角元：$a_{12}=2, a_{21}=2$。
    **矩阵表示**：
    $A = \begin{pmatrix} 1 & 2 \\ 2 & 3 \end{pmatrix}$。
    验证：$(x \ y) \begin{pmatrix} 1 & 2 \\ 2 & 3 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = x(x+2y) + y(2x+3y) = x^2 + 4xy + 3y^2$。

**2. [配方法] 用配方法将 $Q(x, y) = x^2 + 4xy$ 化为标准形。**

??? success "参考答案"
    **配方步骤：**
    1. 补全平方：$Q = (x^2 + 4xy + 4y^2) - 4y^2$。
    2. 写成完全平方形式：$Q = (x+2y)^2 - 4y^2$。
    3. 令坐标变换为：$u = x+2y, v = y$。
    **结论**：标准形为 $u^2 - 4v^2$。其正惯性指数 $p=1$，负惯性指数 $q=1$。

**3. [合同] 已知 $A, B$ 合同，它们的特征值一定相同吗？**

??? success "参考答案"
    **结论**：不一定。
    **解析**：
    - **相似变换** $P^{-1}AP$ 保持特征值。
    - **合同变换** $P^T AP$ 保持的是**惯性指数**（正、负特征值的个数），但不保证特征值具体的数值。
    - 例如 $\begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}$ 与 $\begin{pmatrix} 2 & 0 \\ 0 & 2 \end{pmatrix}$ 合同（取 $P=\sqrt{2}I$），但特征值分别是 1 和 2。

**4. [正定判定] 使用顺序主子式判定 $A = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$ 是否正定。**

??? success "参考答案"
    **计算主子式：**
    1. 一阶：$D_1 = 2 > 0$。
    2. 二阶：$D_2 = 2 \cdot 2 - 1 \cdot 1 = 3 > 0$。
    **结论**：由于所有顺序主子式均为正，该矩阵是正定的。

**5. [惯性指数] 求 $Q = x^2 - y^2$ 的惯性指数和符号差。**

??? success "参考答案"
    **分析：**
    1. 标准形已经给出：$1x^2 + (-1)y^2$。
    2. 正系数个数 $p=1$。
    3. 负系数个数 $q=1$。
    4. 符号差 $s = p - q = 0$。
    **结论**：惯性指数为 $(1, 1)$，符号差为 0。

**6. [几何] $x^2 + y^2 = 1$ 与 $x^2 - y^2 = 1$ 分别代表什么曲线？它们与二次型正定性的关系？**

??? success "参考答案"
    **几何分类：**
    1. $x^2 + y^2 = 1$：代表圆（或椭圆）。对应的二次型是**正定**的，等值线是闭合的。
    2. $x^2 - y^2 = 1$：代表双曲线。对应的二次型是**不定**的，等值线是不闭合的。
    这说明二次型的符号特征直接决定了其几何水平集的拓扑性质。

**7. [瑞利商] 瑞利商 $R(\mathbf{x}) = \frac{\mathbf{x}^T A \mathbf{x}}{\mathbf{x}^T \mathbf{x}}$ 的最大值是多少？**

??? success "参考答案"
    **定理：**
    瑞利商的最大值等于矩阵 $A$ 的**最大特征值** $\lambda_{\max}$，最小值等于最小特征值 $\lambda_{\min}$。
    这建立了几何上的“拉伸”与代数上的谱之间的桥梁。

**8. [反对称] 证明：对于任何反对称阵 $A$，其诱导的二次型 $\mathbf{x}^T A \mathbf{x}$ 恒为 0。**

??? success "参考答案"
    **证明：**
    1. 二次型是一个标量，其转置等于自身：$\mathbf{x}^T A \mathbf{x} = (\mathbf{x}^T A \mathbf{x})^T$。
    2. 展开转置：$= \mathbf{x}^T A^T \mathbf{x}$。
    3. 利用反对称性 $A^T = -A$：$= \mathbf{x}^T (-A) \mathbf{x} = -\mathbf{x}^T A \mathbf{x}$。
    4. 一个数等于其相反数，必有 $\mathbf{x}^T A \mathbf{x} = 0$。
    **结论**：这就是为什么研究二次型时只考虑对称矩阵。

**9. [规范形] 将 $Q = 2x^2 + 2y^2$ 化为规范形。**

??? success "参考答案"
    **步骤：**
    1. 已是标准形。
    2. 为了得到规范形（系数仅为 1, -1, 0），进行缩放。
    3. 令 $u = \sqrt{2}x, v = \sqrt{2}y$。
    **结论**：规范形为 $u^2 + v^2$。

**10. [应用] 二次型在最优化中如何判定驻点处的性质？**

??? success "参考答案"
    **分析：**
    利用多元函数的 **Hessian 矩阵** $H$：
    1. 若 $H$ 在驻点处是**正定**的，则该点是局部极小值。
    2. 若 $H$ 是**负定**的，则该点是局部极大值。
    3. 若 $H$ 是**不定**的，则该点是鞍点。
    这展示了二次型理论在分析连续空间曲率中的核心作用。

## 本章小结

二次型建立了多项式代数与空间几何的桥梁：

1.  **结构简化**：合同变换是消除交叉项、简化坐标系的利刃，揭示了对称算子的核心惯性。
2.  **符号动力学**：惯性定律确立了二次函数最深层的拓扑不变量，不随坐标旋转或拉伸而改变。
3.  **正定性核心**：作为能量、距离和稳定性分析的代数判据，正定性理论是连接线性代数与分析学、物理学的关键枢纽。
