# 第 20 章 矩阵方程

<div class="context-flow" markdown>

**前置**：Kronecker 积与 Vec 算子 (Ch19) · 矩阵分析 (Ch14) · 特征值 (Ch06)

**本章脉络**：从标量方程到矩阵变量方程 $\to$ 基础线性方程 $AX=B$ 与 $AXB=C$ $\to$ Sylvester 方程 ($AX+XB=C$) 的解的存在唯一性（谱分离条件） $\to$ Lyapunov 方程 ($AX+XA^T=Q$) 与稳定性判定 $\to$ 离散与连续情形的对比 $\to$ 非线性矩阵方程：代数 Riccati 方程 (ARE) $\to$ 计算技术：Bartels-Stewart 算法 $\to$ 应用：最优控制 (LQR)、卡尔曼滤波、结构动力学模型简化

**延伸**：矩阵方程是现代控制理论与数值线性代数的纽带；它不仅解决了算子间的线性干涉问题，还通过 Riccati 方程确立了最优反馈增益的代数解析路径

</div>

当未知数本身是一个矩阵时，我们称其为**矩阵方程**。这类方程不仅是线性算子理论的自然延伸，更是动力系统平衡点分析、控制增益计算以及复杂数值模拟的直接产物。本章将从最简单的线性耦合方程出发，利用 Ch19 的向量化工具，逐步深入到控制理论中最核心的非线性 Riccati 方程。

---

## 20.1 线性矩阵方程及其向量化

!!! definition "定义 20.1 (基础线性矩阵方程)"
    1.  **左乘方程 $AX = B$**：有解当且仅当 $B$ 的每一列都属于 $A$ 的列空间。
    2.  **双边方程 $AXB = C$**：可化为 $(B^T \otimes A) \operatorname{vec}(X) = \operatorname{vec}(C)$。其唯一可解性取决于 $B^T \otimes A$ 是否非奇异。

---

## 20.2 Sylvester 与 Lyapunov 方程

!!! definition "定义 20.2 (Sylvester 方程)"
    形式为：$AX + XB = C$。
    其中 $A \in M_n, B \in M_m, C \in M_{n \times m}$。

!!! theorem "定理 20.1 (唯一可解性准则)"
    Sylvester 方程 $AX + XB = C$ 对任何 $C$ 都有唯一解，当且仅当 $A$ 与 $-B$ **无公共特征值**：
    $$\sigma(A) \cap \sigma(-B) = \emptyset$$
    **意义**：这一谱分离条件保证了算子和 $A \oplus B^T$ 是可逆的。

---

## 20.3 代数 Riccati 方程 (ARE)

!!! definition "定义 20.3 (连续时间 ARE)"
    $$A^T X + XA - X B R^{-1} B^T X + Q = 0$$
    这是一个二次非线性矩阵方程。
    **应用**：求解线性二次调节器 (LQR) 问题的最优状态反馈增益。

---

## 练习题

**1. [Sylvester] 判定 $\begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} X + X \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} = C$ 是否有唯一解。**

??? success "参考答案"
    **判定步骤：**
    1. 提取矩阵：$A = I, B = I$。
    2. 计算谱：$\sigma(A) = \{1\}, \sigma(-B) = \{-1\}$。
    3. 检查交集：$\{1\} \cap \{-1\} = \emptyset$。
    **结论**：光谱分离条件满足，故方程对任何 $C$ 都有唯一解。

**2. [唯一性] 若 $A$ 与 $B$ 均是对角阵且具有公共特征值，Sylvester 方程一定无解吗？**

??? success "参考答案"
    **解析：**
    1. 不一定。
    2. 若谱有重合，对应的向量化矩阵 $M = I \otimes A + B^T \otimes I$ 是奇异的（有 0 特征值）。
    3. 这意味着方程要么有无穷多解（若 $\operatorname{vec}(C)$ 在 $M$ 的列空间内），要么无解。
    **结论**：仅能判定解不唯一，不能直接判定无解。

**3. [Lyapunov] 为什么 Lyapunov 方程 $AX + XA^T = Q$ 常用于稳定性分析？**

??? success "参考答案"
    **物理逻辑：**
    1. 解 $X$ 构成了系统的广义能量函数 $V(x) = x^T X x$。
    2. 对该函数求导得到 $\dot{V} = x^T(AX + XA^T)x = x^T Q x$。
    3. 若能找到 $X \succ 0$ 使得 $\dot{V} < 0$（即 $Q \prec 0$），则系统稳定。
    **代数映射**：Lyapunov 方程将“微分方程的稳定性”转化为了“线性矩阵方程的正定性问题”。

**4. [向量化] 将 $AXB + CXD = F$ 转化为向量形式。**

??? success "参考答案"
    **步骤：**
    1. 对每一项应用向量化公式 $\operatorname{vec}(MXN) = (N^T \otimes M) \operatorname{vec}(X)$。
    2. 第一项：$(B^T \otimes A) \operatorname{vec}(X)$。
    3. 第二项：$(D^T \otimes C) \operatorname{vec}(X)$。
    **结论**：$(B^T \otimes A + D^T \otimes C) \operatorname{vec}(X) = \operatorname{vec}(F)$。

**5. [Riccati] 证明：若 $X$ 是 Riccati 方程的解，则其转置 $X^T$ 也是解（假设 $Q, R$ 对称）。**

??? success "参考答案"
    **证明：**
    1. 对方程 $A^T X + XA - XBR^{-1}B^T X + Q = 0$ 两边同时取转置。
    2. $(A^T X)^T + (XA)^T - (XBR^{-1}B^T X)^T + Q^T = 0$。
    3. $X^T A + A^T X^T - X^T B R^{-1} B^T X^T + Q = 0$。
    4. 观察发现，所得方程关于 $X^T$ 的形式与原方程关于 $X$ 的形式完全一致。
    **结论**：$X^T$ 满足相同的方程。

**6. [计算] 求解 $(1)X + X(2) = (6)$（标量情形）。**

??? success "参考答案"
    **计算：**
    $1 \cdot X + X \cdot 2 = 6 \implies 3X = 6 \implies X = 2$。
    这展示了矩阵方程在退化到 1 维时与普通线性方程的一致性。

**7. [性质] 证明：若 $A, B$ 是上三角阵，Sylvester 方程的解 $X$ 也是上三角阵吗？**

??? success "参考答案"
    **结论**：一般不成立。
    **理由**：解 $X$ 的结构不仅取决于 $A, B$ 的结构，还极大地取决于常数项 $C$ 的结构。如果 $C$ 是全矩阵，即使 $A, B$ 是对角阵，解 $X$ 也通常是全矩阵。

**8. [离散情形] 写出离散 Lyapunov 方程的形式。**

??? success "参考答案"
    **公式：**
    $$A X A^T - X = Q$$
    或写为 $A X A^T - X + Q = 0$。它描述了差分方程 $x_{k+1} = Ax_k$ 的稳定性。

**9. [数值算法] 简述 Bartels-Stewart 算法求解 $AX+XB=C$ 的核心思想。**

??? success "参考答案"
    **思想：**
    1. 利用 Schur 分解将 $A$ 和 $B$ 分别化为上三角阵和下三角阵。
    2. 此时，方程在变换后的基下变成了“逐分量耦合”的形式。
    3. 我们可以通过类似于回代的方法，从矩阵的一个角开始，逐个求出 $X$ 的元素。
    **优点**：复杂度为 $O(n^3)$，远低于直接向量化求解的 $O(n^6)$。

**10. [应用] 在卡尔曼滤波中，预测步的协方差更新方程是一个矩阵方程吗？**

??? success "参考答案"
    **是的。**
    协方差更新方程 $P_{k|k-1} = A P_{k-1|k-1} A^T + Q$ 本质上是一个矩阵线性映射。而求解稳态卡尔曼增益则需要解一个代数 Riccati 方程。

## 本章小结

矩阵方程是高级线性系统的代数语言：

1.  **解的耦合性**：Sylvester 方程刻画了两个不同算子间的线性干涉，其谱分离条件揭示了系统共振与否的本质。
2.  **能量与稳定**：Lyapunov 方程通过二次型矩阵建立了代数与解析稳定性的桥梁，是控制工程中反馈设计的基础。
3.  **最优性寻找**：Riccati 方程展示了非线性结构如何自然地出现在变分和最优控制问题中，其求解标志着从线性系统分析到线性系统综合的跨越。
