# 第 17 章 非负矩阵与 Perron-Frobenius 理论

<div class="context-flow" markdown>

**前置**：特征值 (Ch06) · 矩阵分析 (Ch14) · 图论基础 (Ch27)

**本章脉络**：非负矩阵定义 $\to$ 正矩阵与非负矩阵的区别 $\to$ 矩阵的不可约性（图论准则） $\to$ Perron 定理（正矩阵） $\to$ Frobenius 定理（不可约非负矩阵） $\to$ Perron 特征值与特征向量的独特性 $\to$ 随机矩阵与 Markov 链 $\to$ Collatz-Wielandt 公式 $\to$ 应用：Google PageRank 算法

**延伸**：Perron-Frobenius 理论是分析离散时间系统（如人口模型、经济投入产出、网页排名）平衡点的终极工具；它揭示了“非负性”这一简单物理约束如何导出极强的代数规律

</div>

在现实世界中，大多数物理量（如概率、人口、金钱、像素）都是非负的。非负矩阵（Non-negative Matrix）正是刻画这些物理量演化的数学模型。Perron-Frobenius 理论不仅保证了最大特征值的存在性，还确立了与之对应的“物理意义”上的正特征向量。

---

## 17.1 正矩阵与 Perron 定理

!!! definition "定义 17.1 (正矩阵与非负矩阵)"
    1.  **非负矩阵 $A \ge 0$**：所有元素 $a_{ij} \ge 0$。
    2.  **正矩阵 $A > 0$**：所有元素 $a_{ij} > 0$。

!!! theorem "定理 17.1 (Perron 定理)"
    若 $A > 0$，则：
    1.  **主特征值**：谱半径 $r = \rho(A)$ 是 $A$ 的一个特征值且 $r > 0$。
    2.  **简单性**：$r$ 是特征方程的一个单根（代数重数为 1）。
    3.  **正向量**：对应于 $r$ 的特征向量 $\mathbf{v}$ 可以选为全正的（$v_i > 0$）。
    4.  **支配性**：对任何其他特征值 $\lambda$，均有 $|\lambda| < r$。

---

## 17.2 不可约性与 Frobenius 推广

!!! definition "定义 17.2 (不可约矩阵)"
    矩阵 $A$ 称为**不可约的**（Irreducible），如果它不能通过置换变换化为分块上三角形式。在图论中，这等价于其关联的有向图是强连通的。

!!! theorem "定理 17.2 (Frobenius 定理)"
    对于不可约非负矩阵 $A \ge 0$，Perron 定理的大部分结论依然成立，但“支配性”弱化为 $|\lambda| \le r$（可能存在多个模长等于 $r$ 的特征值，见循环矩阵）。

---

## 17.3 随机矩阵与 Markov 链

!!! definition "定义 17.3 (随机矩阵)"
    若非负矩阵 $A$ 的每一行元素之和均为 1，则称 $A$ 为**行随机矩阵**。
    **性质**：随机矩阵的谱半径 $\rho(A) = 1$，且全 1 向量 $\mathbf{1}$ 是对应于特征值 1 的特征向量。

---

## 练习题

1. **[基础] 判定 $A = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$ 是否为正矩阵。**
   ??? success "参考答案"
       不是。它是非负矩阵，但含有 0 元素。

2. **[不可约] 上题中的 $A$ 是否不可约？**
   ??? success "参考答案"
       是的。其关联图 $1 \leftrightarrow 2$ 是强连通的。

3. **[特征值] 求 $\begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}$ 的 Perron 特征值。**
   ??? success "参考答案"
       特征值为 2, 0。故 $r = \rho(A) = 2$。

4. **[特征向量] 求上题中 $r=2$ 对应的正特征向量。**
   ??? success "参考答案"
       $\begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix} \begin{pmatrix} 1 \\ 1 \end{pmatrix} = 2 \begin{pmatrix} 1 \\ 1 \end{pmatrix}$。故 $\mathbf{v} = (1, 1)^T$。

5. **[随机阵] 证明随机矩阵必有一个特征值为 1。**
   ??? success "参考答案"
       $A \mathbf{1}$ 的第 $i$ 个分量等于 $A$ 第 $i$ 行元素之和。由定义该和为 1，故 $A \mathbf{1} = 1 \cdot \mathbf{1}$。

6. **[图论] 为什么 $A = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}$ 是可约的？**
   ??? success "参考答案"
       它已经是上三角形式（或者观察图：顶点 2 无法到达顶点 1）。

7. **[支配性] 举出一个不可约非负矩阵，其特征值满足 $|\lambda| = r$ 但 $\lambda \neq r$。**
   ??? success "参考答案"
       $A = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$。特征值为 1 和 -1。$|-1| = 1$。

8. **[应用] 在 PageRank 中，为什么要在原始链接矩阵上加一个全正的扰动矩阵？**
   ??? success "参考答案"
       为了使矩阵变为全正阵，从而保证 Perron 特征值 1 的唯一性（强连通且非周期），确保幂法迭代收敛。

9. **[性质] 若 $A \ge 0$，证明 $\rho(A)$ 是 $A$ 元素的一个单调不减函数。**
   ??? success "参考答案"
       由 Collatz-Wielandt 公式 $\rho(A) = \sup_{x>0} \min_i \frac{(Ax)_i}{x_i}$，增加 $A$ 的元素显然会增加该上确界。

10. **[极限] 若 $A$ 是原初矩阵（Primitive），则 $\lim_{k \to \infty} (A/r)^k$ 等于什么？**
    ??? success "参考答案"
        等于 $\mathbf{v}\mathbf{w}^T$，其中 $\mathbf{v}, \mathbf{w}$ 分别是 $A$ 的归一化左右 Perron 特征向量。

## 本章小结

非负矩阵理论建立了物理规律与代数结构之间的和谐共振：

1.  **正性的保全**：Perron-Frobenius 定理确立了主特征向量的正性，这为概率分布、资源分配等现实问题提供了唯一合法的稳态解。
2.  **结构的连通性**：不可约性将矩阵的代数性质与图的拓扑结构绑定，证明了“全空间流通”是系统趋于唯一稳定状态的先决条件。
3.  **计算的收敛性**：随机矩阵理论为所有平衡演化过程（如 Markov 链）奠定了基础，揭示了复杂网络（如互联网、神经网络）中信息流动的最终指向。
