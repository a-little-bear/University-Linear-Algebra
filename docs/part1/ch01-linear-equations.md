# 第 01 章 线性方程组

<div class="context-flow" markdown>

**前置**：多项式代数 (Ch00)

**本章脉络**：线性方程组定义 $\to$ 矩阵表示（增广矩阵） $\to$ 初等变换 $\to$ 阶梯形 (REF) 与行最简形 (RREF) $\to$ 高斯消元法与高斯-约当消元法 $\to$ 解的判定定理（存在性与唯一性） $\to$ 齐次与非齐次方程组 $\to$ 几何意义（超平面交集） $\to$ 数值稳定性初步

**延伸**：线性方程组的求解是几乎所有数值计算（有限元、最优化、机器学习）的底层核心；其解空间的结构直接引出了向量空间 (Ch04) 的定义

</div>

线性方程组是线性代数的逻辑起点。从古老的九章算术到现代的超级计算机，求解 $Ax = b$ 始终是科学计算中最核心的任务。本章将从算法（消元法）和理论（解的结构）两个维度，系统建立处理线性系统的标准框架。

---

## 01.1 线性方程组与矩阵表示

!!! definition "定义 01.1 (线性方程组)"
    包含 $m$ 个方程、$n$ 个未知数的线性方程组通常写为：
    $$\begin{cases} a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\ a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\ \vdots \\ a_{m1}x_1 + a_{m2}x_2 + \cdots + a_{mn}x_n = b_m \end{cases}$$
    其中 $a_{ij}$ 是系数，$b_i$ 是常数项，$x_j$ 是未知数。

!!! definition "定义 01.2 (增广矩阵)"
    将上述方程组的系数与常数项合并，得到 $m \times (n+1)$ 的**增广矩阵**（Augmented Matrix）：
    $$\tilde{A} = [A | \mathbf{b}] = \begin{pmatrix} a_{11} & a_{12} & \cdots & a_{1n} & | & b_1 \\ a_{21} & a_{22} & \cdots & a_{2n} & | & b_2 \\ \vdots & \vdots & \ddots & \vdots & | & \vdots \\ a_{m1} & a_{m2} & \cdots & a_{mn} & | & b_m \end{pmatrix}$$

---

## 01.2 初等行变换与阶梯形

!!! definition "定义 01.3 (初等行变换)"
    1.  **倍法**：用非零常数 $k$ 乘以某一行。
    2.  **互换**：交换两行的位置。
    3.  **消法**：将某一行的 $k$ 倍加到另一行。
    这些操作**不改变**方程组的解集。

!!! definition "定义 01.4 (行最简形矩阵 RREF)"
    一个矩阵称为**行最简形矩阵**（Reduced Row Echelon Form），如果满足：
    1.  非零行在零行的上方。
    2.  每个非零行的首个非零元（主元）是 1。
    3.  主元所在的列，除主元外其余元素均为 0。
    4.  每一行的主元都在上一行主元的右侧。

---

## 01.3 高斯消元法

!!! algorithm "算法 01.1 (高斯-约当消元步骤)"
    1.  **前向消元**：通过初等变换将增广矩阵化为行阶梯形（REF）。
    2.  **反向替换**（或约当消元）：从下往上将所有主元化为 1，并清除主元上方的元素，得到 RREF。
    3.  **读出解**：根据 RREF 直接写出通解。

---

## 01.4 解的存在性与唯一性

!!! theorem "定理 01.1 (解的判定定理)"
    设 $A$ 为 $m \times n$ 矩阵，$\operatorname{rank}(A)$ 为矩阵的秩。
    1.  **无解**：$\operatorname{rank}(A) < \operatorname{rank}([A|\mathbf{b}])$。这在 RREF 中表现为出现 $[0 \ 0 \ \cdots \ 0 \ | \ d]$ ($d \neq 0$) 的行。
    2.  **唯一解**：$\operatorname{rank}(A) = \operatorname{rank}([A|\mathbf{b}]) = n$（未知数个数）。
    3.  **无穷多解**：$\operatorname{rank}(A) = \operatorname{rank}([A|\mathbf{b}]) < n$。此时自由变量个数为 $n - \operatorname{rank}(A)$。

---

## 01.5 齐次线性方程组

!!! definition "定义 01.5 (齐次方程组)"
    形如 $Ax = 0$ 的方程组称为齐次方程组。它总是有**零解** $x=0$。
    - 齐次方程组有非零解的充要条件是 $\operatorname{rank}(A) < n$。
    - 若 $m < n$（方程数少于未知数），则 $Ax=0$ 必有非零解。

---

## 练习题

**1. [判定] 判定方程组 $x+y=1, x+y=2$ 是否有解。说明理由。**

??? success "参考答案"
    **代数推导：**
    1. 观察方程左侧：两方程左侧完全相同，均为 $x+y$。
    2. 若系统有解 $(x, y)$，则必有 $1 = x+y = 2$，即 $1=2$，产生矛盾。
    
    **矩阵秩判定：**
    1. 增广矩阵 $\tilde{A} = \begin{pmatrix} 1 & 1 & | & 1 \\ 1 & 1 & | & 2 \end{pmatrix}$。
    2. 行变换 $R_2 - R_1 \to R_2$ 得 $\begin{pmatrix} 1 & 1 & | & 1 \\ 0 & 0 & | & 1 \end{pmatrix}$。
    3. 结论：系数矩阵秩 $\operatorname{rank}(A) = 1$，增广矩阵秩 $\operatorname{rank}(\tilde{A}) = 2$。
    由于 $\operatorname{rank}(A) \neq \operatorname{rank}(\tilde{A})$，方程组**无解**。

**2. [消元] 使用高斯消元法求解：$x+y=3, x-y=1$。**

??? success "参考答案"
    **步骤 1：前向消元（加减消元）。**
    将两式相加：$(x+y) + (x-y) = 3 + 1 \implies 2x = 4 \implies x = 2$。
    
    **步骤 2：回代。**
    将 $x=2$ 代入第一个方程：$2 + y = 3 \implies y = 1$。
    
    **结论：**
    方程组有唯一解 $(2, 1)$。在几何上，这对应于 $\mathbb{R}^2$ 平面中两条斜率不同的直线的交点。

**3. [RREF] 将矩阵 $\begin{pmatrix} 1 & 2 \\ 2 & 4 \end{pmatrix}$ 化为行最简阶梯形。**

??? success "参考答案"
    **步骤 1：化为行阶梯形 (REF)。**
    执行 $R_2 - 2R_1 \to R_2$，得 $\begin{pmatrix} 1 & 2 \\ 0 & 0 \end{pmatrix}$。
    
    **步骤 2：检查 RREF 条件。**
    1. 非零行在零行上方（满足）。
    2. 主元为 1（满足，$a_{11}=1$）。
    3. 主元所在列其余元素为 0（满足）。
    
    **结论：**
    RREF 为 $\begin{pmatrix} 1 & 2 \\ 0 & 0 \end{pmatrix}$。由于只有一行非零，该矩阵的秩为 1。

**4. [自由变量] 若 3 方程 5 未知数的系统满秩，有多少个自由变量？**

??? success "参考答案"
    **推导：**
    1. 系统的秩 $\operatorname{rank}(A)$ 等于独立主元的个数。
    2. “满秩”在此类超定/欠定系统中通常指行满秩，即 $\operatorname{rank}(A) = 3$。
    3. 自由变量的个数等于总未知数个数减去秩。
    4. 计算：$5 - 3 = 2$。
    
    **结论：**
    该系统有 **2 个自由变量**，其通解可以表示为 2 个线性无关基向量的组合加上一个特解。

**5. [齐次解] 描述 $x_1 + x_2 + x_3 = 0$ 的解空间。**

??? success "参考答案"
    **几何描述：**
    这是一个三维空间中过原点的平面，其法向量为 $(1, 1, 1)^T$。
    
    **代数推导：**
    1. 选取自由变量：令 $x_2 = s, x_3 = t$。
    2. 导出主变量：$x_1 = -s - t$。
    3. 写成向量形式：$\mathbf{x} = \begin{pmatrix} -s-t \\ s \\ t \end{pmatrix} = s \begin{pmatrix} -1 \\ 1 \\ 0 \end{pmatrix} + t \begin{pmatrix} -1 \\ 0 \\ 1 \end{pmatrix}$。
    
    **结论：**
    解空间是由向量 $(-1, 1, 0)^T$ 和 $(-1, 0, 1)^T$ 张成的 2 维子空间。

**6. [秩] 证明：若 $Ax=b$ 对任何 $b$ 都有解，则 $A$ 必须行满秩。**

??? success "参考答案"
    **证明：**
    1. “对任何 $b$ 都有解”意味着 $A$ 的列空间的维数必须等于 $b$ 所在的向量空间的维数 $m$。
    2. 列空间的维数即为矩阵的秩 $\operatorname{rank}(A)$。
    3. 若 $A$ 是 $m \times n$ 矩阵，则必须有 $\operatorname{rank}(A) = m$。
    4. 这意味着矩阵的行向量是线性无关的，即行满秩。

**7. [解析] 一个矛盾方程组 $[0, 0 | 1]$ 在几何上代表什么？**

??? success "参考答案"
    **几何意义：**
    1. 方程 $0x + 0y = 1$ 代表一个虚无的集合（空集）。
    2. 在多维空间中，这通常意味着两个超平面是**严格平行**的且不重合。
    3. 例如 $x+y=1$ 和 $x+y=2$，它们在无穷远处也不相交，因此不存在交点。

**8. [参数解] 求解 $x+y+z=1$ 的通解。**

??? success "参考答案"
    **步骤：**
    1. 这是一个非齐次线性方程。
    2. **找一个特解**：令 $y=0, z=0$，得 $x=1$。特解 $\mathbf{x}_p = (1, 0, 0)^T$。
    3. **找基础解系**：考虑齐次方程 $x+y+z=0$。
       由上题可知基为 $\mathbf{v}_1 = (-1, 1, 0)^T, \mathbf{v}_2 = (-1, 0, 1)^T$。
    4. **组合通解**：$\mathbf{x} = \mathbf{x}_p + c_1 \mathbf{v}_1 + c_2 \mathbf{v}_2$。
    
    **结论：**
    通解为 $(1, 0, 0)^T + c_1(-1, 1, 0)^T + c_2(-1, 0, 1)^T$。

**9. [特殊解] 非齐次方程组的通解结构是什么？**
    
??? success "参考答案"
    **结构：**
    **通解 = 特解 + 齐次解**。
    - **特解**：满足 $Ax=b$ 的任意一个向量。
    - **齐次解**：满足 $Ax=0$ 的所有向量构成的子空间（零空间）。
    这一结构在代数上保证了只要找到一个可行解，就可以通过零空间向量的平移遍历所有的解。

**10. [数值] 为什么在大规模计算中要使用“选主元”的高斯消元？**

??? success "参考答案"
    **数值稳定性分析：**
    1. 在计算机的浮点运算中，如果主元 $a_{ii}$ 的绝对值非常小，那么在消元过程中执行 $a_{jk} / a_{ii}$ 会产生一个巨大的系数。
    2. 这个巨大的系数会放大上一行已有的舍入误差，导致最终结果完全失真。
    3. **选主元策略**：通过交换行（部分选主元），确保每次用于除法的分母是当前列中绝对值最大的元素，从而将误差放大系数控制在 1 以内，极大提高算法的**鲁棒性**。

## 本章小结

本章完成了从直观方程到算法化矩阵的跨越：

1.  **算法核心**：高斯消元法是解决线性问题的通用工具，其 RREF 形式揭示了系统最本质的结构。
2.  **结构洞察**：解的存在性与唯一性完全由系数矩阵与增广矩阵的秩对比决定。
3.  **空间基础**：齐次系统的解集构成子空间，而非齐次系统的解集则是该子空间的平移（仿射空间）。
