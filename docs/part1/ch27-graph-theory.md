# 第 27 章 线性代数在图论与网络中的应用

<div class="context-flow" markdown>

**前置**：矩阵运算(Ch2) · 特征值(Ch6) · 向量空间(Ch4)

**本章脉络**：图的矩阵表示（邻接矩阵、关联矩阵） → 图 Laplacian 矩阵 $L = D - A$ → 矩阵树定理 (Matrix Tree Theorem) → 谱图论（谱半径、代数连通度） → 随机游走与特征值的关系 → 网络流与关联矩阵 → 应用（社交网络中心度分析、图像分割、社团检测）

**延伸**：谱图论是连接离散拓扑与连续代数的桥梁；它通过研究矩阵的特征值来洞察网络的连通性与脆弱性

</div>

图论研究顶点及其连接关系。线性代数通过将图“矩阵化”，为研究复杂的拓扑结构提供了一套强有力的分析工具。矩阵的谱（特征值集合）像是指纹一样，编码了图的关键结构信息。

---

## 27.1 核心矩阵与定理

!!! definition "定义 27.1 (图 Laplacian 矩阵)"
    对于简单无向图 $G$，其 Laplacian 矩阵定义为 $L = D - A$，其中 $D$ 为度数矩阵（对角阵），$A$ 为邻接矩阵。

!!! theorem "定理 27.3 (矩阵树定理)"
    图 $G$ 的生成树的数量等于其 Laplacian 矩阵 $L$ 的任何一个辅因子的值。

---

## 练习题

1. **[基础] 写出三角形图 $K_3$ 的邻接矩阵 $A$。**
   ??? success "参考答案"
       $A = \begin{pmatrix} 0 & 1 & 1 \ 1 & 0 & 1 \ 1 & 1 & 0 \end{pmatrix}$。注意主对角线全为 0。

2. **[Laplacian性质] 证明：Laplacian 矩阵 $L$ 的每一行之和均为 0。**
   ??? success "参考答案"
       $L_{ii} = d_i$（节点的度数），而 $L_{ij} = -1$（若 $i, j$ 相连）。
       行和 $= d_i + \sum_{j 
eq i} (-1) = d_i - d_i = 0$。
       这意味着 $\mathbf{1} = (1, \dots, 1)^T$ 始终是 $L$ 对应于特征值 0 的特征向量。

3. **[连通性] 图的 Laplacian 矩阵的特征值 0 的重数代表什么？**
   ??? success "参考答案"
       特征值 0 的重数等于该图的**连通分量**的数量。一个连通图恰好有一个为 0 的特征值。

4. **[矩阵树定理计算] 计算一条包含 3 个顶点的路径 $P_3$ 的生成树数量。**
   ??? success "参考答案"
       $L = \begin{pmatrix} 1 & -1 & 0 \ -1 & 2 & -1 \ 0 & -1 & 1 \end{pmatrix}$。
       去掉最后一行一列，余子式为 $\begin{vmatrix} 1 & -1 \ -1 & 2 \end{vmatrix} = 2 - 1 = 1$。
       故生成树数量为 1（路径本身即为生成树）。

5. **[代数连通度] 什么是 Fiedler 向量？它在社团检测中有什么用途？**
   ??? success "参考答案"
       Fiedler 向量是对应于 Laplacian 矩阵次小特征值 $\lambda_2$ 的特征向量。由于 $\lambda_2$（代数连通度）反映了图的扩展性，Fiedler 向量的分量符号可以用来将图划分为两个松散耦合的部分（谱聚类）。

6. **[关联矩阵] 证明无向图的 Laplacian 满足 $L = M M^T$，其中 $M$ 是关联矩阵。**
   ??? success "参考答案"
       通过展开 $M M^T$ 的项，可以发现对角元恰好是顶点的度数（与多少条边相连），而非对角元对应于邻接矩阵的负值。这一分解证明了 $L$ 是半正定的。

7. **[正则图] 若 $G$ 是 $k$-正则图，其邻接矩阵 $A$ 的最大特征值是多少？**
   ??? success "参考答案"
       最大特征值为 $k$。对应的特征向量是 $\mathbf{1}$。

8. **[随机游走] 转移矩阵 $P = D^{-1} A$ 的特征值与 Laplacian 的特征值有何联系？**
   ??? success "参考答案"
       $P = I - D^{-1} L$。若 $G$ 是正则图，则 $P = I - \frac{1}{k} L$。其特征值 $\mu_i$ 与 $\lambda_i$ 满足 $\mu_i = 1 - \lambda_i / k$。

9. **[二部图] 证明：一个图是二部图，当且仅当其邻接矩阵的谱关于原点对称。**
   ??? success "参考答案"
       若图是二部图，则 $A$ 可以写为 $\begin{pmatrix} 0 & B \ B^T & 0 \end{pmatrix}$。若 $(\lambda, [u; v])$ 是特征对，则 $(-\lambda, [u; -v])$ 也是。故谱是对称的。

10. **[应用] 为什么在 PageRank 算法中邻接矩阵的转置比原矩阵更重要？**
    ??? success "参考答案"
        因为网页的排名（重要性）是由指向它的链接（In-links）决定的。邻接矩阵的列对应出链，行对应入链。为了计算指向每个页面的权重总和，我们需要操作列和，或者使用转置矩阵的右特征向量。

## 本章小结

图论与线性代数的交汇确立了现代网络科学：

1. **结构编码**：矩阵将非数值的连通关系转化为可计算的线性结构。
2. **谱的指纹**：特征值分布揭示了网络的健壮性、扩展性以及层次结构。
3. **流的代数**：关联矩阵为研究电力网、水网及社交媒体中的信息流提供了守恒定律的表达。
