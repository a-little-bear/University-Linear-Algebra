# 第 24 章 矩阵流形

<div class="context-flow" markdown>

**前置**：矩阵群(Ch55) · 矩阵微积分(Ch47) · 酉矩阵(Ch8) · 最优化(Ch25)

**本章脉络**：微分几何初步（流形、切空间） → 矩阵流形定义 → 常用流形（Stiefel 流形、Grassmann 流形、正定矩阵流形） → 黎曼度量与测地线 → 黎曼梯度与 Hessian → 逆投影 (Retraction) → 流形上的优化算法 → 应用（低秩矩阵补全、独立成分分析 ICA、计算解剖学）

**延伸**：矩阵流形将线性代数带入了弯曲的空间；它为处理具有结构约束（如正交性、秩固定）的优化问题提供了天然的几何框架

</div>

矩阵流形研究具有几何结构的矩阵集合。很多时候，我们的搜索空间不再是平坦的 $\mathbb{R}^{n 	imes n}$，而是如“所有正交矩阵”或“所有秩为 $k$ 的矩阵”这样的弯曲曲面。通过在这些流形上直接进行优化，我们可以自动满足复杂的矩阵约束。

---

## 24.1 核心流形与几何

!!! definition "定义 24.1 (Stiefel 流形)"
    Stiefel 流形 $St(k, n)$ 是所有满足 $U^T U = I_k$ 的 $n 	imes k$ 矩阵构成的集合。它是正交矩阵概念的推广。

!!! definition "定义 24.3 (Grassmann 流形)"
    Grassmann 流形 $Gr(k, n)$ 是 $\mathbb{R}^n$ 中所有 $k$ 维子空间构成的集合。它与 Stiefel 流形不同，因为它将具有相同张成空间的基视为同一个点。

---

## 练习题

1. **[切空间] 求单位圆（$1 	imes 1$ 正交阵）在点 1 处的切空间。**
   ??? success "参考答案"
       条件 $x^2 = 1$。求导得 $2x \dot{x} = 0$。在 $x=1$ 处，$\dot{x}=0$。故切空间是原点。推广到 $O(n)$，在 $I$ 处的切空间是反对称矩阵空间。

2. **[维数计算] 计算 $n 	imes n$ 正交矩阵流形 $O(n)$ 的维数。**
   ??? success "参考答案"
       维数等于其切空间（反对称阵）的维数：$n(n-1)/2$。这代表了旋转一个 $n$ 维物体所需的自由度。

3. **[黎曼梯度] 描述黎曼梯度 $\operatorname{grad} f(X)$ 与欧氏梯度 $
abla f(X)$ 的关系。**
   ??? success "参考答案"
       黎曼梯度是欧氏梯度在流形切空间上的**正交投影**。它确保了搜索方向始终沿着流形表面，而不会“飞出”搜索空间。

4. **[测地线] 什么是测地线？它在流形优化中起什么作用？**
   ??? success "参考答案"
       测地线是流形上连接两点的“最短路径”（推广的直线）。在优化中，测地线定义了步长的更新方向，即 $X_{k+1} = \operatorname{Exp}_{X_k}(\eta)$。

5. **[逆投影] 为什么在实际计算中常用逆投影 (Retraction) 替代指数映射 (Exponential Map)？**
   ??? success "参考答案"
       指数映射涉及精确的测地线计算，通常计算量巨大（如涉及矩阵指数）。逆投影是指数映射的一阶近似，它能以更低的代价将切向量映射回流形，同时保持算法的收敛性。

6. **[正定矩阵流形] 描述正定矩阵空间 $S_n^{++}$ 上的黎曼度量。**
   ??? success "参考答案"
       常用度量为 $\langle \xi, \eta angle_X = \operatorname{tr}(X^{-1} \xi X^{-1} \eta)$。该度量使得正定阵空间成为一个具有负曲率的对称空间，且求逆操作变为等距映射。

7. **[Stiefel vs Grassmann] 若两个矩阵 $U_1, U_2 \in St(k, n)$ 满足 $U_1 = U_2 Q$（$Q$ 为 $k$ 阶旋转阵），它们在 Grassmann 流形上代表同一个点吗？**
   ??? success "参考答案"
       是的。Grassmann 流形关注的是子空间本身，而不是基的选取。由于 $U_1, U_2$ 的列向量张成相同的空间，它们在 $Gr(k, n)$ 中是等价的。

8. **[应用] 矩阵流形如何处理“低秩”约束？**
   ??? success "参考答案"
       固定秩矩阵集合 $\mathcal{M}_r = \{X \in \mathbb{R}^{m 	imes n} : \operatorname{rank}(X) = r\}$ 是一个平滑流形。通过在此流形上定义梯度下降，可以在不显式使用核范数惩罚的情况下实现精确的低秩矩阵补全。

9. **[计算] 写出 $O(n)$ 流形在 $Q$ 处的切空间元素 $\xi$ 满足的方程。**
   ??? success "参考答案"
       由 $Q^T Q = I$ 求导得 $\dot{Q}^T Q + Q^T \dot{Q} = 0$。令 $\xi = \dot{Q}$，则满足 $\xi^T Q + Q^T \xi = 0$。

10. **[黎曼 Hessian] 为什么黎曼 Hessian 比欧氏 Hessian 复杂？**
    ??? success "参考答案"
        因为黎曼 Hessian 必须考虑流形的曲率。计算时涉及 Levi-Civita 联络（协变导数），它捕捉了切平面在移动过程中的旋转。

## 本章小结

矩阵流形是约束优化的几何终点：

1. **结构内化**：将矩阵约束从“外部边界”转化为空间本身的“内部属性”。
2. **曲率智慧**：利用非欧几何度量（如正定阵的仿射不变度量）可以显著提升算法的数值稳定性。
3. **算法统一**：流形优化为解决正交、低秩、辛等约束问题提供了一套统一的微积分框架。
