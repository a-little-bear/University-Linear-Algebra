# 第 07 章 正交性与最小二乘

<div class="context-flow" markdown>

**前置**：内积基础 · 向量空间(Ch4) · 线性方程组(Ch1)

**本章脉络**：内积与范数 → 正交性定义 → 正交基与正交矩阵 → Gram-Schmidt 正交化 → QR 分解 → 正交投影 → 最小二乘法 (Least Squares) → 正规方程组

**延伸**：正交性是数值计算稳定性的保证，也是信号处理（傅里叶变换）的几何灵魂

</div>

正交性为线性空间引入了“角度”和“距离”的概念。在众多的基中，正交基由于其计算上的简洁性和数值稳定性而备受青睐。最小二乘法则是处理现实世界中“无解”方程组的最优策略。

---

## 07.1 正交性与投影

!!! definition "定义 07.1 (正交向量)"
    两个向量 $u, v$ 是正交的，若其内积为零：$\langle u, v \rangle = u^T v = 0$。

!!! theorem "定理 07.5 (正规方程)"
    线性最小二乘问题 $\min \|Ax - b\|^2$ 的最优解满足正规方程：
    $$A^T A \hat{x} = A^T b$$

---

## 练习题

1. **[基础] 验证 $v_1 = (1, 1)^T$ 和 $v_2 = (1, -1)^T$ 是否正交。**
   ??? success "参考答案"
       $v_1 \cdot v_2 = 1(1) + 1(-1) = 1 - 1 = 0$。是的，它们正交。

2. **[单位化] 将向量 $v = (3, 4)^T$ 单位化。**
   ??? success "参考答案"
       范数 $\|v\| = \sqrt{3^2 + 4^2} = 5$。
       单位向量 $u = v/5 = (0.6, 0.8)^T$。

3. **[正交矩阵] 若 $Q$ 是正交矩阵，证明 $\|Qx\| = \|x\|$。**
   ??? success "参考答案"
       $\|Qx\|^2 = (Qx)^T (Qx) = x^T Q^T Q x$。
       由于 $Q$ 是正交阵，$Q^T Q = I$。
       故 $\|Qx\|^2 = x^T I x = x^T x = \|x\|^2$。正交变换保持长度不变。

4. **[投影] 求向量 $b = (1, 2, 3)^T$ 在 $a = (1, 1, 1)^T$ 方向上的投影。**
   ??? success "参考答案"
       投影公式 $p = \frac{a \cdot b}{a \cdot a} a$。
       $a \cdot b = 1+2+3 = 6$；$a \cdot a = 1+1+1 = 3$。
       故 $p = (6/3)a = 2a = (2, 2, 2)^T$。

5. **[Gram-Schmidt] 对 $v_1 = (1, 1, 0), v_2 = (1, 0, 1)$ 进行正交化。**
   ??? success "参考答案"
       1. $u_1 = v_1 = (1, 1, 0)$。
       2. $u_2 = v_2 - \frac{v_2 \cdot u_1}{u_1 \cdot u_1} u_1 = (1, 0, 1) - \frac{1}{2}(1, 1, 0) = (0.5, -0.5, 1)$。
       正交基为 $\{(1, 1, 0), (0.5, -0.5, 1)\}$。

6. **[最小二乘] 已知 $Ax=b$ 无解，其中 $A = \begin{pmatrix} 1 \\ 1 \end{pmatrix}, b = \begin{pmatrix} 1 \\ 3 \end{pmatrix}$。求最小二乘解 $\hat{x}$。**
   ??? success "参考答案"
       正规方程 $A^T A \hat{x} = A^T b$。
       $A^T A = (1, 1) \begin{pmatrix} 1 \\ 1 \end{pmatrix} = 2$。
       $A^T b = (1, 1) \begin{pmatrix} 1 \\ 3 \end{pmatrix} = 4$。
       故 $2\hat{x} = 4 \implies \hat{x} = 2$。

7. **[QR分解初步] 若 $A = QR$，其中 $Q$ 正交，$R$ 上三角。证明 $A^T A = R^T R$。**
   ??? success "参考答案"
       $A^T A = (QR)^T (QR) = R^T Q^T Q R = R^T I R = R^T R$。这展示了 QR 分解在简化正规方程中的作用。

8. **[勾股定理] 证明：若 $u \perp v$，则 $\|u+v\|^2 = \|u\|^2 + \|v\|^2$。**
   ??? success "参考答案"
       $\|u+v\|^2 = (u+v) \cdot (u+v) = u \cdot u + 2(u \cdot v) + v \cdot v$。
       由于 $u \cdot v = 0$，上式化为 $\|u\|^2 + \|v\|^2$。

9. **[正交补] 设 $W$ 是 $\mathbb{R}^3$ 中的 $xy$ 平面，求其正交补 $W^\perp$。**
   ??? success "参考答案"
       $W^\perp$ 是所有与 $xy$ 平面垂直的向量构成的集合，即 $z$ 轴。
       $W^\perp = \{ (0, 0, z)^T : z \in \mathbb{R} \}$。

10. **[误差向量] 证明：最小二乘误差向量 $e = b - A\hat{x}$ 与 $A$ 的列空间正交。**
    ??? success "参考答案"
        $A^T e = A^T(b - A\hat{x}) = A^Tb - A^TA\hat{x}$。
        由正规方程 $A^TA\hat{x} = A^Tb$，故 $A^T e = 0$。
        这意味着 $e$ 与 $A$ 的每一列都正交。

## 本章小结

正交性是线性代数的“垂直”美学：

1. **投影逻辑**：最小二乘法本质上是寻找目标向量在可行子空间上的正交投影。
2. **分解威力**：QR 分解将一般矩阵转化为正交旋转与缩放的组合。
3. **几何度量**：内积确立了空间中的刚性结构，使我们能够量化逼近误差。
