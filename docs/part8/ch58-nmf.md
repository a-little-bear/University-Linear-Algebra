# 第 58 章 非负矩阵分解

<div class="context-flow" markdown>

**前置**：矩阵运算(Ch2) · 奇异值分解(Ch11) · 非负矩阵(Ch17) · 最优化(Ch25)

**本章脉络**：NMF 问题定义 → 与 SVD/PCA 的对比 → 乘性更新规则 (Lee-Seung) → 交替非负最小二乘 (ANLS) → 唯一性条件 → 非负秩 → 稀疏与正则化 NMF → 应用

**延伸**：NMF 是主题模型（文本挖掘）、声源分离（音频处理）和高光谱解混的基本工具

</div>

非负矩阵分解 (NMF) 旨在将非负矩阵 $V \in \mathbb{R}_{\ge 0}^{m \times n}$ 分解为两个非负矩阵 $W \in \mathbb{R}_{\ge 0}^{m \times r}$ 和 $H \in \mathbb{R}_{\ge 0}^{r \times n}$，使得 $V \approx WH$。与 SVD 不同，非负性约束确保了“基于部件”的表示，即数据通过基向量的纯加法组合进行重构，而不涉及减法抵消。

---

## 58.1 问题表述与复杂性

!!! definition "定义 58.1 (NMF)"
    给定 $V \ge 0$ 和秩 $r$，NMF 求解：
    $$\min_{W, H \ge 0} \|V - WH\|_F^2$$
    或其他测度如 Kullback-Leibler (KL) 散度。

!!! theorem "定理 58.1 (复杂性)"
    判定非负矩阵 $V$ 是否具有秩-$r$ 的精确非负分解 $V=WH$ 是 **NP-困难** 的 (Vavasis, 2009)。这与通过 SVD 进行的标准低秩逼近的项式时间可解性形成对比。

---

## 练习题

1. **[部件表示] 从表示逻辑的角度对比 NMF 与 PCA。**
   ??? success "参考答案"
       NMF 约束 $W, H \ge 0$，迫使基向量成为纯加法组件（例如局部特征）。PCA 允许负权重，导致产生“全局”模式，其中局部特征通过全脸特征的减法抵消产生。

2. **[秩关系] 证明对任何非负矩阵 $V$，$\operatorname{rank}(V) \le \operatorname{rank}_+(V)$。**
   ??? success "参考答案"
       设 $\operatorname{rank}_+(V) = r$。根据定义，存在 $W \in \mathbb{R}^{m \times r}$ 和 $H \in \mathbb{R}^{r \times n}$ 使得 $V=WH$。由于 $\operatorname{rank}(V) = \operatorname{rank}(WH) \le \min(\operatorname{rank}(W), \operatorname{rank}(H)) \le r$，线性秩始终由非负秩作为上界。

3. **[计算] 对于 $V = \begin{pmatrix} 1 & 2 \\ 3 & 6 \end{pmatrix}$，提供一个秩-1 的精确 NMF。**
   ??? success "参考答案"
       列向量成比例。令 $W = \begin{pmatrix} 1 \\ 3 \end{pmatrix}$ 且 $H = \begin{pmatrix} 1 & 2 \end{pmatrix}$。则 $WH = V$ 且 $W, H \ge 0$。

4. **[歧义性] 讨论 NMF 中的缩放歧义性。**
   ??? success "参考答案"
       若 $V=WH$，则对任何正对角阵 $D \succ 0$，$V=(WD)(D^{-1}H)$。这意味着只要相应地缩放系数矩阵，我们就可以任意缩放基向量。

5. **[算法] 描述 Lee-Seung 乘性更新规则的核心思想。**
   ??? success "参考答案"
       规则 $H \leftarrow H \odot \frac{W^T V}{W^T WH}$ 派生自带有自适应步长的梯度下降法，该步长确保变量的符号永远不会改变，从而在迭代过程中始终保持非负性（假设初始值为正）。

6. **[非负秩] 提供一个 $4 \times 4$ 例子，使得 $\operatorname{rank}_+(V) > \operatorname{rank}(V)$。**
   ??? success "参考答案"
       矩阵 $V = \begin{pmatrix} 1 & 1 & 0 & 0 \\ 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 0 & 0 & 1 & 1 \end{pmatrix}$ 的线性秩为 3，但非负秩为 4。这种差距反映了非负锥相比线性子空间具有更高的几何复杂度。

7. **[稀疏性] $L_1$ 正则化如何影响 NMF？**
   ??? success "参考答案"
       它会迫使 $H$ 中的许多条目趋于零，确保每个文档或图像仅由少数几个“部件”表示，显著增强了主题或特征的可解释性。

8. **[正交 NMF] 证明带有约束 $HH^T = I$ 的 NMF 等价于 K-means 聚类。**
   ??? success "参考答案"
       $H \ge 0$ 且 $HH^T = I$ 强制 $H$ 的每一列只有一个非零元素。这相当于将数据点划分为不相交的簇，其中 $W$ 的列充当簇中心（质心）。

9. **[应用] 解释主题模型中 $W$ 和 $H$ 的含义。**
   ??? success "参考答案"
       在词-文档矩阵 $V$ 中，$W$ 包含主题（词分布），$H$ 包含文档的主题混合比例（每个文档属于各个主题的程度）。

10. **[凸性] NMF 的目标函数是凸的吗？**
    ??? success "参考答案"
        不是。虽然当 $H$ 固定时对 $W$ 是凸的，反之亦然，但它关于 $(W, H)$ 不是联合凸的。这导致了多个局部极小值以及对初始化的敏感性。

## 本章小结

本章探讨了非负矩阵分解的理论与实践：

1. **表示逻辑**：确立了非负性作为驱动纯加法、基于部件的数据表示的动力。
2. **算法演进**：详述了乘性更新规则与交替非负最小二乘 (ANLS) 框架。
3. **结构性质**：分析了线性秩与非负秩之间的鸿沟，以及唯一性（可分性）的条件。
4. **语义解析**：展示了 NMF 在文本挖掘、音源分离及图像分析中相比传统子空间方法卓越的可解释性。
