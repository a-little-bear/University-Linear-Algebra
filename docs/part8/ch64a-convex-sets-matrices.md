# 第 64A 章 矩阵空间中的凸集

<div class="context-flow" markdown>

**前置**：正定矩阵(Ch16) · 矩阵不等式(Ch18) · 优化基础(Ch25) · 完全正矩阵(Ch45a) · 共正矩阵(Ch45b)

**本章脉络**：矩阵空间维数与迹内积 → PSD 锥 → Birkhoff 多面体 → 相关矩阵集（椭圆体） → 完全正锥与共正锥 → 谱面体 → 分离定理 → S-引理 → Von Neumann 极小极大定理 → SDP 对偶性

**延伸**：矩阵凸集理论是半定规划(SDP)和量子信息论（纠缠判定、量子态空间的凸结构）的数学基础

</div>

凸性是优化理论的核心概念。当凸分析从 $\mathbb{R}^n$ 推广到矩阵空间时，出现了许多具有丰富结构的凸集。半正定锥 $S_n^+$ 是最重要的矩阵凸锥，其自对偶性使得半定规划成为可能。

---

## 64A.1 核心矩阵凸集

!!! definition "定义 64A.3 (半正定锥)"
    $S_n^+ = \{A \in S_n(\mathbb{R}) : A \succeq 0\}$ 是实对称矩阵空间中的闭凸锥。其自对偶性意味着 $\langle A, B \rangle = \operatorname{tr}(AB) \ge 0$ 对所有 $A, B \succeq 0$ 成立。

!!! theorem "定理 64A.6 (Birkhoff 定理)"
    双随机矩阵的集合 $\mathcal{B}_n$ 是以置换矩阵为顶点的凸多面体。

!!! definition "定义 64A.10 (谱面体)"
    谱面体是线性矩阵不等式（LMI）的可行集：$\{x \in \mathbb{R}^d : A_0 + \sum x_i A_i \succeq 0\}$。这是半定规划的研究对象。

---

## 练习题

1. **[基础] 证明 PSD 锥 $S_n^+$ 是凸的。**
   ??? success "参考答案"
       设 $A, B \in S_n^+$，对任意 $t \in [0, 1]$，考虑 $C = tA + (1-t)B$。
       对于任意向量 $x$，有 $x^T C x = t(x^T A x) + (1-t)(x^T B x)$。
       由于 $x^T A x \ge 0$ 且 $x^T B x \ge 0$，且权重 $t, 1-t \ge 0$，故 $x^T C x \ge 0$。
       因此 $C \in S_n^+$，得证。

2. **[迹内积] 计算 $A = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix}$ 和 $B = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$ 的迹内积 $\langle A, B \rangle$。**
   ??? success "参考答案"
       $\langle A, B \rangle = \operatorname{tr}(A^T B) = \operatorname{tr}(AB)$。
       $AB = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix} \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix} = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$。
       故 $\langle A, B \rangle = 2 + 2 = 4$。

3. **[Birkhoff] 写出所有 $2 \times 2$ 的双随机矩阵的一般形式。**
   ??? success "参考答案"
       设 $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$。由行和列和约束：
       $a+b=1, c+d=1, a+c=1, b+d=1$。
       设 $a=t$（$0 \le t \le 1$），则 $b=1-t, c=1-t, d=t$。
       故 $A = \begin{pmatrix} t & 1-t \\ 1-t & t \end{pmatrix}$。

4. **[分离定理] 若 $A$ 对称且有一个特征值为 $-1$，如何找一个 $H \succeq 0$ 使得 $\operatorname{tr}(AH) < 0$？**
   ??? success "参考答案"
       设 $v$ 是特征值 $-1$ 对应的单位特征向量。取 $H = vv^T$。
       则 $H \succeq 0$ 且 $\operatorname{tr}(AH) = \operatorname{tr}(Avv^T) = v^T A v = -1 < 0$。
       物理上，这代表 $H$ 是一个可以检测 $A$ 非正定性的“探针”。

5. **[S-引理] 简述 S-引理（S-procedure）在控制理论中的意义。**
   ??? success "参考答案"
       S-引理允许我们将“在一个二次约束下另一个二次约束成立”的条件，转化为一个统一的线性矩阵不等式（LMI）。这使得非线性系统的稳定性分析可以转化为可计算的凸优化问题。

6. **[谱面体] 判定集合 $\{ (x, y) : \begin{pmatrix} 1+x & y \\ y & 1-x \end{pmatrix} \succeq 0 \}$ 的几何形状。**
   ??? success "参考答案"
       行列式条件：$(1+x)(1-x) - y^2 \ge 0 \implies 1 - x^2 - y^2 \ge 0 \implies x^2 + y^2 \le 1$。
       这是一个圆盘（二维球）。

7. **[对偶性] SDP 的强对偶性在什么条件下成立？**
   ??? success "参考答案"
       通常需要 Slater 条件：即原始问题或对偶问题存在一个严格可行的解（处于锥的内部）。此时原始最优值等于对偶最优值。

8. **[自对偶] 证明 PSD 锥在迹内积下是自对偶的。**
   ??? success "参考答案"
       需证 $B \in (S_n^+)^* \iff B \in S_n^+$。
       已知 $\operatorname{tr}(AB) \ge 0$ 对所有 $A \succeq 0$ 成立。取 $A = xx^T$ 得 $x^T B x \ge 0$，故 $B \succeq 0$。
       反之若 $A, B \succeq 0$，则 $\operatorname{tr}(AB) = \operatorname{tr}(A^{1/2} B A^{1/2}) \ge 0$。

9. **[极小极大] 在矩阵博弈中，Von Neumann 定理保证了什么？**
   ??? success "参考答案"
       保证了混合策略意义下，“最大化最小收益”与“最小化最大损失”是相等的。即每个零和博弈都存在一个平衡值。

10. **[爱因斯坦思考题] 爱因斯坦的广义相对论要求能量动量张量 $T_{\mu\nu}$ 满足各种能量条件（如弱能量条件 $T_{\mu\nu}u^\mu u^\nu \ge 0$）。这些条件实际上是将物理真实的物质分布限制在了一个特定的“矩阵凸锥”内。为什么物理定律往往倾向于用凸性来界定“合理的实在”？**
    ??? success "参考答案"
        凸性意味着“平滑性”与“自洽性”。如果两个物理状态 $A$ 和 $B$ 是可能的，那么它们的叠加态（凸组合）通常也应该是物理上可容许的。这种结构的凸性保证了物理规律在微小波动下的鲁棒性，并且确保了宇宙的宏观状态能够通过简单的能量最小化原则（凸优化）找到唯一的稳定平衡点。如果不满足凸性，宇宙将充斥着多稳态或剧烈的相位突变，难以形成我们观察到的这种稳定、连贯的物理实相。

## 本章小结

本章探讨了矩阵空间几何结构的核心——凸集理论，主要内容包括：

1. **PSD 锥的统治地位**：确立了半正定锥作为矩阵空间中最基础的正则锥，揭示了其自对偶性与极端射线的代数本质。
2. **组合凸集**：通过 Birkhoff 定理建立了双随机矩阵与置换群之间的凸包联系，阐明了离散对称性与连续凸性之间的转换。
3. **几何拓扑与分离**：利用 Hahn-Banach 分离定理为矩阵性质判定（如纠缠见证）提供了理论判据，并介绍了 S-引理作为处理二次约束的强力工具。
4. **计算几何：谱面体**：定义了半定规划的可行域——谱面体，展示了它作为多面体高维推广在现代优化中的重要意义。
5. **博弈与对偶**：通过极小极大定理与 SDP 强对偶性，建立了不同数学领域（博弈论、优化、线性代数）之间深刻的逻辑统一性。
