# 第 59A 章 热带半环与热带矩阵论

<div class="context-flow" markdown>

**前置**：矩阵运算(Ch2) · 特征值(Ch6) · 图论(Ch27) · Perron-Frobenius 定理(Ch17)

**本章脉络**：热带半环 $(\mathbb{R}\cup\{-\infty\}, \max, +)$ → min-plus 变体 → 热带矩阵乘法与加权有向图 → 热带行列式 = 最优指派 → 热带奇异性 → 热带特征值 → 热带 Perron-Frobenius 定理 → Karp 算法 → Kleene 星与收敛 → 路径问题

**延伸**：热带线性代数为最短/最长路径问题、调度优化和离散事件系统提供了统一的代数框架

</div>

热带线性代数研究的是**热带半环**上的线性代数，其中加法被取最大值运算替代，乘法被标准加法替代。这种变换使得某些类别的优化问题线性化，将矩阵运算直接映射到图的路径搜索算法。

---

## 59A.1 热带半环

!!! definition "定义 59A.1 (热带半环)"
    **热带半环** $\mathbb{T} = \mathbb{R} \cup \{-\infty\}$ 配备以下运算：
    - **热带加法**：$a \oplus b = \max(a, b)$
    - **热带乘法**：$a \odot b = a + b$
    加法单位元为 $\mathbb{0} = -\infty$，乘法单位元为 $\mathbb{1} = 0$。

!!! theorem "定理 59A.5 (热带 Perron-Frobenius 定理)"
    若 $A \in \mathbb{T}^{n \times n}$ 是不可约的（强连通），则它具有唯一的热带特征值 $\lambda$，等于其关联加权有向图的**最大环均值**。

---

## 练习题

1. **[基础] 在热带半环中计算 $(2 \oplus 5) \odot (3 \oplus 4)$。**
   ??? success "参考答案"
       $(2 \oplus 5) = \max(2, 5) = 5$。$(3 \oplus 4) = \max(3, 4) = 4$。$5 \odot 4 = 5 + 4 = 9$。

2. **[矩阵乘法] 设 $A = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}, B = \begin{pmatrix} 0 \\ 1 \end{pmatrix}$。计算热带积 $A \odot B$。**
   ??? success "参考答案"
       $(A \odot B)_1 = \max(1+0, 2+1) = \max(1, 3) = 3$。$(A \odot B)_2 = \max(3+0, 4+1) = \max(3, 5) = 5$。故 $A \odot B = \begin{pmatrix} 3 \\ 5 \end{pmatrix}$。

3. **[行列式] 计算 $A = \begin{pmatrix} 3 & 1 \\ 2 & 4 \end{pmatrix}$ 的热带行列式。它是热带奇异的吗？**
   ??? success "参考答案"
       $\operatorname{tdet}(A) = \max(3+4, 1+2) = \max(7, 3) = 7$。由于最大值 7 由唯一的置换（恒等置换）达到，故该矩阵是热带非奇异的。

4. **[特征值] 定义热带特征值及其与图圈的关系。**
   ??? success "参考答案"
       热带特征值 $\lambda$ 满足 $A \odot \mathbf{x} = \lambda \odot \mathbf{x}$。对于强连通图，$\lambda$ 恰好等于图中所有有向圈的权重算术平均值的最大值（即最大环均值）。

5. **[计算] 求 $A = \begin{pmatrix} 2 & 5 \\ 3 & 1 \end{pmatrix}$ 的热带特征值。**
   ??? success "参考答案"
       圈分析：自环 (1,1) 权 2 (均值 2)；自环 (2,2) 权 1 (均值 1)；双向环 (1,2,1) 权 $5+3=8$ (均值 4)。最大环均值为 4，故热带特征值为 $\lambda = 4$。

6. **[Kleene星] 解释图论中 Kleene 星算子 $A^* = I \oplus A \oplus A^{\odot 2} \oplus \dots$ 的含义。**
   ??? success "参考答案"
       $A^*$ 代表全源最长路径矩阵（在 max-plus 意义下）或最短路径矩阵（在 min-plus 意义下）。$(A^*)_{ij}$ 是从顶点 $i$ 到 $j$ 的任意长度路径的最大总权重。

7. **[线性方程组] 对比热带线性方程组 $A \odot \mathbf{x} = \mathbf{b}$ 与经典情形。**
   ??? success "参考答案"
       热带方程很少有精确解。我们通常寻找“最大次解” $\mathbf{x}^* = A \backslash \mathbf{b}$（满足 $A \odot \mathbf{x} \le \mathbf{b}$ 的最大向量）。精确解存在的充要条件是 $A \odot \mathbf{x}^* = \mathbf{b}$。

8. **[调度] 在火车时刻表模型中，热带特征值代表什么？**
   ??? success "参考答案"
       它代表系统的**最小稳定循环周期**。它决定了在不产生连锁延误的情况下，系统能够周期性运行的最高频率。

9. **[秩] 为什么热带矩阵有多种不同的“秩”定义？**
   ??? success "参考答案"
       因为经典代数中行列式秩、行列秩和因子秩的等价性在热带环境下失效。热带秩（基于子行列式）通常小于或等于因子秩（Barvinok 秩）。

10. **[离散事件] 热带线性递推 $x(k+1) = A \odot x(k)$ 如何描述系统动力学？**
    ??? success "参考答案"
        它模拟了状态更新取决于前置任务完成时间的系统。热带特征值给出了稳态增长率（渐近吞吐量），而热带特征向量给出了各组件之间的稳定时间偏移。

## 本章小结

本章将线性代数移植到了幂等的热带半环结构之上：

1. **热带算术**：建立了 $(\max, +)$ 体系，将非线性路径优化转化为线性风格的代数问题。
2. **组合行列式**：证明了热带行列式对应于最优指派问题，将代数与二部图匹配理论挂钩。
3. **谱图论**：揭示了热带特征值为最大环均值，为循环调度系统提供了瓶颈分析。
4. **路径闭包**：利用 Kleene 星在一个统一的代数框架内整合了如 Floyd-Warshall 等路径优化算法。
