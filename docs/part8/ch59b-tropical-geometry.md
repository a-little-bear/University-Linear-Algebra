# 第 59B 章 热带几何及其应用

<div class="context-flow" markdown>

**前置**：热带半环(Ch59A) · 线性方程组(Ch1) · 凸几何(Ch64A) · 图论基础(Ch27)

**本章脉络**：热带超平面 → 热带线性空间 → Amoeba 与热带簇 → Log-Glass 变换 → 热带特征值与 Newton 多面体 → 热带矩阵分解 → 系统发育与热带几何 → 在拍卖理论中的应用

**延伸**：热带几何是代数几何的“组合骨架”；它将多项式方程转化为分片线性的凸多面体复形

</div>

热带几何是研究热带半环上的代数簇的学科。它充当了复代数几何的连续世界与多面体组合学的离散世界之间的桥梁。通过应用“热带化”映射，复杂的曲线被转化为图，高维空间被映射为分片线性复形。

---

## 59B.1 热带超平面与线性空间

!!! definition "定义 59B.1 (热带超平面)"
    由 $L(x) = \bigoplus_{i=1}^n a_i \odot x_i$ 定义的热带超平面是满足 $\max(a_1+x_1, \dots, a_n+x_n)$ 中最大值由**至少两项**达到的点集。这在 $\mathbb{R}^n$ 中创建了一个多面体结构。

!!! theorem "定理 59B.3 (热带几何基本定理)"
    代数簇 $V \subseteq (\mathbb{C}^*)^n$ 的热带化恰好是 $V$ 中点在取对数极值（Valuation）下的分量对数集合。

---

## 练习题

1. **[热带直线] 画出 $\mathbb{R}^2$ 中的热带直线 $L(x, y) = 0 \oplus x \oplus y$。**
   ??? success "参考答案"
       使得 $\max(0, x, y)$ 至少达到两次的集合由从原点出发的三条射线组成：向左上方 ($x=y \ge 0$)，向下 ($x=0 \ge y$)，以及向左下方 ($y=0 \ge x$)。这是一个经典的“热带 Y 字形”。

2. **[矩阵关联] 热带行列式如何与多项式的 Newton 多面体关联？**
   ??? success "参考答案"
       矩阵的热带特征值恰好是其特征多项式的 Newton 多面体下边界的斜率。这建立了离散谱与多项式凸包面几何之间的纽带。

3. **[Amoeba] 定义复代数簇的 Amoeba（变形虫）及其与热带几何的关系。**
   ??? success "参考答案"
       Amoeba 是代数簇在对数绝对值映射 $\mathbb{C}^* \to \mathbb{R}$ 下的像。当对数底数趋于无穷大时，Amoeba 收缩并收敛到其“骨架”，即热带簇。

4. **[发育树] 为什么系统发育树可以被建模为热带 Grassmann 流形中的点？**
   ??? success "参考答案"
       树度规的四点条件（Ch70B）等价于热带 Plücker 关系。因此，所有可能的 $n$ 个分类单元的进化树空间构成了热带 Grassmann 流形 $\operatorname{TrGr}(2, n)$ 内部的一个热带线性空间。

5. **[拍卖理论] 描述热带矩阵乘法如何模拟第一价格拍卖。**
   ??? success "参考答案"
       设 $V_{ij}$ 为投标人 $i$ 对物品 $j$ 的估值。最优分配（总价值最大化）由热带行列式给出。稳定的价格对应于对偶线性规划问题中的热带对偶变量（影子价格）。

6. **[计算] 计算 $2 \odot x \oplus 3 \odot y \oplus 0 = \max(x+2, y+3, 0)$ 定义的热带超平面。其顶点在哪里？**
   ??? success "参考答案"
       顶点位于三项相等处：$x+2 = y+3 = 0 \implies x=-2, y=-3$。射线从 $(-2, -3)$ 出发，方向分别为 $(-1, 0), (0, -1)$ 和 $(1, 1)$。

7. **[热带秩] 对比 Kapranov 秩与热带行列式秩。**
   ??? success "参考答案"
       Kapranov 秩是一个经典矩阵热带化为该热带矩阵所需的最小秩。热带行列式秩基于热带子式的消失。与经典情形不同，这两个定义在热带环境下未必相等。

8. **[线性空间] “热带线性空间”在几何上是什么？**
   ??? success "参考答案"
       它是一个满足热带交换公理的平衡多面体复形。几何上，它看起来像是一组多面体胞腔粘合在一起，且在每个脊（Ridge）处满足定向守恒（平衡条件）。

9. **[Viterbi算法] HMM 中的 Viterbi 算法如何与热带矩阵-向量乘法关联？**
   ??? success "参考答案"
       Viterbi 算法寻找格点图中概率最大的路径。通过取负对数，概率乘积变为求和，最大概率变为最小和。这恰好是 min-plus 半环下的热带乘法运算。

10. **[离散凸性] 解释热带几何与离散优化中 M-凸/L-凸函数的联系。**
    ??? success "参考答案"
        热带线性空间是拟阵（Matroid）的对偶对象。M-凸和 L-凸函数是凸函数的离散模拟，它们在热带意义下表现出“线性”，为贪心算法和离散对偶理论提供了基础。

## 本章小结

本章探讨了代数结构的组合骨架：

1. **骨架化**：定义了热带超平面与热带簇作为代数曲线与曲面的分片线性极限。
2. **谱几何**：将热带特征值与 Newton 多面体联系起来，桥接了代数次数与多面体斜率。
3. **数据度量空间**：将进化树空间表述为热带 Grassmann 流形，统一了演化生物学与离散几何。
4. **优化对偶性**：展示了热带代数在拍卖机制与路径搜索算法中的应用。
