# 第 63B 章 联合谱半径

<div class="context-flow" markdown>

**前置**：谱半径 (Ch14) · 矩阵范数 (Ch15) · 同时三角化 (Ch63A)

**本章脉络**：从单一矩阵到矩阵集合 $\to$ 联合谱半径 (Joint Spectral Radius, JSR) 的定义 $\to$ 集合幂序列的渐近增长率 $\to$ 核心公式：Rota-Strang 恒等式 $\to$ 广义谱半径公式 $\to$ Berger-Wang 定理（与单序列的关系） $\to$ 极大性原理与计算难度 $\to$ 应用：切换线性系统 (Switched Systems) 的稳定性、小波分析的平滑性、离散动力系统的全局吸引子

**延伸**：联合谱半径是衡量“最坏情况”下系统演化速率的指标；它将谱理论从单一轨道扩展到所有可能的路径组合，是研究具有不确定切换逻辑的动力系统的终极数学判据

</div>

在 Ch14 中，我们知道谱半径 $\rho(A)$ 决定了 $A^k$ 的收敛性。但在许多现代应用（如自动驾驶、小波构造）中，系统在每一步都可能从一组矩阵集合 $\{A_1, \ldots, A_m\}$ 中随机或受控地选择一个执行。**联合谱半径**（Joint Spectral Radius, JSR）正是描述这种“最坏路径”下增长率的量。它揭示了即便每一个矩阵单独都是稳定的，它们的任意组合仍可能导致系统爆炸。本章将探讨这一兼具计算挑战与稳定性意义的深刻概念。

---

## 63B.1 联合谱半径的定义

!!! definition "定义 63B.1 (联合谱半径 $\rho(\mathcal{F})$)"
    对于有限矩阵集合 $\mathcal{F} = \{A_1, \ldots, A_m\}$，其**联合谱半径**定义为：
    $$\rho(\mathcal{F}) = \lim_{k \to \infty} \max_{A \in \mathcal{F}^k} \|A\|^{1/k}$$
    其中 $\mathcal{F}^k$ 是所有长度为 $k$ 的矩阵乘积构成的集合。
    **直观理解**：这是在所有可能的切换路径中，平均每步最大的拉伸倍数。

---

## 63B.2 核心定理

!!! theorem "定理 63B.1 (Rota-Strang 恒等式)"
    $$\rho(\mathcal{F}) = \inf_{\|\cdot\|} \max_{A \in \mathcal{F}} \|A\|$$
    其中下确界取自所有算子范数。这意味着 JSR 可以看作某种“最优坐标系”下的最大单步增益。

!!! theorem "定理 63B.2 (Berger-Wang 定理)"
    对于有限集合 $\mathcal{F}$，联合谱半径等于所有乘积的普通谱半径的上限：
    $$\rho(\mathcal{F}) = \limsup_{k \to \infty} \max_{A \in \mathcal{F}^k} \rho(A)^{1/k}$$

---

## 63B.3 稳定性判据

!!! technique "切换系统稳定性"
    切换线性系统 $x_{k+1} = A_{\sigma_k} x_k$ 对任意切换序列 $\sigma_k$ 绝对稳定的充要条件是：
    $$\rho(\{A_1, \ldots, A_m\}) < 1$$

---

## 练习题

**1. [基础] 判定集合 $\mathcal{F} = \{ \begin{pmatrix} 0.5 & 0 \\ 0 & 0 \end{pmatrix}, \begin{pmatrix} 0 & 0 \\ 0 & 0.5 \end{pmatrix} \}$ 的联合谱半径。**

??? success "参考答案"
    **分析：**
    1. 观察到这两个矩阵的乘积总包含零。
    2. 任意乘积 $A_{i_1} \cdots A_{i_k}$ 的范数不会超过 $0.5^k$（若全是同一种）或 0（若混搭）。
    3. 特征值均为 0.5 或 0。
    **结论**：$\rho(\mathcal{F}) = 0.5$。由于谱半径一致，切换不增加增长率。

**2. [陷阱] 举出一个例子说明 $\rho(A_1) < 1$ 且 $\rho(A_2) < 1$，但 $\rho(\{A_1, A_2\}) > 1$。**

??? success "参考答案"
    **构造：**
    取 $A_1 = \begin{pmatrix} 0 & 2 \\ 0 & 0 \end{pmatrix}$， $A_2 = \begin{pmatrix} 0 & 0 \\ 2 & 0 \end{pmatrix}$。
    1. $\rho(A_1) = 0, \rho(A_2) = 0$。单独看，任何幂都是 0。
    2. 考虑乘积 $A_1 A_2 = \begin{pmatrix} 4 & 0 \\ 0 & 0 \end{pmatrix}$。
    3. 特征值为 4。
    4. 乘积序列 $(A_1 A_2)^k$ 的模以 $4^k$ 增长。
    **结论**：$\rho(\{A_1, A_2\}) \ge \sqrt{4} = 2 > 1$。这证明了即使子系统都稳定，不当的切换会导致系统指数爆炸。

**3. [计算] 若 $\mathcal{F} = \{A\}$（只有一个矩阵），联合谱半径等于什么？**

??? success "参考答案"
    **结论：等于普通谱半径 $\rho(A)$。**
    这正是 Gelfand 公式（见 Ch14）的定义。联合谱半径是 Gelfand 公式向集合论的自然推广。

**4. [性质] 证明：$\rho(\mathcal{F}) \le \max_{A \in \mathcal{F}} \|A\|$ 对任何相容矩阵范数成立。**

??? success "参考答案"
    **证明：**
    1. 对于任何乘积 $P = A_{i_1} \cdots A_{i_k}$，由范数次可乘性：
    2. $\|P\| \le \|A_{i_1}\| \cdots \|A_{i_k}\| \le (\max \|A\|)^k$。
    3. 取 $1/k$ 次方并取极限：$\rho(\mathcal{F}) \le \max \|A\|$。

**5. [计算难度] 判定 JSR 的计算复杂度如何？**

??? success "参考答案"
    **结论：极其困难（NP-难，甚至不可判定）。**
    判定 $\rho(\mathcal{F}) \le 1$ 已经被证明是不可判定的。在实践中，通常使用半正定规划（SDP）寻找二次 Lyapunov 函数来获得 JSR 的上界。

**6. [小波] 联合谱半径如何决定小波函数的平滑性？**

??? success "参考答案"
    小波的细分算法（Subdivision Scheme）本质上是一个切换线性系统。小波函数的正则性（可导阶数）直接由对应掩码矩阵集合的联合谱半径决定。JSR 越小，细分过程收敛越快，函数越平滑。

**7. [一致性] 证明：若集合 $\mathcal{F}$ 中的矩阵可以同时三角化，则 $\rho(\mathcal{F}) = \max \rho(A_i)$。**

??? success "参考答案"
    **理由：**
    若能同时三角化，则在同一个基下，乘积矩阵的对角元仅仅是各因子对角元的乘积。
    最大特征值只能来自于各矩阵最大特征值的某种组合。由于它们是交换的（或可解的），不存在像题 2 这种通过非对角元相互增强的情况。

**8. [收敛性] 若 $\rho(\mathcal{F}) = 0.99$，系统是否一定稳定？**

??? success "参考答案"
    **是的。**
    这意味着任何长度为 $k$ 的乘积在足够大时都接近 $0.99^k$，最终会收敛到零。

**9. [极大序列] 什么是“极点循环”（Extremal Cycle）？**

??? success "参考答案"
    如果在集合的乘积中，存在某个有限长度的循环 $A_{i_1} \cdots A_{i_k}$，使得其谱半径恰好达到了联合谱半径的增长率，则称其为极点循环。这代表了系统最危险的切换模式。

**10. [应用] 简述 JSR 在自动驾驶避障中的意义。**

??? success "参考答案"
    自动驾驶控制器在不同路况下会切换不同的控制律。
    为了保证无论环境如何突变，车辆状态始终受控，工程师必须确保所有可能控制律矩阵构成的集合具有小于 1 的联合谱半径。这是保证切换系统鲁棒稳定性的数学金标准。

## 本章小结

联合谱半径是描述不确定动态系统的终极测度：

1.  **最坏情况的预警**：它揭示了系统在动态环境下的生存边界，证明了局部稳定并不等同于全局安全，必须考虑路径间的代数相干性。
2.  **范数与谱的统一**：Rota-Strang 恒等式将复杂的渐近极限转化为静态的范数寻找问题，为数值稳定性评估提供了理论支点。
3.  **计算的科学极限**：JSR 的计算难度标志着线性代数与复杂性理论的交汇，提醒我们在面对具有无限切换可能性的高维系统时，必须依赖于凸松弛等高级优化工具。
