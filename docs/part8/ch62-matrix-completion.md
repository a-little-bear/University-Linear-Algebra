# 第 62 章 矩阵补全问题

<div class="context-flow" markdown>

**前置**：正定矩阵(Ch16) · 奇异值分解(Ch11) · 最优化(Ch25) · 图论(Ch27)

**本章脉络**：一般框架 → 正定补全（弦图条件） → 低秩补全（Netflix 问题） → 核范数最小化 → 精确恢复条件 → 欧氏距离矩阵补全 → 算法 → 含噪声补全 → 矩阵感知

**延伸**：低秩矩阵补全是推荐系统（Netflix, Amazon）和协同过滤的数学基础；正定补全在空间统计和稀疏协方差估计中具有重要作用

</div>

矩阵补全问题要求在给定一个矩阵部分条目的情况下恢复缺失条目，使得补全后的矩阵满足特定性质（如正定性、低秩性或距离度规）。该问题交织了图论、凸优化和随机矩阵理论。

---

## 62.1 框架与准则

!!! definition "定义 62.2 (矩阵补全问题)"
    给定在指标集 $\Omega$ 上条目已知的部分矩阵 $A_\Omega$，寻找 $X$ 使得对所有 $(i,j) \in \Omega$ 都有 $X_{ij} = A_{ij}$，且 $X \in \mathcal{P}$（其中 $\mathcal{P}$ 是某种性质类）。

!!! theorem "定理 62.1 (Grone 定理, 1984)"
    具有给定稀疏模式图 $G$ 的每一个正定部分矩阵都能被补全为正定矩阵，当且仅当 $G$ 是**弦图**。

---

## 练习题

1. **[概念] 为什么 Netflix 推荐问题可以被建模为低秩矩阵补全问题？**
   ??? success "参考答案"
       用户-电影评分矩阵极度稀疏。由于用户的喜好和电影的特征通常受少数隐因子（如类型、导演）影响，完整矩阵近似为低秩的。矩阵补全旨在通过这一低秩约束来预测缺失的评分。

2. **[正定补全] 解释 Grone 定理中“弦图”的意义。**
   ??? success "参考答案"
       弦图保证了局部正定性（在所有团上）能够推导出全局一致性。若图中含有长度 $\ge 4$ 的无弦环，则可以构造出局部主子块均正定、但受限于全局循环约束而无法进行全局正定补全的情形。

3. **[核范数] 定义核范数及其与矩阵秩的关系。**
   ??? success "参考答案"
       核范数 $\|X\|_*$ 是所有奇异值的和。它是矩阵秩函数在单位谱范数球上的凸包（最紧凸下界）。在优化中，我们最小化核范数作为非凸秩最小化问题的凸替代。

4. **[不相干性] 为什么“不相干性”对于矩阵补全的精确恢复至关重要？**
   ??? success "参考答案"
       若矩阵高度相干（如 $e_1 e_1^T$），其信息集中在极少数条目中。随机采样可能会完全漏掉这些条目，导致无法恢复。不相干性确保信息均匀分布在所有条目中，允许通过局部采样进行全局推断。

5. **[计算] 对于一个秩为 10 的 $1000 \times 1000$ 矩阵，计算其自由度。通常需要多少样本？**
   ??? success "参考答案"
       自由度为 $r(m+n-r) = 10(1000+1000-10) = 19,900$。信息论和 Candes-Recht 定理表明，通常需要约 $O(rn \log n)$ 级（此处约为 $10^5$）个样本才能以高概率精确恢复。

6. **[算法] 简述奇异值阈值化（SVT）算法。**
   ??? success "参考答案"
       1. **投影**：在已知条目上计算残差。2. **更新**：根据残差步长更新当前估计。3. **阈值化**：对奇异值应用软阈值算子（即 SVD 后对奇异值进行收缩并清零）。4. **重复**直至收敛。

7. **[EDM] 欧氏距离矩阵 (EDM) 补全与半定规划 (SDP) 有何联系？**
   ??? success "参考答案"
       利用关系 $D_{ij} = G_{ii} + G_{jj} - 2G_{ij}$，补全距离矩阵 $D$ 等价于在满足线性约束的前提下补全一个 Gram 矩阵 $G \succeq 0$。这是传感器网络定位中的标准 SDP 问题。

8. **[噪声] 在含噪声矩阵补全中，误差界 $O(\sigma\sqrt{r/p})$ 意味着什么？**
   ??? success "参考答案"
       它表明恢复误差 (RMSE) 随噪声水平 $\sigma$ 线性增加，并随采样率 $p$ 的平方根倒数减小。这证明了核范数最小化对于含噪观测是稳定的。

9. **[RIP] 对比矩阵 RIP 与逐条目不相干性条件。**
   ??? success "参考答案"
       矩阵受限等距性质 (RIP) 是测量算子的属性，确保其保持低秩矩阵的能量。逐条目采样通常不满足广义 RIP，因此需要额外的不相干性假设来确保信息分布的均匀性。

10. **[最大行列式] 描述正定矩阵的“最大行列式补全”。**
    ??? success "参考答案"
        在弦图部分矩阵的所有正定补全中，存在唯一的最大化行列式的解。该解的特征是其逆矩阵在缺失条目位置处为零，这将其与马尔可夫随机场联系起来。

## 本章小结

本章详述了从局部观测推断全局结构的数学技术：

1. **拓扑约束**：确立了弦图作为保证正定补全存在的图论前提。
2. **凸松弛**：论证了核范数最小化作为低秩恢复的主要工具。
3. **恢复理论**：分析了不相干性与采样密度在确保精确重构中的相互作用。
4. **实用求解器**：引入了 SVT 和交替最小化算法，使其能够处理海量的稀疏数据集。
