# 第 47A 章 矩阵微积分基础

<div class="context-flow" markdown>

**前置**：矩阵基础 (Ch02) · 多元微积分 · Kronecker 积 (Ch19)

**本章脉络**：标量对矩阵的导数（梯度） $\to$ 矩阵对标量的导数 $\to$ 核心导数公式（迹、行列式、逆） $\to$ 链式法则的矩阵形式 $\to$ 换位矩阵 (Commutation Matrix) $K_{mn}$ $\to$ 重复矩阵 (Duplication Matrix) $D_n$ $\to$ 对称性约束下的求导 $\to$ 应用：最小二乘优化、极大似然估计中的梯度下降

**延伸**：矩阵微积分是现代深度学习中反向传播算法的数学底座；它将零散的多元偏导数整合为紧凑的算子形式，使得对复杂模型（如协方差结构）的优化变得可能

</div>

矩阵微积分（Matrix Calculus）是将经典微积分的导数概念扩展到矩阵变量的学科。在处理涉及数千个变量的优化问题（如神经网络训练）时，显式写出每一个偏导数是不现实的。通过矩阵微积分，我们可以将偏导数排列为与原矩阵同构的梯度矩阵，利用简洁的代数符号一次性完成所有变量的求导。

---

## 47A.1 梯度与 Jacobian 矩阵

!!! definition "定义 47A.1 (标量对矩阵的梯度)"
    设 $f(X)$ 是 $m \times n$ 矩阵 $X$ 的标量函数。其梯度定义为与其同阶的矩阵：
    $$\nabla_X f(X) = \frac{\partial f}{\partial X} = \left[ \frac{\partial f}{\partial x_{ij}} \right]$$

!!! definition "定义 47A.2 (矩阵对标量的导数)"
    设 $X(t)$ 是标量 $t$ 的矩阵函数。其导数定义为：
    $$\frac{dX}{dt} = \left[ \frac{dx_{ij}}{dt} \right]$$

---

## 47A.2 核心求导公式

!!! theorem "定理 47A.1 (迹与行列式的导数)"
    1.  **迹的线性性质**：$\nabla_X \operatorname{tr}(AX) = A^T$
    2.  **二次型**：$\nabla_x (\mathbf{x}^T A \mathbf{x}) = (A + A^T) \mathbf{x}$
    3.  **行列式 (Jacobi 公式)**：$\nabla_X \det(X) = \det(X) X^{-T}$
    4.  **对数行列式**：$\nabla_X \ln \det(X) = X^{-T}$
    5.  **逆矩阵**：$\frac{d}{dt} (X^{-1}) = -X^{-1} \frac{dX}{dt} X^{-1}$

---

## 47A.3 特殊结构矩阵

!!! technique "换位矩阵 $K_{mn}$"
    **换位矩阵**（Commutation Matrix）是满足 $\operatorname{vec}(A^T) = K_{mn} \operatorname{vec}(A)$ 的唯一置换矩阵。它在处理涉及转置项的链式法则中起到“索引切换”的作用。

!!! technique "重复矩阵 $D_n$"
    在处理**对称矩阵**求导时，由于变量 $x_{ij} = x_{ji}$ 并非独立，直接求导会产生错误。重复矩阵将独立的下三角元素映射为完整的对称矩阵向量化形式，从而修正梯度。

---

## 练习题

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

****

??? success "参考答案"
    

## 本章小结

矩阵微积分实现了从标量偏导到算子梯度的飞跃：

1.  **符号的紧凑性**：通过梯度矩阵和 Jacobian，复杂的多元变化被浓缩为单一的代数项，极大地简化了高维优化问题的符号推导。
2.  **结构的敏感性**：核心导数公式（如行列式和逆的导数）揭示了矩阵整体性质对局部元素的非线性敏感度，是稳定性分析的基石。
3.  **计算的标准化**：换位矩阵与重复矩阵的引入，为处理矩阵的固有对称性和索引排列提供了标准的代数补偿方案，确保了求导过程的严谨性。
