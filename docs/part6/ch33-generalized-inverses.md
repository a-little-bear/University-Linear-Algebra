# 第 33 章 广义逆

<div class="context-flow" markdown>

**前置**：矩阵基础 (Ch02) · 奇异值分解 (Ch11) · 线性方程组 (Ch01)

**本章脉络**：逆矩阵的局限性 $\to$ Moore-Penrose 逆 ($A^+$) 的定义（四条 Penrose 条件） $\to$ $A^+$ 的存在唯一性 $\to$ 基于 SVD 的计算 $\to$ 最小二乘解与最小范数解 $\to$ Drazin 逆与群逆（处理幂零结构） $\to$ 分块矩阵的广义逆 $\to$ 应用：奇异微分方程组、病态系统求解

**延伸**：广义逆消除了“方阵且满秩”的求逆枷锁，是处理所有线性不确定性（无解或无穷多解）的最终数学审判；它是统计学中线性模型估计（Gauss-Markov 定理）的基石

</div>

在经典矩阵代数中，只有非奇异方阵才有逆。然而，在工程、统计和控制理论中，我们经常遇到长方形或亏秩矩阵。**广义逆**（Generalized Inverse）打破了这一限制，为每一个矩阵都定义了某种意义上的“逆”。其中最著名的 Moore-Penrose 逆，在解的最小化性质方面具有完美的表现。

---

## 33.1 Moore-Penrose 广义逆 $A^+$

!!! definition "定义 33.1 (Penrose 四条件)"
    对于矩阵 $A \in M_{m \times n}(\mathbb{C})$，其 **Moore-Penrose 逆** 是指满足以下四个条件的唯一矩阵 $A^+$：
    1.  $AA^+A = A$ （内部一致性）
    2.  $A^+AA^+ = A^+$ （外部一致性）
    3.  $(AA^+)^* = AA^+$ （左对称性）
    4.  $(A^+A)^* = A^+A$ （右对称性）

!!! theorem "定理 33.1 (存在唯一性)"
    对于任何矩阵 $A$，满足上述四个条件的 $A^+$ **存在且唯一**。

---

## 33.2 计算与最小二乘性质

!!! technique "计算：基于 SVD"
    若 $A = U \Sigma V^*$，则 $A^+ = V \Sigma^+ U^*$。其中 $\Sigma^+$ 是将 $\Sigma$ 的非零对角元取倒数后转置得到的。

!!! theorem "定理 33.2 (最佳逼近性质)"
    对于线性方程组 $Ax = b$：
    1.  向量 $\hat{x} = A^+ b$ 是使得 $\|Ax - b\|_2$ 达到最小的解（最小二乘解）。
    2.  在所有最小二乘解中，$\hat{x} = A^+ b$ 的范数 $\|\hat{x}\|_2$ 是最小的（最小范数解）。

---

## 33.3 Drazin 逆

!!! definition "定义 33.2 (Drazin 逆)"
    对于方阵 $A$，**Drazin 逆** $A^D$ 满足：
    1.  $A^k A^D A = A^k$ （$k$ 为 $A$ 的指数，即使 $\operatorname{rank}(A^k)$ 稳定的最小幂）
    2.  $A^D A A^D = A^D$
    3.  $AA^D = A^D A$
    **应用**：Drazin 逆在处理奇异微分方程和马尔可夫链的收敛性分析中非常有效。

---

## 练习题

1. **[计算] 求 $A = \begin{pmatrix} 2 & 0 \\ 0 & 0 \end{pmatrix}$ 的 Moore-Penrose 逆。**
   ??? success "参考答案"
       $A^+ = \begin{pmatrix} 0.5 & 0 \\ 0 & 0 \end{pmatrix}$。验证四个条件：$AA^+ = \operatorname{diag}(1, 0)$，对称且满足定义。

2. **[列满秩] 若 $A$ 是列满秩的，证明 $A^+ = (A^* A)^{-1} A^*$。**
   ??? success "参考答案"
       代入 Penrose 四条件验证。例如 $A^+ A = (A^* A)^{-1} A^* A = I$，显然对称且满足性质。

3. **[性质] 证明 $(A^+)^+ = A$。**
   ??? success "参考答案"
       由于 $A$ 满足 $A^+$ 的四个 Penrose 条件（角色互换），且 $A^{++}$ 唯一，故相等。

4. **[秩] 证明 $\operatorname{rank}(A^+) = \operatorname{rank}(A)$。**
   ??? success "参考答案"
       由 $AA^+A=A$ 知 $\operatorname{rank}(A) \le \operatorname{rank}(A^+)$；由 $A^+AA^+=A^+$ 知 $\operatorname{rank}(A^+) \le \operatorname{rank}(A)$。

5. **[投影] $AA^+$ 几何上代表什么？**
   ??? success "参考答案"
       它代表到 $A$ 的列空间 $C(A)$ 的正交投影矩阵。

6. **[最小二乘] 若 $Ax=b$ 有解，证明 $x = A^+ b$ 是其中一个解。**
   ??? success "参考答案"
       若有解，则 $b \in C(A)$。$A(A^+ b) = (AA^+)b = b$（投影到所在空间保持不变）。

7. **[群逆] 什么是群逆（Group Inverse）？**
   ??? success "参考答案"
       群逆是指数 $k=1$ 时的 Drazin 逆。它满足 $AA^{\#}A = A, A^{\#}AA^{\#} = A^{\#}$ 且 $AA^{\#} = A^{\#}A$。

8. **[奇异值] 矩阵 $A$ 的奇异值为 $2, 1, 0$。求 $A^+$ 的奇异值。**
   ??? success "参考答案"
       $1/2, 1, 0$。

9. **[不变量] 证明 $(A^*)^+ = (A^+)^*$。**
   ??? success "参考答案"
       对 $A^*$ 和 $(A^+)^*$ 验证 Penrose 条件即可。

10. **[应用] 为什么在求逆时 $A^+$ 包含转置项？**
    ??? success "参考答案"
        转置项（或共轭转置）负责将输出空间的残差投影回输入空间，这是实现“最小范数”和“正交性”的关键机制。

## 本章小结

广义逆是处理线性病态性的最终解药：

1.  **逆的泛化**：Moore-Penrose 逆通过四条对称的一致性公理，为所有线性算子找到了唯一的、性质最优的“伪逆”，统一了可逆与不可逆的理论。
2.  **最优性标准**：它在最小二乘和最小范数方面的双重优化特性，使其成为解决矛盾系统和不确定系统的标准数学工具。
3.  **结构的深度**：Drazin 逆和群逆的引入展示了如何利用广义逆处理矩阵的幂零部分和复杂的索引结构，为分析奇异动力系统提供了代数杠杆。
