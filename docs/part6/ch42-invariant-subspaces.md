# 第 42 章 不变子空间与扰动

<div class="context-flow" markdown>

**前置**：特征值 (Ch06) · 矩阵范数与扰动 (Ch15) · 矩阵方程 (Ch20)

**本章脉络**：不变子空间的定义 $\to$ 块三角形化与子空间表示 $\to$ 子空间之间的距离（Gap 测度） $\to$ 不变子空间的稳定性 $\to$ 核心公式：Sylvester 方程与扰动界限 $\to$ Riccati 方程在子空间偏移估计中的作用 $\to$ 特征值的灵敏度与特征向量的夹角 $\to$ 应用：模型降阶 (Model Order Reduction)、控制理论中的解耦、数值特征值算法（QR 算法）的收敛性

**延伸**：如果说第 15 章关注的是单个特征值的扰动，那么本章关注的是整个“方向集”（子空间）的稳定性；它揭示了当算子发生变化时，系统能够保持其关键动力学特征的能力，是现代稳健控制的基础

</div>

在线性代数的高级应用中，我们不仅关心单个特征值，更关心由一组特征向量张成的**不变子空间**（Invariant Subspaces）。例如，在模型降阶中，我们希望保留系统最关键的模态。然而，当矩阵受到扰动时，这些子空间会发生“漂移”。本章将确立量化这种漂移的数学测度，并探讨为什么某些子空间在干扰下比其他子空间更稳定。

---

## 42.1 不变子空间与分块结构

!!! definition "定义 42.1 (不变子空间)"
    子空间 $\mathcal{X} \subseteq V$ 称为 $A$ 的**不变子空间**，如果对于任何 $x \in \mathcal{X}$，都有 $Ax \in \mathcal{X}$。
    **矩阵表现**：在合适的基下， $A$ 呈现分块上三角形式：
    $$A = \begin{pmatrix} A_{11} & A_{12} \\ 0 & A_{22} \end{pmatrix}$$
    此时 $A_{11}$ 刻画了子空间内部的动态。

---

## 42.2 子空间距离与稳定性

!!! definition "定义 42.2 (Gap 测度)"
    两个子空间 $\mathcal{X}, \mathcal{Y}$ 之间的距离通常由其对应的正交投影算子 $P_{\mathcal{X}}, P_{\mathcal{Y}}$ 衡量：
    $$\operatorname{dist}(\mathcal{X}, \mathcal{Y}) = \|P_{\mathcal{X}} - P_{\mathcal{Y}}\|_2$$

!!! theorem "定理 42.1 (Stewart 扰动界限)"
    设 $A$ 的不变子空间 $\mathcal{X}$ 对应于块 $A_{11}$。若 $A$ 受到扰动 $E$，则扰动后的子空间 $\mathcal{X}'$ 的偏移程度取决于 $A_{11}$ 与 $A_{22}$ 之间的“距离”：
    $$\operatorname{sep}(A_{11}, A_{22}) = \inf_{\|X\|=1} \|A_{11}X - X A_{22}\|$$
    **结论**：谱间隔越小，子空间对扰动越敏感。

---

## 42.3 灵敏度分析

!!! technique "特征值灵敏度"
    对于简单特征值 $\lambda$，其扰动 $\Delta \lambda$ 近似为 $w^* E v / (w^* v)$，其中 $v, w$ 是左右特征向量。
    因子 $1/|w^* v|$ 称为特征值的**条件数**。

---

## 练习题

**1. [基础] 判定 $\mathbb{R}^2$ 中由 $(1, 0)^T$ 张成的子空间是否是 $A = \begin{pmatrix} 2 & 1 \\ 0 & 3 \end{pmatrix}$ 的不变子空间。**

??? success "参考答案"
    **验证步骤：**
    1. 取子空间中的一般向量 $x = (k, 0)^T$。
    2. 计算 $Ax = \begin{pmatrix} 2 & 1 \\ 0 & 3 \end{pmatrix} \begin{pmatrix} k \\ 0 \end{pmatrix} = \begin{pmatrix} 2k \\ 0 \end{pmatrix}$。
    3. 结果仍然只有第一个分量非零，属于原子空间。
    **结论**：是的，它是一个不变子空间。

**2. [性质] 证明：若 $\lambda$ 是 $A$ 的特征值，则其特征空间 $E_\lambda$ 是 $A$ 的不变子空间。**

??? success "参考答案"
    **证明：**
    1. 设 $v \in E_\lambda$，则 $Av = \lambda v$。
    2. 由于 $\lambda v$ 只是 $v$ 的一个缩放，它显然仍在 $E_\lambda$ 中。
    3. 因此 $A(E_\lambda) \subseteq E_\lambda$。

**3. [计算] 对于 $A = \begin{pmatrix} 1 & 0 \\ 0 & 1.01 \end{pmatrix}$，计算 $A_{11}=1$ 与 $A_{22}=1.01$ 的分离度 $\operatorname{sep}$。**

??? success "参考答案"
    **计算：**
    1. 对于标量情况，$\operatorname{sep}(a, b) = |a - b|$。
    2. $\operatorname{sep} = |1 - 1.01| = 0.01$。
    **意义**：由于分离度很小，哪怕极小的扰动 $E = \begin{pmatrix} 0 & \epsilon \\ \epsilon & 0 \end{pmatrix}$ 也会导致特征向量发生剧烈的方向旋转。

**4. [特征向量] 为什么正规矩阵的子空间通常比非正规矩阵更稳定？**

??? success "参考答案"
    **分析：**
    1. 对于正规矩阵，左右特征向量相同，$|w^* v| = \|v\|^2 = 1$。
    2. 特征值条件数始终为 1。
    3. 在子空间层面，正规矩阵的不变子空间是正交的，最大限度地增大了块之间的分离度（在酉等价意义下）。

**5. [Gap] 若两个子空间重合，其 Gap 距离是多少？若它们正交呢？**

??? success "参考答案"
    **结论：**
    1. 重合：距离为 0。
    2. 正交：距离为 1（针对 2-范数）。

**6. [Riccati] 不变子空间的偏移与什么矩阵方程有关？**

??? success "参考答案"
    **结论：**
    与**非线性代数 Riccati 方程**有关。
    在推导子空间扰动界限时，我们将基向量的偏移量 $P$ 表示为满足一个二次项方程的根。当扰动较小时，可以通过忽略二次项将其简化为线性 Sylvester 方程。

**7. [应用] 简述“特征值聚类”（Cluster）在扰动理论中的意义。**

??? success "参考答案"
    如果一组特征值彼此非常接近，但与其他特征值离得很远，那么由这组特征值张成的**总子空间**是非常稳定的，即使这组内部的单个特征向量可能极不稳定。这在模型降阶中是保留“慢模态”的关键。

**8. [计算] 若 $A$ 有两个特征值 10 和 0.1。由于舍入误差，矩阵变为 $A+E$ 使得特征值变为 10.001 和 0.099。评价子空间的稳定性。**

??? success "参考答案"
    **评价：**
    由于 $\operatorname{sep}(10, 0.1) \approx 9.9$ 很大，子空间的偏移会非常小（约正比于 $\|E\|/9.9$）。这是一个非常稳定的子空间配置。

**9. [交集] 证明：两个不变子空间的交集仍是不变子空间。**

??? success "参考答案"
    **证明：**
    1. 设 $x \in \mathcal{X} \cap \mathcal{Y}$。
    2. 则 $x \in \mathcal{X}$ 且 $x \in \mathcal{Y}$。
    3. 由不变性，$Ax \in \mathcal{X}$ 且 $Ax \in \mathcal{Y}$。
    4. 故 $Ax \in \mathcal{X} \cap \mathcal{Y}$。

**10. [应用] 为什么在数值计算中计算“准三角阵”（Schur 形）比直接计算特征向量基更稳健？**

??? success "参考答案"
    **理由：**
    特征向量基（特别是对于非正规矩阵）可能非常接近线性相关，导致矩阵 $V$ 的条件数极大。而 Schur 形采用酉变换（$Q$ 的条件数为 1），始终保持数值稳定性，且通过对角块揭示了不变子空间的层级结构。

## 本章小结

不变子空间扰动理论是线性系统结构的“压力测试”：

1.  **方向的惯性**：它证明了线性系统的核心演化方向不仅由算子本身定义，更受到谱分布间隙（Separation）的严密保护。
2.  **解耦的稳健性**：子空间稳定性是判断一个复杂系统是否能够被安全地拆分为多个低维子系统的判据，为工业级模型降阶提供了精度保障。
3.  **几何的度量**：通过 Gap 测度和算子方程，本章将直观的“方向偏离”转化为严密的代数不等式，确立了数值特征值分析的可靠性边界。
