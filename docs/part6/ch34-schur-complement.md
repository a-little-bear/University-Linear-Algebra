# 第 34 章 Schur 补

<div class="context-flow" markdown>

**前置**：矩阵基础 (Ch02) · 正定矩阵 (Ch16) · 行列式 (Ch03)

**本章脉络**：分块矩阵的消元动机 $\to$ Schur 补的定义 $\to$ 行列式分解公式 $\to$ 逆矩阵的分块公式（Banachiewicz 公式） $\to$ 正定性判定准则 $\to$ 惯性加性公式（Haynsworth） $\to$ 矩阵方程中的应用 $\to$ 统计学意义（偏相关与条件方差）

**延伸**：Schur 补是分块矩阵计算的“手术刀”；它不仅是大型线性方程组分治求解的核心，也是理解现代概率论中高斯过程与核方法的数学钥匙

</div>

在处理大规模系统时，我们通常将矩阵划分为子块。**Schur 补**（Schur Complement）正是通过局部消元得到的关键中间结构。它不仅给出了分块矩阵行列式与逆的显式表达，还深刻揭示了矩阵各部分之间的相关性。本章将展示这一强大的降维工具。

---

## 34.1 定义与行列式公式

!!! definition "定义 34.1 (Schur 补)"
    设分块矩阵 $M = \begin{pmatrix} A & B \\ C & D \end{pmatrix}$。若 $A$ 可逆，则 $D$ 关于 $A$ 的 **Schur 补** 定义为：
    $$S = D - C A^{-1} B$$

!!! theorem "定理 34.1 (行列式分解公式)"
    分块矩阵 $M$ 的行列式可以分解为：
    $$\det(M) = \det(A) \det(D - C A^{-1} B)$$
    这说明整个系统的“体积”等于左上角子系统的体积乘以其 Schur 补的体积。

---

## 34.2 逆矩阵的分块公式

!!! technique "技术：Banachiewicz 公式"
    若 $A$ 和 Schur 补 $S$ 均可逆，则 $M$ 的逆矩阵为：
    $$M^{-1} = \begin{pmatrix} A^{-1} + A^{-1} B S^{-1} C A^{-1} & -A^{-1} B S^{-1} \\ -S^{-1} C A^{-1} & S^{-1} \end{pmatrix}$$
    这是求解结构化大系统的数值基石。

---

## 34.3 正定性与惯性

!!! theorem "定理 34.2 (正定性判据)"
    设 $M = \begin{pmatrix} A & B \\ B^T & C \end{pmatrix}$ 为对称阵。则：
    $$M \succ 0 \iff A \succ 0 \text{ 且 } C - B^T A^{-1} B \succ 0$$

!!! theorem "定理 34.3 (Haynsworth 惯性公式)"
    矩阵 $M$ 的正、负特征值个数（惯性）等于 $A$ 的惯性与 Schur 补 $S$ 的惯性之和：
    $$\operatorname{In}(M) = \operatorname{In}(A) + \operatorname{In}(S)$$

---

## 练习题

**1. [计算] 计算 $\begin{pmatrix} 1 & 2 \\ 2 & 5 \end{pmatrix}$ 的 Schur 补（关于 $A=1$）。**

??? success "参考答案"
    **步骤：**
    1. 识别子块：$A = 1, B = 2, C = 2, D = 5$。
    2. 套用公式：$S = D - C A^{-1} B = 5 - (2)(1)^{-1}(2)$。
    3. 计算：$5 - 4 = 1$。
    **结论**：Schur 补为 1。

**2. [行列式] 利用 Schur 补计算上题中矩阵的行列式。**

??? success "参考答案"
    **计算：**
    1. $\det(A) = 1$。
    2. $S = 1$。
    3. $\det(M) = \det(A)\det(S) = 1 \cdot 1 = 1$。
    验证：直接计算 $1\cdot 5 - 2\cdot 2 = 1$。结果一致。

**3. [性质] 若 $B=0$（分块下三角）， $M$ 的 Schur 补是什么？**

??? success "参考答案"
    **推导：**
    $S = D - C A^{-1} (0) = D$。
    **直观理解**：当子块解耦时，Schur 补退化为原有的对角块。

**4. [对称性] 证明：若 $M$ 是对称的，其 Schur 补也是对称的。**

??? success "参考答案"
    **证明：**
    1. $M$ 对称意味着 $D$ 对称，$A$ 对称，且 $C = B^T$。
    2. $S = D - B^T A^{-1} B$。
    3. 取转置：$S^T = D^T - (B^T A^{-1} B)^T = D - B^T (A^{-1})^T (B^T)^T$。
    4. 利用 $A^{-1}$ 的对称性：$= D - B^T A^{-1} B = S$。
    **结论**：Schur 补操作保持了矩阵的对称性。

**5. [秩] 证明 $\operatorname{rank}(M) = \operatorname{rank}(A) + \operatorname{rank}(S)$。**

??? success "参考答案"
    **证明：**
    1. 利用分块消元矩阵 $E = \begin{pmatrix} I & 0 \\ -CA^{-1} & I \end{pmatrix}$。
    2. $E M = \begin{pmatrix} A & B \\ 0 & S \end{pmatrix}$。
    3. 由于 $E$ 是非奇异的， $\operatorname{rank}(M) = \operatorname{rank}(EM)$。
    4. 对分块上三角阵，由于 $A$ 可逆，其秩等于 $A$ 的阶数加上 $S$ 的秩。

**6. [统计] 在多元正态分布中，$M$ 是协方差矩阵，Schur 补 $S$ 代表什么？**

??? success "参考答案"
    **统计意义：**
    Schur 补 $S$ 恰好代表了**条件协方差**。
    例如，如果变量分为 $X_1$ 和 $X_2$，则在给定 $X_1$ 的观测值后，$X_2$ 的剩余波动程度（方差）正是由协方差矩阵关于 $X_1$ 块的 Schur 补给出的。

**7. [G-S] 写出 $A$ 关于 $D$ 的 Schur 补（假设 $D$ 可逆）。**

??? success "参考答案"
    **公式：**
    $S_{left} = A - B D^{-1} C$。
    这是消元顺序相反时的结果（即从右下角向上消元）。

**8. [稳定性] 若 $M$ 是正定的，$A$ 和 $S$ 有什么性质？**

??? success "参考答案"
    **结论：**
    根据定理 34.2，如果 $M \succ 0$，那么其子系统 $A$ 和余项 $S$ 都必须是**严格正定**的。这反映了全局稳定性对局部成分的遗传性。

**9. [求逆] 若 $M$ 是分块对角矩阵（$B=0, C=0$），求其逆的分块形式。**

??? success "参考答案"
    **结论：**
    $\begin{pmatrix} A^{-1} & 0 \\ 0 & D^{-1} \end{pmatrix}$。
    此时 Schur 补 $S = D$，Banachiewicz 公式简化为简单的分块求逆。

**10. [控制应用] 在求解代数 Riccati 方程时，为什么经常出现 $D - C A^{-1} B$ 的形式？**

??? success "参考答案"
    **理由：**
    最优控制涉及对“系统状态”和“控制输入”的耦合优化。为了消去控制变量 $u$ 对总能量的贡献，数学上必须对 Hessian 分块矩阵进行局部消元，这产生的结果正是关于反馈增益的 Schur 补项。

## 本章小结

Schur 补是分块代数的核心语法：

1.  **维度的折叠**：它展示了如何通过局部的可逆信息，将高维系统的复杂性压缩到低维的余项中，是分布式算法的数学前提。
2.  **正性的传递**：Schur 补公式确立了分块矩阵全局稳定性与其子系统局部稳定性及交互项之间的定量联系。
3.  **统计的纽带**：在概率论中，Schur 补揭示了高斯分布在条件化过程中的代数本质，是处理变量间“剩余相关性”的终极工具。
