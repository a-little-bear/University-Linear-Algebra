# 第 39 章 全正矩阵

<div class="context-flow" markdown>

**前置**：行列式 (Ch03) · 正定矩阵 (Ch16) · 矩阵分析 (Ch14)

**本章脉络**：全非负 (TN) 与全正 (TP) 矩阵定义（所有子式非负/正） $\to$ 典型实例（Vandermonde, Cauchy, Pascal 矩阵） $\to$ 核心结构：双对角分解 (Bidiagonal Factorization) $\to$ 谱性质：特征值的实性、正性与互异性 $\to$ 变号减小性质 (Variation-Diminishing Property) $\to$ 振荡矩阵 (Oscillatory Matrices) $\to$ 应用：样条函数逼近、统计学（对数凹密度）、组合数学

**延伸**：全正性是比正定性更苛刻的约束；它要求矩阵的每一个“细节”（子式）都具备正性，揭示了算子在保持数据单调性和平滑性方面的极高天赋，是连接连续分析与离散组合的桥梁

</div>

如果说正定矩阵要求二次型为正，那么**全正矩阵**（Totally Positive Matrix）则要求得更多：它的每一个子式（不仅仅是主子式）都必须是非负的。这种极端的结构约束赋予了全正矩阵一系列令人惊叹的性质，如特征值全为正且互不相同，以及能够减小向量的变号次数。本章将深入这一兼具代数美感与组合深度的领域。

---

## 39.1 定义与经典实例

!!! definition "定义 39.1 (全非负与全正矩阵)"
    矩阵 $A \in M_{m \times n}(\mathbb{R})$ 称为：
    1.  **全非负 (TN)**：若 $A$ 的所有子式（任何阶数的子矩阵的行列式）均 $\ge 0$。
    2.  **全正 (TP)**：若 $A$ 的所有子式均 $> 0$。

!!! example "例 39.1 (典型全正矩阵)"
    1.  **Vandermonde 矩阵**：当节点 $0 < x_1 < x_2 < \cdots < x_n$ 时，其全正性源于多项式的单调性。
    2.  **Cauchy 矩阵**：条目 $a_{ij} = 1/(x_i + y_j)$ 在特定节点下是 TP 阵。
    3.  **Pascal 矩阵**：由组合数构成的矩阵是全非负的。

---

## 39.2 核心性质：变号减小 (VDP)

!!! theorem "定理 39.1 (变号减小性质)"
    设 $A$ 为全非负矩阵。若向量 $\mathbf{y} = A\mathbf{x}$，则 $\mathbf{y}$ 的分量变号次数不会超过 $\mathbf{x}$ 的分量变号次数：
    $$V(A\mathbf{x}) \le V(\mathbf{x})$$
    **物理意义**：全非负矩阵作为线性算子，具有极强的“平滑”作用，能够抑制信号的震荡。

---

## 39.3 谱性质与双对角分解

!!! theorem "定理 39.2 (TP 矩阵的谱)"
    若 $A$ 是 $n \times n$ 全正矩阵，则其特征值 $\lambda_1, \lambda_2, \ldots, \lambda_n$ 满足：
    $$\lambda_1 > \lambda_2 > \cdots > \lambda_n > 0$$
    **结论**：特征值全为**正实数**且**严格互异**。

!!! technique "技术：双对角分解"
    每一个非奇异的 TN 矩阵都可以分解为一系列简单的非负双对角矩阵的乘积。这证明了全正性可以通过相邻元素的局部正性组合来生成。

---

## 练习题

**1. [判定] 判定 $\begin{pmatrix} 1 & 1 \\ 1 & 2 \end{pmatrix}$ 是否为全正矩阵。**

??? success "参考答案"
    **检查所有子式：**
    1. $1 \times 1$ 子式：$1, 1, 1, 2$。全为正。
    2. $2 \times 2$ 子式：$\det = 1 \cdot 2 - 1 \cdot 1 = 1 > 0$。
    **结论**：由于所有子式均为正，它是全正 (TP) 矩阵。

**2. [反例] 若一个矩阵是对称正定的，它一定是全正的吗？**

??? success "参考答案"
    **结论：不一定。**
    **反例**：$A = \begin{pmatrix} 2 & 1.5 \\ 1.5 & 2 \end{pmatrix}$。
    虽然正定，但考虑其 $2 \times 2$ 子式均满足要求。然而若矩阵维数更高，例如存在负元素，则虽然主子式为正（正定），但包含该负元素的 $1 \times 1$ 子式为负，违反全正性。全正性要求**所有**子式为正，包括非主子式。

**3. [VDP] 向量 $\mathbf{x} = (1, -1, 1)^T$ 的变号次数是多少？**

??? success "参考答案"
    **计数：**
    1. 从 1 到 -1：第 1 次变号。
    2. 从 -1 到 1：第 2 次变号。
    **结论**：变号次数 $V(\mathbf{x}) = 2$。

**4. [性质] 证明：若 $A$ 是 TP 矩阵，则其转置 $A^T$ 也是 TP 矩阵。**

??? success "参考答案"
    **证明：**
    1. $A^T$ 的子式是 $A$ 的对应子矩阵转置后的行列式。
    2. 矩阵转置不改变行列式的值。
    3. 既然 $A$ 的所有子式为正， $A^T$ 的所有子式也必为正。

**5. [特征值] 若 $A$ 是 $3 \times 3$ 全正矩阵，其特征值可能为 $\{4, 4, 1\}$ 吗？**

??? success "参考答案"
    **结论：不可能。**
    **理由**：根据 TP 矩阵的谱性质，特征值必须是严格互异的单根。重根的存在意味着矩阵在某种程度上具有简并性，这与全正性的严格约束矛盾。

**6. [Pascal] 写出 $2 \times 2$ 的下三角 Pascal 矩阵并验证 TN 性。**

??? success "参考答案"
    **构造：**
    $L = \begin{pmatrix} 1 & 0 \\ 1 & 1 \end{pmatrix}$。
    **子式检查**：$1, 0, 1, 1 \ge 0$ 且 $\det=1 \ge 0$。
    **结论**：它是全非负 (TN) 矩阵。

**7. [乘积] 两个 TN 矩阵的乘积还是 TN 矩阵吗？**

??? success "参考答案"
    **结论：是的。**
    **证明要点**：利用 **Binet-Cauchy 公式**。乘积矩阵的 $k$ 阶子式等于因子矩阵 $k$ 阶子式的某种加权组合。由于所有因子子式均非负，加权和也必非负。

**8. [振荡矩阵] 什么是振荡矩阵？它与 TN 矩阵有什么关系？**

??? success "参考答案"
    **定义**：一个 TN 矩阵 $A$ 称为振荡矩阵，如果存在某个正整数 $k$ 使得 $A^k$ 是全正的 (TP)。
    **判定**：不可约的 TN 矩阵且对角元严格为正，通常就是振荡矩阵。

**9. [应用] 为什么样条插值（Splines）中使用全正矩阵？**

??? success "参考答案"
    **核心理由：**
    全正矩阵的变号减小性质（VDP）保证了插值曲线不会在数据点之间产生不必要的震荡。它确保了函数的局部单调性能被代数算子完美保持。

**10. [极限] 随着矩阵阶数 $n \to \infty$，全正矩阵的条件数通常表现如何？**

??? success "参考答案"
    **数值特征：**
    全正矩阵通常是**极度病态**的。
    由于特征值之间存在严格的衰减链 $\lambda_1 > \lambda_2 > \cdots$，对于许多经典实例（如 Hilbert 阵），最小特征值会迅速趋于 0，导致条件数爆炸。

## 本章小结

全正矩阵是线性代数中最具“秩序感”的一类算子：

1.  **全局的正性**：它要求每一个局部的行列式细节都指向正方向，这种苛刻的约束导致了全局谱结构的极端稳定。
2.  **平滑的守卫**：变号减小性质证明了全正矩阵在本质上是“抗震荡”的，是样条理论和逼近论的数学基石。
3.  **组合的美学**：通过双对角分解，全正矩阵将复杂的行列式关系简化为简单的相邻元素交互，架起了连续分析与离散组合数学之间的桥梁。
