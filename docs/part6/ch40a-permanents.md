# 第 40A 章 永久式与 Van der Waerden 猜想

<div class="context-flow" markdown>

**前置**：行列式(Ch3) · 组合矩阵结构(Ch65B) · 双随机矩阵(Ch64A)

**本章脉络**：永久式定义 → 与行列式的对比 → 永久式与匹配理论 → 永久式的性质 → Van der Waerden 猜想 → Egorychev-Falikman 定理 (永久式的最小值) → 上界估计 (Minc 猜想) → 计算复杂度 (#P-完全) → 非负矩阵的永久式

</div>

矩阵的**永久式** (Permanent) 是一个关于矩阵元素的项的项积之和，形式上与行列式非常相似，但去掉了置换的符号因子。尽管这个差异看似微小，但永久式的计算难度远超行列式。行列式衡量定向体积且可在多项式时间内计算，而永久式衡量二部图的完美匹配数量，且是 **#P-完全**的。本章探讨永久式的组合意义及其在双随机矩阵集合上的极值性质。

---

## 40A.1 定义与组合角色

!!! definition "定义 40A.1 (永久式)"
    对于 $n \times n$ 矩阵 $A$，其永久式定义为：
    $$\operatorname{perm}(A) = \sum_{\sigma \in S_n} \prod_{i=1}^n a_{i, \sigma(i)}$$

!!! theorem "定理 40A.1 (Egorychev-Falikman 定理, 1981)"
    对于任何 $n \times n$ 双随机矩阵 $A$：
    $$\operatorname{perm}(A) \ge \frac{n!}{n^n}$$
    等号成立当且仅当 $A = \frac{1}{n} J_n$（即所有元素均为 $1/n$ 的矩阵）。这解决了长达数十年的 **van der Waerden 猜想**。

---

## 练习题

1. **[基础] 计算 $A = \begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}$ 的永久式。**
   ??? success "参考答案"
       $\operatorname{perm}(A) = 1 \cdot 1 + 1 \cdot 1 = 2$。注意其行列式 $\det A = 0$。

2. **[匹配] 证明对于 (0,1)-矩阵 $A$，$\operatorname{perm}(A)$ 等于相关二部图的完美匹配数量。**
   ??? success "参考答案"
       行列式展开中的每一个置换 $\sigma$ 对应一组潜在的边。乘积项 $\prod a_{i, \sigma(i)}$ 为 1 当且仅当置换选择的所有边在图中都存在；否则为 0。对所有置换求和即得完美匹配的总数。

3. **[复杂度] 为什么计算永久式比行列式难？**
   ??? success "参考答案"
       行列式在 Gaussian 消元下是不变量（复杂度 $O(n^3)$），而永久式不是。Valiant (1979) 证明了计算永久式是 #P-完全问题，这意味着它与计算 NP-完全问题的解的数量一样难。

4. **[线性] 永久式是行/列的多线性函数吗？**
   ??? success "参考答案"
       是的。与行列式一样，永久式关于每一行（或每一列）都是线性的。不同之处在于它是**对称的**而非交错的：交换两行不会改变永久式的值。

5. **[Van der Waerden] 利用 Egorychev-Falikman 定理给出 $3 \times 3$ 双随机矩阵永久式的下界。**
   ??? success "参考答案"
       $\operatorname{perm}(A) \ge \frac{3!}{3^3} = \frac{6}{27} \approx 0.222$。

6. **[上界] 叙述关于 (0,1)-矩阵的 Minc 猜想 (Bregman 定理)。**
   ??? success "参考答案"
       对于行和为 $r_i$ 的 (0,1)-矩阵 $A$，$\operatorname{perm}(A) \le \prod (r_i!)^{1/r_i}$。这为完美匹配的数量提供了一个紧确的上界。

7. **[正定性] $A \succeq 0$ 是否蕴含 $\operatorname{perm}(A) \ge \det A$？**
   ??? success "参考答案"
       是的。这是著名的 **Schur 永久式不等式**。对于半正定矩阵，永久式总是行列式的上界。

8. **[不变性] 什么类型的矩阵 $M$ 满足 $\operatorname{perm}(MAN) = \operatorname{perm}(A)$？**
   ??? success "参考答案"
       仅限于置换矩阵与对角矩阵的乘积（即单项矩阵），且需满足缩放因子条件。这说明永久式的对称性远少于行列式。

9. **[Glynn公式] 简述一种估计永久式的随机算法。**
   ??? success "参考答案"
       由于精确计算困难，通常使用随机化算法。Glynn 公式通过对随机向量求和提供无偏估计；或者使用基于 Markov 链蒙特卡罗 (MCMC) 的近似计数方法。

10. **[恒等式] 将 $\operatorname{perm}(J_n)$ 与全排列联系起来。**
    ??? success "参考答案"
        $\operatorname{perm}(J_n) = n!$。因为有 $n!$ 个置换，每个置换对求和的贡献均为 1。

## 本章小结

本章探讨了行列式的组合对应物：

1. **匹配计算**：确立了永久式作为二部图匹配计数函数的地位。
2. **最小熵原理**：详述了 van der Waerden 猜想的证明，确定了均匀分布是永久式的全局极小值点。
3. **硬度与体积**：分析了永久式与行列式之间的计算鸿沟，强调了消元不变性的缺失。
4. **谱约束**：研究了半正定阵的不等式，将永久式的界限与谱不变量联系起来。
