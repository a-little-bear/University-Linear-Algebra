# 第 40A 章 积和式

<div class="context-flow" markdown>

**前置**：行列式 (Ch03) · 双随机矩阵 (Ch31)

**本章脉络**：积和式 (Permanent) 定义 $\to$ 与行列式的形式对比 $\to$ 计算复杂性 (#P-完全性) $\to$ Ryser 算法公式 $\to$ 双随机矩阵的积和式 $\to$ van der Waerden 猜想（定理） $\to$ Minc 猜想（上界） $\to$ 应用：二部图完美匹配计数、统计力学中的二聚体问题

**延伸**：积和式是组合数学中最重要的矩阵函数之一；虽然它在形式上只比行列式少了一个“符号”，但这种差异导致了从多项式时间到指数时间的计算鸿沟

</div>

如果说行列式是线性代数的“体积”，那么**积和式**（Permanent）就是线性代数的“计数器”。它在形式上与行列式惊人地相似，但去掉了排列的符号项。这一微小的改动使得积和式不再具有转置不变性（对非方阵而言）或乘法性质，却成为了解决图论中染色与匹配问题的终极工具。

---

## 40A.1 定义与形式对比

!!! definition "定义 40A.1 (积和式)"
    $n$ 阶方阵 $A$ 的**积和式**定义为：
    $$\operatorname{perm}(A) = \sum_{\sigma \in S_n} a_{1,\sigma(1)} a_{2,\sigma(2)} \cdots a_{n,\sigma(n)}$$
    对比：行列式 $\det(A) = \sum \operatorname{sgn}(\sigma) a_{1,\sigma(1)} \cdots a_{n,\sigma(n)}$。

!!! note "计算复杂性"
    尽管行列式可以在 $O(n^3)$ 时间内求解，但积和式的计算被证明是 **#P-完全**的（Valiant 定理）。这意味着目前不存在已知的多项式时间算法。

---

## 40A.2 van der Waerden 定理

!!! theorem "定理 40A.1 (van der Waerden 定理)"
    对于 $n$ 阶双随机矩阵 $P$（每行每列和为 1，且非负）：
    $$\operatorname{perm}(P) \ge \frac{n!}{n^n}$$
    等号成立当且仅当 $P = J_n/n$（全 1 矩阵的均值）。这一结论揭示了双随机矩阵积和式的下界。

---

## 40A.3 计算公式：Ryser 公式

!!! algorithm "算法 40A.1 (Ryser 公式)"
    为了比直接枚举 $n!$ 个排列更快，Ryser 给出了基于容斥原理的公式：
    $$\operatorname{perm}(A) = (-1)^n \sum_{S \subseteq \{1,\ldots,n\}} (-1)^{|S|} \prod_{i=1}^n \left( \sum_{j \in S} a_{ij} \right)$$
    **复杂度**：$O(n 2^n)$。这仍然是指数级的，但在中等规模下比直接求和快得多。

---

## 练习题

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

****
??? success "参考答案"
    

## 本章小结

积和式是连接代数与组合难题的纽带：


****：去掉了行列式的交错符号后，积和式失去了绝大部分优秀的代数性质（如乘法法则），这直接导致了其计算上的“灾难性”复杂度。

****：通过将组合约束编码进 (0,1)-矩阵，积和式成为了解决排列、匹配和染色等组合计数问题的万能钥匙。

****：van der Waerden 定理展示了矩阵元素的均衡程度（双随机性）如何严格限制了其拓扑结构的丰富程度（积和式的大小）。
