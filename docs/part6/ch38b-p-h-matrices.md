# 第 38B 章 P-矩阵与 H-矩阵

<div class="context-flow" markdown>

**前置**：M-矩阵 (Ch38A) · 正定矩阵 (Ch16) · 行列式 (Ch03)

**本章脉络**：从 M-矩阵的泛化 $\to$ P-矩阵定义（主子式皆正） $\to$ 线性互补问题 (LCP) 的解法 $\to$ H-矩阵（比较矩阵是 M-矩阵） $\to$ Ostrowski 判定准则 $\to$ 层级关系：正定矩阵 $\subset$ M-矩阵 $\subset$ H-矩阵 $\to$ 稳定性与数值计算中的应用 $\to$ 应用：电路分析、非线性系统的局部线性化

**延伸**：P-矩阵和 H-矩阵是处理“非对称稳定性”的高级代数语言；它们在不需要对称性的前提下，保持了类似于正定矩阵的许多关键性质，是解决运筹学中互补问题的核心

</div>

如果我们将 M-矩阵中“非对角元为负”的限制放宽，会得到更具普遍性的 **H-矩阵**；如果只保留“主子式全为正”的特征，则得到 **P-矩阵**。这两类矩阵在非线性规划和电路模拟中至关重要，因为它们保证了复杂系统平衡点的存在性与唯一性。本章将揭示这些结构之间的层级关联。

---

## 38B.1 P-矩阵的定义与 LCP

!!! definition "定义 38B.1 (P-矩阵)"
    方阵 $A$ 称为 **P-矩阵**，如果它的所有主子式（不一定是顺序的）都严格大于 0。
    **性质**：正定矩阵（对称）和非奇异 M-矩阵都是 P-矩阵。

!!! technique "应用：线性互补问题 (LCP)"
    P-矩阵是保证线性互补问题 $w - Az = q, w \ge 0, z \ge 0, w^T z = 0$ 对任何 $q$ 都有唯一解的充要条件。这在博弈论和接触力学中极具价值。

---

## 38B.2 H-矩阵与比较矩阵

!!! definition "定义 38B.2 (H-矩阵)"
    方阵 $A$ 称为 **H-矩阵**，如果其**比较矩阵**（Comparison Matrix） $\mathcal{M}(A)$ 是一个非奇异 M-矩阵。
    比较矩阵的定义为：
    - 对角元：$(\mathcal{M}(A))_{ii} = |a_{ii}|$
    - 非对角元：$(\mathcal{M}(A))_{ij} = -|a_{ij}|$ ($i \neq j$)

---

## 38B.3 判定与层级关系

!!! theorem "定理 38B.1 (Ostrowski 准则)"
    若 $A$ 是广义严格对角占优的（即存在正向量 $d$ 使得 $|a_{ii}| d_i > \sum |a_{ij}| d_j$），则 $A$ 是一个非奇异 H-矩阵。

---

## 练习题

**1. [基础] 判定 $A = \begin{pmatrix} 1 & -2 \\ 0 & 1 \end{pmatrix}$ 是否为 P-矩阵。**

??? success "参考答案"
    **计算主子式：**
    1. $1 \times 1$ 主子式：$|1|=1, |1|=1$。均大于 0。
    2. $2 \times 2$ 主子式：$\det(A) = 1 - 0 = 1 > 0$。
    **结论**：由于所有主子式均为正，它是 P-矩阵。注意：它不是对称的，也不是正定的。

**2. [比较矩阵] 求 $A = \begin{pmatrix} 2 & i \\ -1 & 3 \end{pmatrix}$ 的比较矩阵。**

??? success "参考答案"
    **构造：**
    1. 对角元取绝对值：$2, 3$。
    2. 非对角元取负绝对值：$-|i| = -1, -|-1| = -1$。
    **结果**：$\mathcal{M}(A) = \begin{pmatrix} 2 & -1 \\ -1 & 3 \end{pmatrix}$。

**3. [H-矩阵判定] 上题中的 $A$ 是否为 H-矩阵？**

??? success "参考答案"
    **判定：**
    1. 检查其比较矩阵 $\mathcal{M}(A)$ 是否为 M-矩阵。
    2. $\mathcal{M}(A)$ 的主子式为 $2 > 0$ 和 $6-1=5 > 0$。
    3. 且它是 Z-矩阵。
    **结论**：由于比较矩阵是非奇异 M-矩阵，故 $A$ 是非奇异 H-矩阵。

**4. [性质] 证明：P-矩阵的所有特征值可以有负实部吗？**

??? success "参考答案"
    **结论：可以。**
    **理由**：P-矩阵只保证主子式为正，并不保证特征值实部为正（这是 M-矩阵或正定阵的加强性质）。
    例如 $A = \begin{pmatrix} 1 & 2 \\ -2 & 1 \end{pmatrix}$ 是 P-矩阵（主子式 1, 1, 5），但其特征值为 $1 \pm 2i$，实部为正。但若维度更高，可能出现更复杂的情况。

**5. [层级] 简述正定矩阵、M-矩阵与 P-矩阵的包含关系。**

??? success "参考答案"
    **包含链：**
    (对称正定阵) $\cup$ (非奇异 M-矩阵) $\subset$ (P-矩阵)。
    P-矩阵是捕捉“行列式正性”的最广义集合。

**6. [逆矩阵] H-矩阵的逆矩阵一定是非负的吗？**

??? success "参考答案"
    **结论：不一定。**
    **解析**：只有 M-矩阵保证 $A^{-1} \ge 0$。对于一般 H-矩阵（如对角元为复数），逆矩阵通常也是复数的。但 H-矩阵保证了 $\|A^{-1}\| \le \|\mathcal{M}(A)^{-1}\|$，这在误差估计中非常有用。

**7. [计算] 判定 $\begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix}$ 是否为 P-矩阵。**

??? success "参考答案"
    **计算：**
    主子式：$1, 1$ 为正。但 $\det = 1 - 4 = -3 < 0$。
    **结论**：不是 P-矩阵。

**8. [应用] 在电路分析中，由电阻构成的电导矩阵通常是什么类型？**

??? success "参考答案"
    通常是 **M-矩阵**（由于基尔霍夫电流定律导致的对角占优且非对角元为负电导）。如果有受控源，则可能退化为 **H-矩阵**。

**9. [稳定判定] 为什么 H-矩阵在神经网络稳定性中很重要？**

??? success "参考答案"
    因为非线性激励函数通常被限制在一定的斜率区间内。利用 H-矩阵的 Ostrowski 准则可以判定连接权值矩阵是否能保证全局平衡点的唯一性。

**10. [极限] 随着对角占优程度的增加，H-矩阵的性质会趋向于什么？**
    
??? success "参考答案"
    趋向于**对角矩阵**。对角占优是 H-矩阵最核心的数值特征，占优越强，矩阵的逆越接近对角阵的逆，系统越稳定。

## 本章小结

P-矩阵与 H-矩阵确立了广义稳定性的边界：

1.  **子式的支配力**：P-矩阵证明了即使没有对称性，主子式的整体正性依然能保证线性互补问题的唯一解，是运筹学的代数基石。
2.  **绝对值的抽象**：H-矩阵通过比较矩阵技术，将复杂的数值（甚至复数）运算简化为 M-矩阵的量级分析，为误差传播提供了统一的界限。
3.  **结构的演进**：从正定到 M 再到 H，这一层级结构展示了线性代数如何通过逐步放宽限制，将深层的稳定性逻辑推广到非线性与非对称的广阔领域。
